"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[319],{9885:(e,t,i)=>{i.d(t,{k:()=>u});var n=i(30758),a=i(64721),s=i(37435),r=i(89494),o=i(36748),l=i(5886),c=i(86070);const u=({id:e,children:t,targetURI:i,fadeOut:u=!1})=>{const d=(0,n.useCallback)((()=>{window.open((0,o.rw)(i).href)}),[i]),p={getTitle:()=>a.Ru.get("action-trigger.available-in-app-only"),getDescription:()=>a.Ru.get("action-trigger.listen-mixed-media-episode"),primaryButtonText:()=>a.Ru.get("action-trigger.button.get-app"),secondaryButtonText:()=>a.Ru.get("action-trigger.button.not-now"),isCTA:!0,intentPrimaryButton:"download-app",onLogInteraction:(0,r.W)(),shouldHideOnScroll:!0,fadeOut:u};return(0,c.jsx)(s.U,{className:l.A.container,id:e,onPrimaryButtonClick:d,options:p,children:t})}},78511:(e,t,i)=>{i.d(t,{D:()=>d});var n=i(97500),a=i.n(n),s=i(43494);const r="Psc33HXPyazZYAAr1tgz",o="VGJz_GOARJ6j02JICvW6",l="VpNHGG5ZhoxQ8AqW709S",c="P7395UzhjxLUlLZvj5fb";var u=i(86070);const d=function(e){const{children:t,active:i=!1,focus:n=!0,label:d,onClick:p,noBackground:m=!1}=e;return(0,u.jsx)(s.Zp,{label:d,children:(0,u.jsx)("button",{className:a()(r,{[c]:i,[o]:m,[l]:n}),onClick:p,"aria-label":d,children:t})})}},37769:(e,t,i)=>{i.d(t,{N:()=>g});var n=i(97500),a=i.n(n),s=i(30758),r=i(96613),o=i(55285);const l="nLNTsyonBwoRIzAv1AME",c="E4I5I7G2CfW32hLWZaqE",u="w4ZoklZWkrsyrVA34vI8";var d=i(86070);const p=({title:e,uri:t,className:i,onClick:n,position:l})=>{const p=(0,s.useCallback)((e=>{n?.(e,{uri:t,position:l})}),[n,l,t]);return(0,d.jsx)(o.N,{"aria-label":e,className:a()(c,u,i),to:t,onClick:p,children:(0,d.jsx)(r.v,{as:"span",children:e})})};function m(e){return!!e.uri&&!!e.title}const g=({topics:e,className:t,onClick:i})=>(0,d.jsx)("div",{className:a()(l,t),children:e.filter(m).map(((e,t)=>{const n=`${e.uri}-${t}`;return(0,d.jsx)(p,{title:e.title,uri:e.uri,position:t,onClick:i},n)}))})},2732:(e,t,i)=>{i.d(t,{h:()=>y});var n=i(52795),a=i(1759),s=i(13377),r=i(69500),o=i(66216),l=i(39470),c=i(60528),u=i(42452),d=i(92057),p=i(61804),m=i(4114),g=i(1620),v=i(24902);const x="main-nowPlayingView-coverArt";var h=i(86070);const y=({context:e,item:t,index:i,canSwitchVisuals:y=!1})=>{const{spec:b,logger:f}=(0,g.r)(n.J,{}),{draggable:j,onDragStart:C}=(0,d.P)();return(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(s.h,{menu:(0,h.jsx)(o.W,{context:e,item:t,canSwitchVisuals:y}),children:(0,h.jsx)("div",{draggable:j&&((0,m.v)(t)||(0,p.p)(t)),onDragStart:e=>{C(e,{itemUris:[t.uri],dragLabelText:(0,u.r)(t)})},children:(0,h.jsx)(c.R,{uri:e.uri,owner:e.metadata?.context_owner,children:(0,h.jsx)(l.e,{context:t.type===v.c.TRACK?t.album:e,item:t,index:i,isVisible:!0,onClick:()=>{f.logInteraction(b.coverArtFactory({uri:t.uri}).hitUiNavigate({destination:t.type===v.c.TRACK?t.album.uri:t.uri}))},adEventReason:a.c.COVER_ART,children:(0,h.jsx)(r.b,{className:x,item:t,maxSize:384,desiredLabel:"xlarge"})})})})})})}},21765:(e,t,i)=>{i.d(t,{w:()=>m,X:()=>p});var n=i(30758),a=i(97500),s=i.n(a),r=i(6128),o=i(43494);const l="main-nowPlayingView-section",c="main-nowPlayingView-sectionHeader",u="main-nowPlayingView-sectionHeaderText";var d=i(86070);const p=({action:e,children:t,className:i,icon:n,tooltipLabel:a})=>(0,d.jsxs)(r.E,{as:"div",variant:"bodyMediumBold",semanticColor:"textBase",className:s()(c,i),children:[n,a?(0,d.jsx)(o.Zp,{label:a,children:(0,d.jsx)("div",{className:u,children:t})}):(0,d.jsx)("div",{className:u,children:t}),e]}),m=(0,n.forwardRef)((({children:e,className:t,style:i,testId:n},a)=>{const r={};return n&&(r["data-testid"]=n),(0,d.jsx)("div",{ref:a,className:s()(l,t),style:i,...r,children:e})}))},29507:(e,t,i)=>{i.d(t,{F:()=>u});var n=i(30758),a=i(3611),s=i(86502),r=i(60472),o=i(37300);const l="KrBYgWLGb5aRHjoD_prX";var c=i(86070);const u=(0,a.mc)((()=>{const{setVideoPlayerUIFlag:e}=(0,r.d)(),t=(0,s.XB)();return(0,n.useEffect)((()=>(e(o.n.npv,!0),()=>{e(o.n.npv,!1)})),[t,e]),(0,c.jsx)("div",{id:"VideoPlayerNpv_ReactPortal",className:l})}),{name:"NPVVideoContainer"})},57409:(e,t,i)=>{i.d(t,{PanelSection:()=>Ov});var n=i(30758),a=i(94079),s=i(63166),r=i(16249),o=i(97500),l=i.n(o),c=i(6128),u=(i(96613),i(73762)),d=i(61214),p=i(78550),m=i(2799);const g="Xq5xnpTOsoPxFR95BkTU",v="N7OMJte9T4Lv7DDX16ky",x="NJATxQbY2o4sl0BHxU3T";var h=i(86070);const y=({children:e,className:t,...i})=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(p.a,{panel:m.Z.Puffin,className:l()(v,t),...i}),e]});let b=function(e){return e.Overview="overview",e.ActivationIntro="activationIntro",e.ActivationDetection="activationDetection",e.ActivationSignifiers="activationSignifiers",e.Error="error",e.ManualSelection="manualSelection",e.AirpodsSelection="airpodsSelection",e.AudioQualitySettings="audioQualitySettings",e.AudioQualityDetails="audioQualityDetails",e.DiscoverLossless="discoverLossless",e.IncompatibleHeadphones="incompatibleHeadphones",e}({}),f=function(e){return e.GetStarted="getStarted",e.OnError="onError",e.SelectManually="selectManually",e.Continue="continue",e.Close="close",e.Activate="activate",e.SetupNewDevice="setupNewDevice",e.NotFound="notFound",e.Settings="settings",e.OnboardLossless="onboardLossless",e.Details="details",e.Airpods="airpods",e}({});var j=i(86502),C=i(32751);const w=[b.ActivationIntro,b.ActivationDetection,b.ActivationSignifiers,b.ManualSelection,b.AirpodsSelection],S=e=>{const t=(0,n.useRef)(!1),i=(0,C.z)(),a=(0,j.XB)();(0,n.useEffect)((()=>{const n=i.getState()?.isPaused,s=(r=e,o=a,w.includes(r)&&(o===m.Z.PuffinActivation||o===m.Z.PuffinActivationOverlay));var r,o;!s||n||t.current?!s&&n&&t.current&&(i.resume(),t.current=!1):(i.pause(),t.current=!0)}),[a,e,i])},N={[b.Overview]:{[f.GetStarted]:b.ActivationIntro,[f.OnError]:b.Error,[f.SelectManually]:b.ManualSelection,[f.Settings]:b.AudioQualitySettings,[f.OnboardLossless]:b.DiscoverLossless,[f.Details]:b.AudioQualityDetails},[b.ActivationIntro]:{[f.Close]:b.Overview,[f.OnError]:b.Error,[f.Continue]:b.ActivationDetection,[f.SelectManually]:b.ManualSelection,[f.Activate]:b.Overview},[b.ActivationDetection]:{[f.SelectManually]:b.ManualSelection,[f.Airpods]:b.AirpodsSelection,[f.Close]:b.Overview,[f.OnError]:b.Error,[f.Continue]:b.ActivationSignifiers},[b.ActivationSignifiers]:{[f.Close]:b.Overview,[f.OnError]:b.Error,[f.Activate]:b.Overview},[b.ManualSelection]:{[f.Continue]:b.ActivationSignifiers,[f.Close]:b.Overview,[f.OnError]:b.Error,[f.NotFound]:b.IncompatibleHeadphones},[b.AirpodsSelection]:{[f.Continue]:b.ActivationSignifiers,[f.Close]:b.Overview,[f.OnError]:b.Error,[f.NotFound]:b.Error},[b.DiscoverLossless]:{[f.Continue]:b.Overview},[b.AudioQualitySettings]:{},[b.AudioQualityDetails]:{},[b.Error]:{},[b.IncompatibleHeadphones]:{[f.Close]:b.Overview,[f.OnError]:b.Error,[f.Continue]:b.Overview}},k=(0,n.createContext)({currentView:b.Overview,viewTransitions:N,setCurrentView:()=>{},toPreviousView:()=>{},viewOptions:null}),R=({children:e})=>{const t=(0,j.XB)(),[i,a]=(0,n.useState)((()=>(e=>[{view:e===m.Z.PuffinActivation||e===m.Z.PuffinActivationOverlay?b.ActivationDetection:b.Overview,options:{}}])(t))),s=(0,n.useCallback)(((e,t)=>{e===b.Overview?a([{view:e,options:t??{}}]):a((i=>[...i,{view:e,options:t??{}}]))}),[]),r=(0,n.useCallback)((()=>{a((e=>e.slice(0,-1)))}),[]);if(0===i.length)throw new Error("Puffin view state stack should never be empty");const{view:o,options:l}=i.at(-1);return S(o),(0,h.jsx)(k.Provider,{value:{currentView:o,viewOptions:l,setCurrentView:s,toPreviousView:r,viewTransitions:N},children:e})},I="EqLKhgGIINyN_LINFjl1",E="OyIY0v1_h3UWgLlxyPHL",L=({resetError:e})=>{const{toPreviousView:t,setCurrentView:i}=(0,n.useContext)(k);return(0,h.jsx)(y,{onBack:()=>{t()},children:(0,h.jsxs)("div",{className:I,children:[(0,h.jsx)(u.b,{size:"xlarge",semanticColor:"textBase"}),(0,h.jsxs)("div",{className:E,children:[(0,h.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:"Something went wrong"}),(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:"We couldn’t turn on your headphone tools."})]}),(0,h.jsx)(d.$,{colorSet:"invertedLight",size:"medium",onClick:()=>{e?.(),i(b.Overview)},children:"Retry"})]})})},T=({resetError:e})=>(0,h.jsx)(L,{resetError:e});var A=i(17758),P=i(95440),D=i(64721),O=i(17256),_=i(97550),U=i(73868),B=i(38254),F=i(45231);const M=()=>{const e=(0,P.d4)((e=>e.platform.isDesktop)),t=(0,_.b)(),i=(0,O.lS)(t),{isPlayingRemotely:a,remoteDeviceName:s,isConnected:r}=(0,B.v)((e=>{const t=(0,U.V)(e);return{isPlayingRemotely:t.isPlayingRemotely,remoteDeviceName:t.remoteDevice?.name,isConnected:"connected"===t.connectionStatus}}),F.a),o=(0,n.useMemo)((()=>e?D.Ru.get("web-player.connect.device-picker.this-computer"):D.Ru.get("web-player.connect.device-picker.this-web-browser")),[e]),l=(0,n.useMemo)((()=>{if(t)return e?D.Ru.get("web-player.connect.device-picker.from-this-computer",{device_name:t.name}):D.Ru.get("web-player.connect.device-picker.from-this-web-browser",{device_name:t.name})}),[e,t]);return s&&a&&r?{deviceName:s,playingFrom:s}:i?t?.transportType===O.Yg.BLUETOOTH?{deviceName:t.name,playingFrom:o,formattedDeviceName:l}:{deviceName:D.Ru.get("web-player.puffin.wired-connection"),playingFrom:o}:{deviceName:o,playingFrom:o}},H=()=>{const{deviceName:e}=M();return(0,h.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:e})};var V=i(96930),q=i(29157),z=i(6334),Q=i(67869);const G=({onClick:e})=>{const{playingFrom:t}=M(),i=(0,z.t)(),[{data:n}]=(0,Q.K)(i.quality.streamingQuality);return void 0===n?null:(0,h.jsx)(V.v,{id:"qualitySetting",variant:"naked",title:D.Ru.get("desktop.settings.streamingQuality"),leading:(0,h.jsx)(q.s,{size:"small"}),subtitle:t,onClick:e,padding:"0px 12px"})};var Y=i(32260),K=i(23369),Z=i(55847),W=i(13979);const X=({title:e,description:t,confirmButtonText:i="OK",cancelButtonText:a="Cancel",onConfirm:s,onClose:r})=>{const{setCurrentView:o}=(0,n.useContext)(k),l=(0,j._Y)(),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(!1);return{dialog:c?(0,h.jsx)(Z.T,{onClose:()=>{u(!1),r?.()},onConfirm:()=>{s(),d.current?l(W.$S.PUFFIN_BUTTON_CLICK):o(b.Overview)},titleText:e,"aria-label":e,descriptionText:t,cancelText:a,confirmText:i}):null,triggerDialog:(e=!1)=>{d.current=e,u(!0)}}};var J=i(41968),$=i(68656);const ee=()=>{const e=(0,$.N)();return{setCurrentDevice:(0,n.useCallback)(((t,i)=>{e.setCurrentDevice(t,i)}),[e]),removeCurrentDevice:(0,n.useCallback)((t=>{e.removeCurrentDevice(t)}),[e])}};var te=i(11716);const ie=({spec:e})=>{const t=(0,te.s)(),i=(0,n.useRef)(null),{removeCurrentDevice:a}=ee(),{deviceFilterState:s}=(0,J.j)();(0,K.X)("RESET_HEADPHONES_BUTTON",i);const{triggerDialog:r,dialog:o}=X({title:D.Ru.get("web-player.puffin.reset-headphones.dialog.title"),description:D.Ru.get("web-player.puffin.reset-headphones.dialog.subtitle"),confirmButtonText:D.Ru.get("web-player.puffin.reset-headphones.dialog.confirm"),onConfirm:()=>{a(!0),(0,K.I)("SETUP_HEADPHONES_BUTTON")},onClose:()=>{(0,K.I)("RESET_HEADPHONES_BUTTON")}});return s.isOnboarded?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(V.v,{id:"resetHeadphonesButton",ref:i,variant:"naked",title:D.Ru.get("web-player.puffin.reset-headphones.menu-item"),leading:(0,h.jsx)(Y.x,{size:"small"}),onClick:i=>{t.logInteraction(e.resetHeadphonesButtonFactory().hitUiReveal()),i.preventDefault(),r(!1)},padding:"0px 12px"}),o]}):null};var ne=i(68087);const ae=({isPlayingRemotely:e,spec:t})=>{const i=(0,te.s)(),{setCurrentView:a,viewTransitions:s}=(0,n.useContext)(k),r=s[b.Overview],o=(0,ne.j)();return(0,h.jsxs)("div",{children:[o&&(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(G,{onClick:()=>{i.logInteraction(t.qualitySettingsButtonFactory().hitUiReveal()),a(r.settings)}})}),!e&&(0,h.jsx)(ie,{spec:t})]})};var se=i(29004),re=i(40748);const oe="k4f1o0jOMnxv6OS8dC7p",le="PYLIWbzDyJA6Mbh2EQQg",ce=({title:e,subtitle:t,buttonLabel:i,onClick:a,dismissButtonLabel:s,onDismissClick:r,focusTransferKey:o=null})=>{const l=(0,n.useRef)(null);return(0,K.X)(o,l),(0,h.jsx)(V.v,{variant:"naked",size:"lg",id:"getStarted",className:oe,title:e,subtitle:t,paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,h.jsxs)("div",{className:le,children:[(0,h.jsx)(se.n,{size:"small",onClick:a,ref:l,children:(0,h.jsx)(c.E,{variant:"bodySmallBold",children:i})}),s&&r&&(0,h.jsx)(re.H,{size:"small",onClick:r,children:(0,h.jsx)(c.E,{variant:"bodySmallBold",children:s})})]})})};var ue=i(99912),de=i(90410),pe=i(68296);const me=e=>{switch(e){case pe.Yn.LOSSLESS_24:return{title:D.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:D.Ru.get("web-player.pigeon.audio-quality.lossless-24.label"),bitrateLabel:D.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate"),bitrateDetails:[D.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),D.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case pe.Yn.LOSSLESS:return{title:D.Ru.get("web-player.pigeon.audio-quality.lossless"),titleFull:D.Ru.get("web-player.pigeon.audio-quality.lossless-16.label"),bitrateLabel:D.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate"),bitrateDetails:[D.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-1"),D.Ru.get("web-player.pigeon.audio-quality.lossless-16.bitrate-details-2")]};case pe.Yn.VERY_HIGH:return{title:D.Ru.get("web-player.pigeon.audio-quality.very-high.label"),bitrateLabel:D.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate"),bitrateDetails:[D.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details")]};case pe.Yn.HIGH:return{title:D.Ru.get("web-player.pigeon.audio-quality.high.label"),bitrateLabel:D.Ru.get("web-player.pigeon.audio-quality.high.bitrate"),bitrateDetails:[D.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details")]};case pe.Yn.NORMAL:return{title:D.Ru.get("web-player.pigeon.audio-quality.normal.label"),bitrateLabel:D.Ru.get("web-player.pigeon.audio-quality.normal.bitrate"),bitrateDetails:[D.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details")]};case pe.Yn.LOW:return{title:D.Ru.get("web-player.pigeon.audio-quality.low.label"),bitrateLabel:D.Ru.get("web-player.pigeon.audio-quality.low.bitrate"),bitrateDetails:[D.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details")]};case pe.Yn.UNKNOWN:default:return{title:D.Ru.get("web-player.pigeon.audio-quality.unknown.label"),bitrateLabel:null}}},ge="SsVVyvM7DIniTIOjJFuM",ve="dHDe0DUG4UkEeM8p5PEa",xe="T49oF8shvnsadykMrogA",he=({quality:e,onClick:t})=>{const i=me(e),n=[pe.Yn.VERY_HIGH,pe.Yn.HIGH,pe.Yn.NORMAL,pe.Yn.LOW];e===pe.Yn.LOSSLESS_24?n.unshift(pe.Yn.LOSSLESS_24):n.unshift(pe.Yn.LOSSLESS);const a=e===pe.Yn.UNKNOWN?"textBase":"textBrightAccent";return(0,h.jsxs)(ue.a,{as:"button",variant:"tinted",className:ge,onClick:t,children:[(0,h.jsx)(V.v,{id:"quality",size:"lg",pretitle:D.Ru.get("web-player.pigeon.overview-card.title"),titleGap:de.v4,title:(0,h.jsx)(c.E,{variant:"titleSmall",semanticColor:a,children:i.titleFull||i.title}),paddingInlineStart:"0px",paddingInlineEnd:"0px",variant:"naked"}),(0,h.jsx)("div",{children:n.map(((t,i)=>{const n=me(t),a=t===e,s=a?"textBrightAccent":"textSubdued";return(0,h.jsx)(V.v,{id:n.title,size:"sm",paddingInlineStart:"0px",paddingInlineEnd:"0px",media:(0,h.jsx)("div",{className:l()(ve,{[xe]:a})}),title:(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:s,children:n.title}),trailing:(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:s,children:n.bitrateLabel}),variant:"naked"},i)}))})]})};var ye=i(76698);const be=()=>(0,ye.x)("onboarding-dismissed:lossless",!1);var fe=i(19974);const je=({spec:e})=>{const t=(0,te.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(k),s=a[b.Overview],r=(0,ne.j)(),o=(0,fe.A)(),[l]=be();return r?(0,h.jsxs)(h.Fragment,{children:[!l&&(0,h.jsx)(ce,{title:D.Ru.get("web-player.pigeon.get-started.title"),subtitle:D.Ru.get("web-player.pigeon.get-started.subtitle"),buttonLabel:D.Ru.get("web-player.pigeon.get-started.button"),onClick:()=>{t.logInteraction(e.losslessOnboardingButtonFactory().hitUiReveal()),i(s.onboardLossless)}}),(0,h.jsx)(he,{quality:o,onClick:()=>{t.logInteraction(e.audioQualityCardFactory().hitUiReveal()),i(s.details)}})]}):null},Ce=({isError:e})=>e?(0,h.jsx)(V.v,{id:"filterError",variant:"tinted",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",leading:(0,h.jsx)(u.b,{semanticColor:"textSubdued",size:"small"}),title:D.Ru.get("web-player.puffin.error-troubleshooting")}):null;var we=i(65583),Se=i(15684);const Ne="jvVll3Ia4Nrq9Fsd78Fo",ke="d_HhOkLKxYpYKpP2gQy7",Re="fLp9X9keK84drMHcmOFW",Ie=({currentDeviceState:e,spec:t})=>{const i=(0,te.s)(),a=(0,n.useCallback)((()=>{i.logInteraction(t.optimizeToggleFactory().hitUiElementToggle()),e.toggleTuneHeadphones?.()}),[e,i,t]),s=null!==e.toggleTuneHeadphones,{specificRestricted:r,processingCapabilitiesRestricted:o}=e.contentRestrictions;return(0,h.jsx)("div",{className:Ne,children:(0,h.jsx)(V.v,{variant:"naked",size:"md",id:"headphones",className:ke,disabled:r||o||!s,title:(0,h.jsx)(we.d,{className:Re,children:D.Ru.get("web-player.puffin.listening-with.filters.specific-title")}),subtitle:s?D.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle"):D.Ru.get("web-player.puffin.listening-with.filters.specific-subtitle-unavailable"),trailing:(0,h.jsx)(Se.l,{id:"headphoneTunes",onSelected:a,disabled:r||o,value:e.currentState.specificEnabled,condensed:!0})})})},Ee="bLEXMWOER6nmfeLfBRIN",Le=({spec:e})=>{const t=(0,te.s)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(k),s=a[b.Overview],{deviceFilterState:r}=(0,J.j)(),o=r.isOnboarded;return(0,h.jsx)(V.v,{id:"listeningWith",variant:"tinted",pretitle:D.Ru.get("web-player.puffin.listening-with.model"),horizontalGap:"0px",paddingBlockStart:"12px",paddingBlockEnd:"12px",paddingInlineStart:"16px",paddingInlineEnd:"16px",className:Ee,trailing:(0,h.jsx)(se.n,{size:"small",onClick:()=>{t.logInteraction(e.changeModelButtonFactory().hitUiReveal()),i(s.selectManually)},children:(0,h.jsx)(c.E,{variant:"bodySmallBold",children:D.Ru.get("web-player.puffin.listening-with.change-model")})}),footer:o&&(0,h.jsx)(Ie,{currentDeviceState:r,spec:e}),title:(0,h.jsx)(we.d,{lineClamp:2,children:r.headphoneDevice?.deviceName??D.Ru.get("web-player.puffin.listening-with.placeholder-model")})})},Te=({spec:e})=>{const{setCurrentView:t,viewTransitions:i}=(0,n.useContext)(k),a=i[b.Overview],{deviceFilterState:s,isMaybeHeadphoneDevice:r,isError:o,isLoading:l}=(0,J.j)(),c=(0,te.s)(),{triggerDialog:u,dialog:d,isHiddenByUser:p}=(()=>{const{deviceFilterState:e}=(0,J.j)(),t=e.audioDevice?.id,[i,a]=(0,ye.x)("puffin-hide-get-started",[]),s=(0,n.useMemo)((()=>!!t&&i.includes(t)),[t,i]),r=(0,n.useCallback)((()=>{if(t){const e=[...i,t].slice(-50);a(e)}}),[t,a,i]);return{...X({title:D.Ru.get("web-player.puffin.dismiss-get-started.title"),description:D.Ru.get("web-player.puffin.dismiss-get-started.body"),confirmButtonText:D.Ru.get("web-player.puffin.dismiss-get-started.yes"),cancelButtonText:D.Ru.get("web-player.puffin.dismiss-get-started.cancel"),onConfirm:()=>{r()}}),isHiddenByUser:s}})(),m=s.isOnboarded,g=r&&!m&&!p,v=(0,n.useCallback)((()=>{c.logInteraction(e.setupHeadphonesButtonFactory().hitUiReveal()),s.audioDevice?t(a.getStarted):t(a.selectManually,{showDialogOnBack:!0})}),[c,e,s.audioDevice,t,a.getStarted,a.selectManually]);return r?o||l?(0,h.jsx)(Ce,{isError:o}):(0,h.jsxs)(h.Fragment,{children:[d,m&&(0,h.jsx)(Le,{spec:e}),g&&(0,h.jsx)(ce,{title:D.Ru.get("web-player.puffin.get-started.title"),subtitle:D.Ru.get("web-player.puffin.get-started.subtitle"),buttonLabel:D.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm"),onClick:v,dismissButtonLabel:D.Ru.get("web-player.puffin.upsell.enhance-headphones.not-headphones"),onDismissClick:u,focusTransferKey:"SETUP_HEADPHONES_BUTTON"})]}):null};var Ae=i(82199),Pe=i(1620);const De="TJAbLKl8aSWZqWk4EFkk",Oe=W.$S.DEVICE_PICKER_BUTTON_CLICK,_e=()=>{const e=(0,U.l)(),{panelSend:t}=(0,j.AI)(m.Z.DevicePicker,m.Z.DevicePickerOverlay),i=(0,ne.j)(),a=(0,Ae.v)(),{spec:s,logger:r}=(0,Pe.r)(A.R,{}),o=!e&&a,l=(0,n.useCallback)((()=>{r.logInteraction(s.backButtonFactory().hitUiReveal()),t(Oe)}),[r,t,s]);return(0,h.jsx)(y,{onBack:l,onClose:()=>{r.logInteraction(s.closeButtonFactory().hitUiHide())},children:(0,h.jsxs)("div",{className:De,children:[(0,h.jsx)(H,{}),o&&(0,h.jsx)(Te,{spec:s}),i&&(0,h.jsx)(je,{spec:s}),(0,h.jsx)(ae,{isPlayingRemotely:e,spec:s})]})})};var Ue=i(68376),Be=i(73857),Fe=i(24900),Me=i(55285);let He=function(e){return e.INFO="INFO",e.ERROR="ERROR",e}({});function Ve(e){return e.type===He.ERROR}function qe(e){return e.type===He.INFO}var ze=i(23158);const Qe="UPAv6TbmqM79jDLYgiad",Ge=({card:{type:e,id:t,title:i,text:n}})=>(0,h.jsx)(V.v,{id:t,className:Qe,variant:"tinted",leading:e===He.ERROR?(0,h.jsx)(Fe.Z,{size:"small",semanticColor:"textWarning"}):null,title:(0,h.jsx)(we.d,{variant:"bodyMedium",children:i}),body:"string"==typeof n?(0,h.jsx)(ze.y,{LinkComponent:Me.N,source:n,splitter:/\|/g,semanticColor:"textSubdued",variant:"mesto"}):n});var Ye=i(69175),Ke=i(44936);const Ze="GdqxZ88oz8MtwHaBnwgb",We="Q4TWj1C8EEkH_beo9jI8",Xe="slKZiyNh_zlnTSEo8VG7",Je="ichtbB4QY2SKusRio97a",$e="xTMuOBwhiZlpUZtnm0M6";let et=function(e){return e[e.PASSING=0]="PASSING",e[e.NEEDS_ATTENTION=1]="NEEDS_ATTENTION",e[e.UNKNOWN=2]="UNKNOWN",e}({});const tt=({metric:e,label:t,severity:i})=>(0,h.jsxs)("div",{className:l()(Ze,{[Je]:i===et.UNKNOWN}),children:[(()=>{switch(i){case et.PASSING:return(0,h.jsx)(Ye.k,{size:"large",className:We,semanticColor:"textBase"});case et.NEEDS_ATTENTION:return(0,h.jsx)(Fe.Z,{size:"large",className:Xe,semanticColor:"textWarning"});case et.UNKNOWN:return(0,h.jsx)(Ke.N,{size:"large",className:Xe,semanticColor:"textBase"});default:return null}})(),(0,h.jsxs)("div",{className:$e,children:[(0,h.jsx)(c.E,{as:"p",variant:"bodyMedium",semanticColor:"textBase",children:e}),(0,h.jsx)(c.E,{as:"p",semanticColor:"textSubdued",variant:"bodySmall",children:t})]})]});let it=function(e){return e.bitrateLevel="bitrateLevel",e.targetBitrateLevel="targetBitrateLevel",e.targetBitrateAvailable="targetBitrateAvailable",e.strategy="strategy",e.isLocal="isLocal",e.autoAdjust="autoAdjust",e.deviceSupported="deviceSupported",e}({}),nt=function(e){return e.Bluetooth_Degrades_Lossless="Bluetooth_Degrades_Lossless",e.Connect_Explanation="Connect_Explanation",e.Default_To_Very_High="Default_To_Very_High",e.Need_To_Redownload="Need_To_Redownload",e.Opt_Out_Of_Downgrade="Opt_Out_Of_Downgrade",e.Poor_Bandwidth_Interferes="Poor_Bandwidth_Interferes",e.Lossless_Unavailable="Lossless_Unavailable",e.Listen_Offline="Listen_Offline",e.Update_Setting="Update_Setting",e}({}),at=function(e){return e[e.Internet=0]="Internet",e[e.Spotify_Connect=1]="Spotify_Connect",e[e.Downloads=2]="Downloads",e}({}),st=function(e){return e.Good="good",e.Poor="poor",e.Unknown="unknown",e.Unavailable="unavailable",e}({});const rt=[{criteria:{online:!0,autoAdjust:!1,trackLosslessAvailable:!0},result:nt.Opt_Out_Of_Downgrade},{criteria:{online:!0,streamingLossless:!1,targetingLossless:!0,deviceCompatible:!0,internetBandwidth:st.Poor,trackLosslessAvailable:!0},result:nt.Poor_Bandwidth_Interferes},{criteria:{online:!0,autoAdjust:!0,streamingLossless:!1,targetingLossless:!1,deviceCompatible:!0,internetBandwidth:st.Poor,trackLosslessAvailable:!0},result:nt.Default_To_Very_High},{criteria:{online:!0,streamingLossless:!1,bitrateStrategy:[pe.ZT.OFFLINED_FILE],trackLosslessAvailable:!0},result:nt.Need_To_Redownload},{criteria:{online:!0,targetingLossless:!0,trackLosslessAvailable:!1},result:nt.Lossless_Unavailable},{criteria:{online:!0,isSetStreamingQualityLessThanLossless:!0},result:nt.Update_Setting}];const ot=[{criteria:{bitrateLevel:[pe.Yn.LOSSLESS],strategy:[pe.ZT.BEST_MATCHING,pe.ZT.BACKEND_ADVISED,pe.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:st.Good},{criteria:{bitrateLevel:[pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],targetBitrateLevel:[pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],strategy:[pe.ZT.BEST_MATCHING,pe.ZT.CACHED_FILE],deviceSupported:!0,autoAdjust:!0},result:st.Good},{criteria:{bitrateLevel:[pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],targetBitrateLevel:[pe.Yn.LOSSLESS],strategy:[pe.ZT.BEST_MATCHING,pe.ZT.BACKEND_ADVISED,pe.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0,autoAdjust:!0},result:st.Poor},{criteria:{bitrateLevel:[pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],targetBitrateLevel:[pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],strategy:[pe.ZT.BACKEND_ADVISED],deviceSupported:!0,autoAdjust:!0},result:st.Poor},{criteria:{bitrateLevel:[pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],targetBitrateLevel:[pe.Yn.LOSSLESS],targetBitrateAvailable:!1,deviceSupported:!0,autoAdjust:!0},result:st.Unavailable},{criteria:{autoAdjust:!1},result:st.Unknown},{criteria:{deviceSupported:!1},result:st.Unknown}],lt=[{criteria:{bitrateLevel:[pe.Yn.LOSSLESS,pe.Yn.LOSSLESS_24],deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[pe.Yn.UNKNOWN,pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],strategy:[pe.ZT.BEST_MATCHING,pe.ZT.BACKEND_ADVISED,pe.ZT.CACHED_FILE],targetBitrateLevel:[pe.Yn.LOSSLESS,pe.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!0},{criteria:{bitrateLevel:[pe.Yn.UNKNOWN,pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],strategy:[pe.ZT.OFFLINED_FILE],targetBitrateLevel:[pe.Yn.LOSSLESS,pe.Yn.LOSSLESS_24],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{strategy:[pe.ZT.BEST_MATCHING,pe.ZT.BACKEND_ADVISED,pe.ZT.CACHED_FILE],targetBitrateAvailable:!0,deviceSupported:!0},result:!1},{criteria:{deviceSupported:!1},result:!0},{criteria:{bitrateLevel:[pe.Yn.UNKNOWN,pe.Yn.LOW,pe.Yn.NORMAL,pe.Yn.HIGH,pe.Yn.VERY_HIGH],targetBitrateLevel:[pe.Yn.LOSSLESS,pe.Yn.LOSSLESS_24],targetBitrateAvailable:!1,deviceSupported:!0},result:!0},{criteria:{targetBitrateLevel:[pe.Yn.LOSSLESS,pe.Yn.LOSSLESS_24]},result:!0}],ct=(e,t)=>{for(const[i,n]of Object.entries(t.criteria))if(i===it.bitrateLevel){if(!n.includes(e[it.bitrateLevel]))return!1}else if(i===it.targetBitrateLevel){if(!n.includes(e[it.targetBitrateLevel]))return!1}else if(i===it.strategy){if(!n.includes(e[it.strategy]))return!1}else{if(!n===e[i])return!1}return!0},ut=e=>[pe.Yn.LOSSLESS,pe.Yn.LOSSLESS_24].includes(e);var dt=i(21753),pt=i(72181),mt=i(83989),gt=i(84014);const vt={losslessStatus:pe.p4.NONE,bitrateLevel:pe.Yn.UNKNOWN,targetBitrateLevel:pe.Yn.UNKNOWN,targetBitrateAvailable:!1,strategy:pe.ZT.UNKNOWN};function xt(){const{losslessStatus:e,bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s}=(0,gt.o)((e=>({...vt,...e?.playbackQuality??null})),F.a),r=(0,U.l)(),o=(0,z.t)(),[{data:l}]=(0,Q.K)(o.quality.streamingQuality),[{data:c}]=(0,Q.K)(o.quality.remoteQuality),u=(0,B.v)((e=>e.activeDevice)),d=(0,n.useMemo)((()=>null!==u&&u.losslessSupport?u.losslessSupport:{fullySupported:!1,deviceSupported:!1,userEligible:!1}),[u]).deviceSupported,{settings:{values:p}}=(0,pt.t0)(),m=p["audio.allow_downgrade"],g=u?.isLocal||!1;let v;v=g?s===pe.ZT.CACHED_FILE||s===pe.ZT.OFFLINED_FILE?at.Downloads:at.Internet:at.Spotify_Connect;const x={bitrateLevel:t,targetBitrateLevel:i,targetBitrateAvailable:a,strategy:s,isLocal:g,deviceSupported:d,autoAdjust:m},h=(e=>{for(const t of lt)if(ct(e,t))return t.result;return!(!ut(e[it.bitrateLevel])&&!ut(e[it.targetBitrateLevel]))})(x),y=(e=>{for(const t of ot)if(ct(e,t))return t.result;return e[it.strategy]===pe.ZT.BACKEND_ADVISED?st.Poor:st.Good})(x),b=(0,mt.n)(),f=ut(i)&&a,j=ut(t),C=ut(i),w=r?c?.streamingQuality:l,S=function({online:e,streamingLossless:t,targetingLossless:i,strategy:n,trackLosslessAvailable:a,autoAdjust:s,internetBandwidth:r,losslessCompatibleDevice:o,isLocal:l,isSetStreamingQualityLessThanLossless:c}){const u=[nt.Listen_Offline,nt.Connect_Explanation,nt.Bluetooth_Degrades_Lossless];for(const d of rt){const{criteria:p,result:m}=d;p.online===e&&(void 0!==p.autoAdjust&&p.autoAdjust!==s||void 0!==p.streamingLossless&&p.streamingLossless!==t||void 0!==p.targetingLossless&&p.targetingLossless!==i||void 0!==p.deviceCompatible&&p.deviceCompatible!==o||void 0!==p.bitrateStrategy&&!1===l||(void 0===p.bitrateStrategy||void 0!==n&&p.bitrateStrategy.includes(n))&&(void 0!==p.internetBandwidth&&p.internetBandwidth!==r||void 0!==p.trackLosslessAvailable&&p.trackLosslessAvailable!==a||void 0!==p.isSetStreamingQualityLessThanLossless&&p.isSetStreamingQualityLessThanLossless!==c||u.push(m)))}return u}({online:b,streamingLossless:j,targetingLossless:C,strategy:s,trackLosslessAvailable:f,autoAdjust:m,internetBandwidth:y,losslessCompatibleDevice:d,isLocal:g,isSetStreamingQualityLessThanLossless:!!w&&w<dt.a1.LOSSLESS&&w>dt.a1.AUTOMATIC});return{losslessStatus:e,bitrateLevel:t,flags:S,internetBandwidth:y,playingVia:{channelIsLossless:h,channel:v},losslessCompatibleDevice:d}}const ht=()=>{const{losslessCompatibleDevice:e,playingVia:t,internetBandwidth:i}=xt();return(0,h.jsxs)("div",{children:[(0,h.jsx)(tt,{metric:D.Ru.get("web-player.pigeon.audio-quality.lossless-compatible-device"),label:e?D.Ru.get("hifi.yes"):D.Ru.get("hifi.no"),severity:e?et.PASSING:et.NEEDS_ATTENTION}),(0,h.jsx)(tt,{metric:D.Ru.get("hifi.playingVia"),label:(()=>{const{channel:e}=t;switch(e){case at.Downloads:return D.Ru.get("local-files.source.downloads");case at.Internet:return D.Ru.get("hifi.networkConnection");case at.Spotify_Connect:return D.Ru.get("spotify-connect");default:return""}})(),severity:t.channelIsLossless?et.PASSING:et.NEEDS_ATTENTION}),(0,h.jsx)(tt,{metric:D.Ru.get("hifi.internetBandwidth"),label:(()=>{switch(i){case st.Good:return D.Ru.get("hifi.good");case st.Poor:return D.Ru.get("hifi.poor");case st.Unknown:default:return D.Ru.get("hifi.unknown")}})(),severity:(()=>{switch(i){case st.Good:return et.PASSING;case st.Poor:return et.NEEDS_ATTENTION;case st.Unknown:default:return et.UNKNOWN}})()})]})};var yt=i(1231);const bt={[nt.Listen_Offline]:()=>({type:"info",title:D.Ru.get("web-player.pigeon.help-cards.listen-offline.title"),message:D.Ru.get("web-player.pigeon.help-cards.listen-offline.body")}),[nt.Connect_Explanation]:()=>({type:"info",title:D.Ru.get("web-player.pigeon.help-cards.connect-explanation.title"),message:(0,h.jsx)(c.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:D.Ru.get("web-player.pigeon.help-cards.connect-explanation.body",(0,h.jsx)(yt.g,{size:"xsmall",alignmentBaseline:"baseline"}))})}),[nt.Bluetooth_Degrades_Lossless]:()=>({type:"info",title:D.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.title"),message:D.Ru.get("web-player.pigeon.help-cards.bluetooth-degrades-lossless.body")}),[nt.Opt_Out_Of_Downgrade]:()=>({type:"error",title:D.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.title"),message:D.Ru.get("web-player.pigeon.help-cards.opt-out-of-downgrade.body")}),[nt.Poor_Bandwidth_Interferes]:()=>({type:"error",title:D.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.title"),message:D.Ru.get("web-player.pigeon.help-cards.poor-bandwidth-interferes.body")}),[nt.Default_To_Very_High]:()=>({type:"error",title:D.Ru.get("web-player.pigeon.help-cards.default-to-very-high.title"),message:D.Ru.get("web-player.pigeon.help-cards.default-to-very-high.body")}),[nt.Need_To_Redownload]:()=>({type:"error",title:D.Ru.get("web-player.pigeon.help-cards.need-to-redownload.title"),message:D.Ru.get("web-player.pigeon.help-cards.need-to-redownload.body")}),[nt.Lossless_Unavailable]:()=>({type:"error",title:D.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.title"),message:D.Ru.get("web-player.pigeon.help-cards.lossless-unavailable.body")}),[nt.Update_Setting]:()=>({type:"error",title:D.Ru.get("web-player.pigeon.help-cards.update-settings.title"),message:D.Ru.get("web-player.pigeon.help-cards.update-settings.body")})},ft="BFsg6KnXzCo_ZKKekrFC",jt="OIOUgecXCtVCX_DzOsR4",Ct="qcU9Wt2Ly1y44H_lC327",wt=()=>{const{toPreviousView:e}=(0,n.useContext)(k),t=(0,fe.A)(),i=me(t),a=(()=>{const{flags:e}=xt(),t=[];return e.forEach((e=>{if(bt[e]){const{type:i,message:n,title:a}=bt[e]();"info"===i?t.push({id:e,text:n,title:a,type:He.INFO}):t.push({id:e,text:n,title:a??"",type:He.ERROR})}})),t})(),s=a.some(Ve),r=a.filter(s?Ve:qe);return(0,h.jsx)(y,{onBack:e,children:(0,h.jsxs)("div",{className:ft,children:[(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:D.Ru.get("web-player.pigeon.overview-card.title")}),(0,h.jsx)(c.E,{variant:"titleMedium",semanticColor:"textBrightAccent",children:i.titleFull||i.title}),(0,h.jsx)("div",{className:jt,children:i.bitrateDetails?.map(((e,t)=>(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:e},`bitrate-details-${t}`)))}),(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent"}),(0,h.jsx)("div",{className:Ct,children:(0,h.jsx)(ht,{})}),r.map((e=>(0,h.jsx)(Ge,{card:e},e.id)))]})})};var St=i(11333);const Nt=({subtitles:e})=>(0,h.jsx)(h.Fragment,{children:e.map(((e,t)=>(0,h.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:e},`subtitle-${t}`)))}),kt="ZExuZhVAKsqOBfFdR6Js",Rt="G5KBejq8q3GSZxhHs9be",It="WG0sT27gl2zSvisQcgHS",Et="iUbPCgoUSkOoOVEo5wnr",Lt="NCUCNjFgGqpox8ttJKch",Tt=({title:e,isLossless:t})=>(0,h.jsxs)("div",{className:Rt,children:[(0,h.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:e}),t&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:"•"}),(0,h.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBrightAccent",children:D.Ru.get("web-player.pigeon.audio-quality.lossless.highest")})]})]});var At=i(76528);const Pt=({onClick:e,quality:t,playQuality:i,maxQuality:n})=>{const{title:a,subtitles:s}=(e=>{switch(e){case dt.a1.LOSSLESS:return{title:D.Ru.get("web-player.pigeon.audio-quality.lossless"),subtitles:[D.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-1"),D.Ru.get("web-player.pigeon.audio-quality.lossless-24.bitrate-details-2")]};case dt.a1.VERY_HIGH:return{title:D.Ru.get("web-player.pigeon.audio-quality.very-high.label"),subtitles:[D.Ru.get("web-player.pigeon.audio-quality.very-high.bitrate-details.subtitle")]};case dt.a1.HIGH:return{title:D.Ru.get("web-player.pigeon.audio-quality.high.label"),subtitles:[D.Ru.get("web-player.pigeon.audio-quality.high.bitrate-details.subtitle")]};case dt.a1.MEDIUM:return{title:D.Ru.get("web-player.pigeon.audio-quality.normal.label"),subtitles:[D.Ru.get("web-player.pigeon.audio-quality.normal.bitrate-details.subtitle")]};case dt.a1.LOW:return{title:D.Ru.get("web-player.pigeon.audio-quality.low.label"),subtitles:[D.Ru.get("web-player.pigeon.audio-quality.low.bitrate-details.subtitle")]};default:return{title:D.Ru.get("web-player.pigeon.audio-quality.unknown.label"),subtitles:null}}})(t);if(null===a||null===s)return null;const r=i===t,o=t===dt.a1.LOSSLESS,l=null===n||t<=n;return(0,h.jsx)(V.v,{id:"title",variant:"naked",verticalGap:"2px","aria-disabled":!l,onClick:e,onClickHint:D.Ru.get("web-player.pigeon.quality-settings.option-hint",a),title:(0,h.jsx)(Tt,{title:a,isLossless:o}),subtitle:(0,h.jsx)(Nt,{subtitles:s}),trailing:r?(0,h.jsx)(St.i,{semanticColor:"textBrightAccent"}):void 0})},Dt=()=>{const{toPreviousView:e}=(0,n.useContext)(k),t=(0,U.l)(),{playingFrom:i}=M(),a=(0,z.t)(),[{data:s},{mutate:r}]=(0,Q.K)(a.quality.streamingQuality),[{data:o},{mutate:l}]=(0,Q.K)(a.quality.autoAdjustQuality),[{data:u},{mutate:d}]=(0,Q.K)(a.quality.remoteQuality),p=(0,At.x)();if(void 0===p||void 0===o||void 0===s)return null;let m=s,g=r,v=null;return t&&u&&(m=u.streamingQuality,v=u.maxSupportedQuality,g=e=>d({...u,streamingQuality:e})),(0,h.jsxs)(y,{onBack:e,children:[(0,h.jsxs)("div",{className:Lt,children:[(0,h.jsx)(c.E,{as:"h2",variant:"titleSmall",semanticColor:"textBase",children:D.Ru.get("web-player.pigeon.quality-settings.title")}),(0,h.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:i})]}),(0,h.jsx)("div",{className:kt,children:p.sort(((e,t)=>e.quality-t.quality)).map(((e,t)=>(0,h.jsx)(Pt,{quality:e.quality,playQuality:m,maxQuality:v,onClick:()=>g(e.quality)},t)))}),(0,h.jsx)(c.E,{children:D.Ru.get("web-player.pigeon.quality-settings.disclaimer")}),(0,h.jsxs)("div",{className:It,children:[(0,h.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:D.Ru.get("web-player.pigeon.quality-settings.listening-preferences")}),(0,h.jsx)(V.v,{className:Et,variant:"naked",size:"sm",id:"auto-adjust-quality",horizontalGap:"0px",title:(0,h.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:D.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality")}),trailing:(0,h.jsx)(Se.l,{id:"desktop.settings.automatic-downgrade",value:o,onSelected:l,condensed:!0})}),(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:D.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-1")}),(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:D.Ru.get("web-player.pigeon.quality-settings.auto-adjust-quality.subtitle-2")})]})]})};var Ot=i(44211),_t=i(41021),Ut=i(58476);const Bt="GYa976HrK40QHF7ZZvwM",Ft="MHROZzo24FoePahYMEFJ",Mt="qQ5CfbxUDYyLgy_O6Gah",Ht=({nrSteps:e,currentStep:t,onClick:i})=>(0,h.jsx)("div",{className:Bt,children:Array.from({length:e}).map(((e,n)=>(0,h.jsx)("button",{"aria-label":(0,Ut.v)(`Go to Step ${n+1}`),className:l()(Ft,{[Mt]:t===n}),onClick:()=>i(n)},n)))});var Vt=i(24818),qt=i(36378),zt=i(70490),Qt=i(23340);const Gt="Vpnd2l8y0SgEYWxGIRzB",Yt="cUTxS9VrHd466oEAGs7_",Kt="JvZLieWRZZQjIU2ElJ2Y",Zt="ub90kjJH_P8M2r1QL_jL",Wt="U3xgLhEWHrv2mb_ZSesP",Xt="ZiS7XuaKSNH6O814jzTW",Jt="W8RJgFmuCgvRsxpnXMWG",$t="pAYPkrJQFNaLczxADAGc",ei="nBOyGCpnbwg691MCewBj",ti="hr6LueujvRuzxi6lBlVZ",ii="zwfOn0Sx4qfhn2imHyQ9",ni="UcHPiDY6dLRbaeY65j16",ai="KsS00iz9PKUXYN0PHhno",si="h66wSXbM4f8lkj4EppJQ",ri=({imageUrl:e,max:t,alt:i=""})=>{const n=(0,Qt.dZ)();return(0,h.jsx)(zt._,{className:Wt,src:n(e,t),loading:"eager",alt:i})};var oi=i(63138);const li=({path:e,loop:t=!0})=>(0,h.jsx)(n.Suspense,{fallback:null,children:(0,h.jsx)(oi.o,{loop:t,autoplay:!0,path:e,className:Zt,style:{width:"auto",height:"100%"}})});var ci=i(81282);function ui({children:e,variant:t}){const i=(0,n.useRef)(null);return(0,ci.i)({ref:i}),(0,h.jsx)(c.E,{variant:t,semanticColor:"textBase",className:ei,tabIndex:-1,ref:i,children:e})}var di=i(90861);const pi={[di.E.SMALL]:{titleVariant:"bodyMediumBold",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:0,headerGap:0,assetGap:8,subtitleGap:4,titleGap:4,buttonGap:12,assetMaxHeight:165},[di.E.MEDIUM]:{titleVariant:"titleSmall",subtitleVariant:"marginalBold",bodyVariant:"bodySmall",containerGap:16,headerGap:24,assetGap:24,subtitleGap:12,titleGap:8,buttonGap:24,assetMaxHeight:240},[di.E.LARGE]:{titleVariant:"titleMedium",subtitleVariant:"bodySmall",bodyVariant:"bodyMedium",containerGap:32,headerGap:32,assetGap:48,subtitleGap:16,titleGap:8,buttonGap:32,assetMaxHeight:320}},mi="AOGvMtDLQNbo94n8r8mu",gi="gf6sr0Z5UAyf7ULRfSFA",vi=({icon:e,text:t,highlighted:i,condensed:n=!1,className:a})=>(0,h.jsxs)("div",{className:l()(mi,a),children:[(0,h.jsx)(e,{size:n?"xsmall":"small",semanticColor:"textBase",className:l()({[gi]:i})}),(0,h.jsx)(c.E,{variant:n?"marginalBold":"bodySmallBold",semanticColor:"textBase",className:l()({[gi]:i}),children:t})]});var xi=i(90089),hi=i(43895);const yi=({onboardingContent:e,onNext:t,onTertiaryClick:i,layout:s="vertical",showLoader:r=!1})=>{const{bodyTitle:o,bodySubtitle:u,bodyText:p,imageUrl:m,lottiePath:g,loopAnimation:v=!0,subtitleIcon:x,buttonText:y,tertiaryButtonText:b}=e,f=(0,xi.y)(),{titleVariant:j,subtitleVariant:C,bodyVariant:w,containerGap:S,headerGap:N,assetGap:k,subtitleGap:R,titleGap:I,buttonGap:E,assetMaxHeight:L}=(0,n.useMemo)((()=>{let e=di.E.MEDIUM;switch(f){case di.E.SMALL:e=di.E.SMALL;break;case di.E.MEDIUM:e=di.E.MEDIUM;break;case di.E.LARGE:e=di.E.LARGE}return pi[e]}),[f]),T=(0,n.useRef)(null),A=(0,hi.j)();return(0,h.jsx)(Vt.A,{mode:"out-in",children:(0,h.jsx)(a.A,{timeout:A?0:800,classNames:{enter:ii,enterActive:ni,exit:ai,exitActive:si},nodeRef:T,children:(0,h.jsx)("div",{className:Gt,style:{"--onboarding-container-gap":`${S}px`,"--onboarding-asset-gap":`${k}px`,"--onboarding-subtitle-gap":`${R}px`,"--onboarding-title-gap":`${I}px`,"--onboarding-button-gap":`${E}px`,"--onboarding-asset-max-height":`${L}px`,"--onboarding-header-gap":`${N}px`},ref:T,children:(0,h.jsxs)("div",{className:l()(Yt,{[Xt]:"horizontal"===s}),children:[(0,h.jsxs)("div",{className:Kt,children:[m?(0,h.jsx)(ri,{imageUrl:m,max:L}):null,g?(0,h.jsx)(li,{path:g,loop:v}):null]}),(0,h.jsxs)("div",{className:Jt,children:[(0,h.jsx)(vi,{icon:x,text:u,condensed:f!==di.E.LARGE,highlighted:!0,className:$t,variant:C}),(0,h.jsx)(ui,{variant:j,children:o}),(0,h.jsx)(c.E,{variant:w,children:p}),(0,h.jsx)("div",{className:ti,children:r?(0,h.jsx)(qt.m,{}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(d.$,{colorSet:"invertedLight",size:f===di.E.LARGE?"medium":"small",onClick:t,children:y}),i&&b?(0,h.jsx)(re.H,{size:f===di.E.LARGE?"medium":"small",onClick:i,condensed:!0,children:e.tertiaryButtonText}):null]})})]})]})})},o)})};var bi=i(20057);const fi=()=>[{bodyTitle:D.Ru.get("web-player.pigeon.introduction.step-1.title"),bodySubtitle:"Lossless",bodyText:D.Ru.get("web-player.pigeon.introduction.step-1.subtitle"),subtitleIcon:Ot.Q,buttonText:D.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00009256c4d947fba90f6244343446ee"},{bodyTitle:D.Ru.get("web-player.pigeon.introduction.step-2.title"),bodySubtitle:"Lossless",bodyText:D.Ru.get("web-player.pigeon.introduction.step-2.subtitle"),subtitleIcon:Ot.Q,buttonText:D.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc00005e4e6fd833f6f5c2cf4f81c1da66"},{bodyTitle:D.Ru.get("web-player.pigeon.introduction.step-3.title"),bodySubtitle:"Lossless",bodyText:D.Ru.get("web-player.pigeon.introduction.step-3.subtitle"),subtitleIcon:Ot.Q,buttonText:D.Ru.get("web-player.pigeon.introduction.button.next"),imageUrl:"spotify:image:ab671fcc000092564a451c0c1fba3acf8fed995f"},{bodyTitle:D.Ru.get("web-player.pigeon.introduction.step-4.title"),bodySubtitle:"Lossless",bodyText:D.Ru.get("web-player.pigeon.introduction.step-4.subtitle"),subtitleIcon:Ot.Q,buttonText:D.Ru.get("web-player.pigeon.introduction.button.done"),imageUrl:"spotify:image:ab671fcc000092562f3465b95599cdb50e47604e"}],ji=()=>{const[e,t]=be(),{setCurrentView:i,toPreviousView:a,viewTransitions:s}=(0,n.useContext)(k),{spec:r,logger:o}=(0,Pe.r)(_t.m,{}),l=s[b.DiscoverLossless],{onNext:c,onBack:u,currentStep:d,goTo:p}=function(e){const[t,i]=(0,n.useState)(0),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{t!==e-1?i(t+1):s(!0)}),[t,e]),o=(0,n.useCallback)((()=>{0!==t&&i(t-1),a&&s(!1)}),[t,a]),l=(0,n.useCallback)((t=>{t>=0&&t<e&&i(t),t===e?s(!0):a&&s(!1)}),[e,a]);return{currentStep:t,onNext:r,onBack:o,reachedEnd:a,goTo:l}}(fi().length),m=(0,n.useCallback)((()=>{o.logInteraction(r.closeButtonFactory().hitUiHide()),i(l.continue)}),[o,i,r,l.continue]);return(0,h.jsxs)(y,{titleSlot:(0,h.jsx)(bi.s,{variant:"bodySmallBold"}),onBack:()=>{o.logInteraction(r.backButtonFactory().hitUiHide()),d>0?u():a()},onClose:m,preventDefaultClose:!0,children:[(0,h.jsx)(yi,{onboardingContent:fi()[d],onNext:()=>{3===d?(o.logInteraction(r.doneButtonFactory().hitUiHide()),t(!0),i(l.continue)):c()}}),(0,h.jsx)(Ht,{nrSteps:fi().length,currentStep:d,onClick:p})]})};var Ci=i(821),wi=i(40069),Si=i(65152);const Ni=e=>({bodyTitle:D.Ru.get("web-player.puffin.activation-2.title",e.headphoneDevice?.deviceName),bodySubtitle:D.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Si.b)("animations/puffin-onboarding-tour-2.json"),subtitleIcon:wi.C,buttonText:D.Ru.get("web-player.puffin.activation-2.button-confirm"),tertiaryButtonText:D.Ru.get("web-player.puffin.activation-2.button-cancel"),loopAnimation:!1}),ki=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(k),{deviceFilterState:i,isMaybeHeadphoneDevice:a,isLoading:s}=(0,J.j)(),r=t[b.ActivationDetection];(0,n.useLayoutEffect)((()=>{i.headphoneDevice||s||!a||e(b.ManualSelection,{showDialogOnBack:!0})}),[i.headphoneDevice,s,a,e]);const o=(0,n.useMemo)((()=>i?.wasAmbiguous),[i]);return(0,h.jsx)(yi,{onboardingContent:Ni(i),onNext:()=>{e(o?r.airpods:r.continue)},onTertiaryClick:()=>{e(r.selectManually)},showLoader:s||!i.headphoneDevice})},Ri=()=>{const{deviceFilterState:e,isLoading:t}=(0,J.j)(),{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(k),s=a[b.ActivationIntro],r=(0,n.useCallback)((()=>{e.toggleTuneHeadphones?i(s.continue):i(s.selectManually,{showDialogOnBack:!0})}),[e,i,s.continue,s.selectManually]),o={bodyTitle:D.Ru.get("web-player.puffin.activation-1.title"),bodySubtitle:D.Ru.get("web-player.puffin.signifier-text"),lottiePath:(0,Si.b)("animations/puffin-onboarding-tour-1.json"),subtitleIcon:wi.C,buttonText:D.Ru.get("web-player.puffin.activation-1.button")};return(0,h.jsx)(yi,{onboardingContent:o,onNext:r,showLoader:t||!e.audioDevice})};var Ii=i(84576),Ei=i(39233);const Li=e=>{const{deviceFilterState:t}=(0,J.j)(),{setCurrentDevice:i}=ee(),a=(0,Ii.vh)(),{setCurrentView:s}=(0,n.useContext)(k),r=(0,n.useCallback)((async()=>{i(t.headphoneDevice,!0);try{await t.setFilterState({specificEnabled:!!t.toggleTuneHeadphones,externalizationEnabled:!!t.toggleTuneStudio})}catch{return void s(b.Error)}((e,t)=>{e.send((0,Ei.d)({has_tuner:!!t.toggleTuneHeadphones,filter_brand:t.headphoneDevice?.brand??null,filter_model:t.headphoneDevice?.model??null,was_predicted:!!t.predictedState,headphone_name_over_bluetooth:t.audioDevice?.transportType===O.Yg.BLUETOOTH?t.audioDevice.name:null,external_accessory_mapping_predicted_brand:t.predictedState?.predictedBrand??null,external_accessory_mapping_predicted_model:t.predictedState?.predictedModel??null,was_matched:(t.predictedState?.wasMatched&&!t.headphoneDevice?.isAmbiguous)??!1,was_ambiguous:t.headphoneDevice?.isAmbiguous??!1,was_manually_selected:(t.headphoneDevice?.isAmbiguous||t.headphoneDevice?.wasSelectedManually)??!1}))})(a,t),e()}),[t,a,e,i,s]);return{handleClick:r}},Ti=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(k),{spec:i,logger:a}=(0,Pe.r)(Ci.i,{}),s=t[b.ActivationSignifiers],{handleClick:r}=Li((()=>{a.logInteraction(i.doneButtonFactory().hitUiHide()),e(s.activate)}));return(0,h.jsx)(yi,{onboardingContent:{bodyTitle:D.Ru.get("web-player.puffin.activation-3.title"),bodySubtitle:D.Ru.get("web-player.puffin.signifier-text"),bodyText:D.Ru.get("web-player.puffin.activation-3.subtitle"),imageUrl:"spotify:image:ab671fcc00005e4ed89275c5e4eef1d432ac3fe2",subtitleIcon:wi.C,buttonText:D.Ru.get("web-player.puffin.button.done"),loopAnimation:!0},onNext:r})},Ai="FcycLYpZEbmuEClARSPP",Pi="NSoA0u_DehEmTu_M20Qn",Di="fGnSEIwIPGid9ALC9ANP",Oi="ZknipG1So_RdKeJ911k3",_i=({number:e,message:t})=>(0,h.jsxs)("div",{className:Di,children:[(0,h.jsx)("div",{className:Oi,children:(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",children:e})}),(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:t})]}),Ui=()=>{const{setCurrentView:e}=(0,n.useContext)(k);return(0,h.jsxs)("div",{className:Ai,children:[(0,h.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:D.Ru.get("web-player.puffin.device-connection-lost.title")}),(0,h.jsxs)("div",{className:Pi,children:[(0,h.jsx)(_i,{number:1,message:D.Ru.get("web-player.puffin.device-connection-lost.tip-1")}),(0,h.jsx)(_i,{number:2,message:D.Ru.get("web-player.puffin.device-connection-lost.tip-2")}),(0,h.jsx)(_i,{number:3,message:D.Ru.get("web-player.puffin.device-connection-lost.tip-3")}),(0,h.jsx)(_i,{number:4,message:D.Ru.get("web-player.puffin.device-connection-lost.tip-4")})]}),(0,h.jsx)(re.H,{semanticColor:"textSubdued",onClick:()=>{e(b.Overview)},children:"Still not working"})]})},Bi=()=>{const{removeCurrentDevice:e}=ee();return X({title:D.Ru.get("web-player.puffin.activation-dialog.title"),description:D.Ru.get("web-player.puffin.activation-dialog.subtitle"),confirmButtonText:D.Ru.get("web-player.puffin.activation-dialog.button-cancel"),cancelButtonText:D.Ru.get("web-player.puffin.activation-dialog.button-confirm"),onConfirm:()=>{e(!0),(0,K.I)("SETUP_HEADPHONES_BUTTON")}})},Fi=({type:e})=>{const{isMaybeHeadphoneDevice:t}=(0,J.j)(),{spec:i,logger:a}=(0,Pe.r)(Ci.i,{}),{triggerDialog:s,dialog:r}=Bi(),o=(0,n.useCallback)((()=>{a.logInteraction(i.closeButtonFactory().hitUiHide()),s(!0)}),[a,i,s]),l=(0,n.useCallback)((()=>{a.logInteraction(i.backButtonFactory().hitUiReveal()),s(!1)}),[a,i,s]);return(0,h.jsx)(y,{titleSlot:(0,h.jsx)(bi.s,{variant:"bodySmallBold"}),onClose:o,onBack:l,preventDefaultClose:!0,children:t?(0,h.jsxs)(h.Fragment,{children:[r,"intro"===e&&(0,h.jsx)(Ri,{}),"detection"===e&&(0,h.jsx)(ki,{}),"signifiers"===e&&(0,h.jsx)(Ti,{})]}):(0,h.jsx)(Ui,{})})};var Mi=i(11717),Hi=i(78358),Vi=i(89916),qi=i(27796),zi=i(73171);const Qi=({device:e,onClick:t,isAirpodDevice:i})=>{const n=i?`${e.model} (${e.releaseYear})`:e.model,a=i?D.Ru.get("web-player.puffin.manual-selection.models-list",e.modelNumbers.join(D.Ru.getSeparator())):e.brand;return(0,h.jsx)(zi.c,{children:(0,h.jsx)(V.v,{variant:"naked",size:"md",isInteractive:!0,id:e.id,title:(0,h.jsx)(we.d,{onClick:()=>{t(e)},children:n}),subtitle:a,trailing:(0,h.jsx)(qi.V,{size:"small",semanticColor:"textSubdued"}),onClick:()=>{t(e)},hoverAnimationDuration:"0s"},e.id)})},Gi="fjltNoIqUMIY7LfgtvCH",Yi="WNi2uq00PuqJnOvv6b6a",Ki="W3HfPxIGTvmPJNItOM5A",Zi="T3zyYZ33nGeJfw6NgwwV",Wi="fr_QT3qQxce_KdFUhktQ",Xi="wMsnDxvKohBJOUguxi8p",Ji="O842FkxrdjAlid2byB9c",$i="E6yKOmbA9ekxMnRhJDnA",en="sm96uN6u5WGLjNfbT6kF",tn="bWJ8TFqqyCV4TqeScz7D",nn="SRl_K6g2YOd8qrpIFij7",an=({search:e})=>(0,h.jsxs)("div",{className:$i,children:[(0,h.jsx)(c.E,{semanticColor:"textBase",variant:"titleSmall",className:en,children:D.Ru.get("web-player.puffin.manual-selection.empty.title",(0,h.jsx)("span",{className:tn,children:(0,h.jsx)("span",{className:nn,children:e})}))}),(0,h.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:D.Ru.get("web-player.puffin.manual-selection.empty.subtitle")})]}),sn={id:"unknown_device",brand:"",model:"",deviceName:"Generic",modelNumbers:[],releaseYear:""},rn=({devices:e,isAirpodsList:t=!1})=>{const{setCurrentView:i,viewTransitions:a}=(0,n.useContext)(k),s=t?a[b.AirpodsSelection]:a[b.ManualSelection],{filter:r,setFilter:o}=(0,n.useContext)(Hi.g),{setCurrentDevice:l}=ee(),c=(0,n.useCallback)((e=>{const n=e?{...e,wasSelectedManually:!0,isAmbiguous:t}:null;l(n,!0),i(e?.id===sn.id?s.notFound:s.continue),o("")}),[t,l,i,s.notFound,s.continue,o]),u=e.filter((({deviceName:e,brand:t,model:i,modelNumbers:n})=>[e,t,i,...n].some((e=>e.toLowerCase().includes(r.toLowerCase())))));return(0,h.jsxs)("div",{className:Xi,children:[(0,h.jsx)(Vi.$,{children:u.map((e=>(0,h.jsx)(Qi,{device:e,onClick:c,isAirpodDevice:t},e.id)))}),0===u.length&&(0,h.jsx)(an,{search:r}),(0,h.jsx)("div",{className:Wi,children:(0,h.jsx)(se.n,{size:"small",onClick:()=>{c(sn)},children:D.Ru.get("web-player.puffin.manual-selection.not-found-button")})})]})};var on=i(15758);const ln=()=>{const e=(0,$.N)(),{data:t,isLoading:i,isError:n}=(0,on.I)({queryKey:["puffin-devices"],queryFn:async()=>await e.getDevices(),gcTime:18e5,staleTime:6e5});return{data:t??null,loading:i,error:n}},cn=()=>{const{toPreviousView:e}=(0,n.useContext)(k),{data:t}=ln(),i=(0,n.useMemo)((()=>t?.filter((e=>"apple"===e.brand.toLowerCase()&&e.model.toLowerCase().includes("airpods")))),[t]);return(0,h.jsx)(y,{onBack:()=>{e()},children:(0,h.jsxs)(Hi.s,{uri:"spotify:internal:bettersound",children:[(0,h.jsxs)("div",{className:Yi,children:[(0,h.jsx)("div",{className:Ki}),(0,h.jsxs)("div",{className:Zi,children:[(0,h.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:D.Ru.get("web-player.puffin.manual-selection.airpods.title")}),(0,h.jsx)(c.E,{variant:"bodySmall",children:D.Ru.get("web-player.puffin.manual-selection.airpods.subtitle")})]}),(0,h.jsx)(Mi.S,{placeholder:D.Ru.get("web-player.puffin.manual-selection.airpods.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,h.jsx)("div",{className:Gi,children:(0,h.jsx)(rn,{devices:i,isAirpodsList:!0})}):(0,h.jsx)("div",{className:Ji,children:(0,h.jsx)(qt.m,{})})]})})},un=()=>{const{setCurrentView:e,viewTransitions:t}=(0,n.useContext)(k),i=t[b.IncompatibleHeadphones],{handleClick:a}=Li((()=>e(i.continue))),{toPreviousView:s}=(0,n.useContext)(k);return(0,h.jsx)(y,{onBack:()=>{s()},titleSlot:(0,h.jsx)(bi.s,{variant:"bodySmallBold"}),children:(0,h.jsx)(yi,{onboardingContent:{bodyTitle:(0,Ut.v)("These headphones are not compatible with Optimize yet."),bodySubtitle:(0,Ut.v)("Optimize"),bodyText:(0,Ut.v)("Only some devices work with Optimize. We're expanding our compatible devices to support a wider range of headphones."),imageUrl:"spotify:image:ab671fcc000092562c122d1cc442ac4f3c8dbab4",subtitleIcon:wi.C,buttonText:(0,Ut.v)("Close")},onNext:a})})},dn=()=>{const{toPreviousView:e,viewOptions:t}=(0,n.useContext)(k),{data:i}=ln(),{triggerDialog:a,dialog:s}=Bi();return(0,h.jsxs)(y,{onBack:()=>{t?.showDialogOnBack?a():e()},titleSlot:(0,h.jsx)(bi.s,{variant:"bodySmallBold"}),children:[s,(0,h.jsxs)(Hi.s,{uri:"spotify:internal:bettersound",children:[(0,h.jsxs)("div",{className:Yi,children:[(0,h.jsx)("div",{className:Ki}),(0,h.jsxs)("div",{className:Zi,children:[(0,h.jsx)(c.E,{variant:"bodyMediumBold",semanticColor:"textBase",children:D.Ru.get("web-player.puffin.manual-selection.title")}),(0,h.jsx)(c.E,{variant:"bodySmall",children:D.Ru.get("web-player.puffin.manual-selection.subtitle")})]}),(0,h.jsx)(Mi.S,{placeholder:D.Ru.get("web-player.puffin.manual-selection.search-placeholder"),alwaysExpanded:!0,fullWidth:!0,debounceFilterChangeTimeout:0})]}),i?(0,h.jsx)("div",{className:Gi,children:(0,h.jsx)(rn,{devices:i})}):(0,h.jsx)("div",{className:Ji,children:(0,h.jsx)(qt.m,{})})]})]})};var pn=i(20520),mn=i(85690);const gn=()=>{const{currentView:e}=(0,n.useContext)(k);switch(e){case b.ActivationIntro:return(0,h.jsx)(Fi,{type:"intro"});case b.ActivationDetection:return(0,h.jsx)(Fi,{type:"detection"});case b.ActivationSignifiers:return(0,h.jsx)(Fi,{type:"signifiers"});case b.Error:return(0,h.jsx)(L,{});case b.ManualSelection:return(0,h.jsx)(dn,{});case b.AirpodsSelection:return(0,h.jsx)(cn,{});case b.Overview:return(0,h.jsx)(_e,{});case b.AudioQualitySettings:return(0,h.jsx)(Dt,{});case b.AudioQualityDetails:return(0,h.jsx)(wt,{});case b.DiscoverLossless:return(0,h.jsx)(ji,{});case b.IncompatibleHeadphones:return(0,h.jsx)(un,{});default:return(0,mn.k)(e),null}},vn=()=>{const{currentView:e}=(0,n.useContext)(k),t=(0,j._Y)(),i=(0,j.XB)(),a=[m.Z.Puffin,m.Z.PuffinActivation,m.Z.PuffinOverlay,m.Z.PuffinActivationOverlay].some((e=>e===i)),s=[b.ActivationIntro,b.ActivationDetection,b.ActivationSignifiers,b.DiscoverLossless,b.ManualSelection,b.AirpodsSelection,b.IncompatibleHeadphones].includes(e),r=[b.ActivationIntro,b.ActivationDetection,b.ActivationSignifiers,b.ManualSelection,b.IncompatibleHeadphones].includes(e);(0,n.useEffect)((()=>{a&&t(r?W.$S.PUFFIN_START_ACTIVATION:W.$S.PUFFIN_FINISH_ACTIVATION)}),[t,r,a]);const o=(0,n.useRef)(null),{breakpoint:c}=(0,pn.c)({[di.E.SMALL]:0,[di.E.MEDIUM]:448,[di.E.LARGE]:780},o);return(0,h.jsx)(Be.w,{className:l()({[x]:s}),ref:o,children:(0,h.jsx)(xi.o.Provider,{value:c,children:(0,h.jsxs)("div",{className:g,children:[(0,h.jsx)(gn,{}),false]})})})},xn=()=>(0,h.jsx)(Ue._,{label:"Puffin",focusTransferId:"PUFFIN",children:(0,h.jsx)(r.s,{fallback:T,children:(0,h.jsx)(R,{children:(0,h.jsx)(vn,{})})})});var hn=i(34889),yn=i(75485);function bn(e){return e.sort(((e,t)=>t.timestamp-e.timestamp))}function fn(e,t){return t.some((t=>t.user.uri===e.user.uri))?t:bn([...t,e])}function jn(e,t){return t.filter((t=>t.user.uri!==e))}var Cn=i(75627);var wn=i(6707),Sn=i(90901);function Nn(){const e=(0,yn.C)(),t=(0,hn.jE)(),i=["friend-activity"],a=e=>{t.setQueryData(i,((t=[])=>function(e,t){return bn(t.map((t=>t.user.uri===e.user.uri?e:t)))}(Array.isArray(e)?e[0]:e,t)))},{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}=function(e){const t=(0,yn.C)(),i=(0,n.useRef)({}),a=(0,n.useRef)(e);a.current=e;const s=(0,n.useCallback)((e=>{const n=(0,Cn.o_h)(e)?.username,s=t.subscribeToBuddyActivity(n,(e=>{e&&a.current(e)}));return i.current[e]=s,s}),[t]),r=(0,n.useCallback)((e=>{i.current[e]?.cancel(),delete i.current[e]}),[]),o=(0,n.useCallback)(((e,i,n)=>t.fetchFriendActivityWithSubscriptions(e,i,n)),[t]);return(0,n.useEffect)((()=>{const e=i.current;return()=>{Object.values(e).forEach((e=>{e.cancel()}))}}),[t]),{subscribeToFriend:s,unSubscribeFromFriend:r,subscribeAndFetchFeed:o}}(a),l=(0,n.useRef)();(0,n.useEffect)((()=>()=>l.current?.cancel()),[]);const c=(0,on.I)({queryKey:i,queryFn:()=>new Promise(((e,t)=>{l.current=o(a,e,t)})).then((e=>bn(e))),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,Sn.N)(wn.mc.OPERATION_COMPLETE,(async n=>{const a=n.data.uris;if(n.data.operation!==wn.JK.FOLLOW_USER){if(n.data.operation===wn.JK.UNFOLLOW_USER)for(const e of a)r(e),t.setQueryData(i,((t=[])=>jn(e,t)))}else for(const n of a){const a=(await e.fetchFriendActivity([n]))[0];t.setQueryData(i,((e=[])=>fn(a,e))),s(n)}})),c}const kn=(0,n.lazy)((()=>Promise.all([i.e(4151),i.e(7564)]).then(i.bind(i,65803))));function Rn(){const{data:e,error:t,isLoading:i}=Nn();return!(0,mt.n)()||i||t?null:(0,h.jsx)(kn,{friends:e??[]})}var In=i(85099);function En(e){return e.sort(((e,t)=>t.timestamp-e.timestamp))}function Ln(e,t){return t.some((t=>t.user.uri===e.user.uri))?t:En([...t,e])}function Tn(e,t){return t.filter((t=>t.user.uri!==e))}var An=i(5050),Pn=i(54550);function Dn(){const e=(0,In.C)(),t=(0,hn.jE)(),i=["friend-activity"],{subscribeToFriend:a,unSubscribeFromFriend:s}=function(e){const t=(0,In.C)(),i=(0,n.useRef)({}),a=(0,n.useRef)(e);a.current=e;const s=(0,n.useCallback)((e=>{const n=(0,Cn.o_h)(e)?.username,s=t.subscribeToBuddyActivity(n,(e=>{e&&a.current(e)}));return i.current[e]=s,s}),[t]),r=(0,n.useCallback)((e=>{i.current[e]?.cancel(),delete i.current[e]}),[]);return(0,n.useEffect)((()=>{const e=i.current;return()=>{Object.values(e).forEach((e=>{e.cancel()}))}}),[]),{subscribeToFriend:s,unSubscribeFromFriend:r}}((e=>{t.setQueryData(i,((t=[])=>function(e,t){return En(t.map((t=>t.user.uri===e.user.uri?e:t)))}(e,t)))})),r=(0,on.I)({queryKey:i,queryFn:()=>Pn.xA(An.n.getInstance()).then((e=>(e.body.friends.forEach((e=>a(e.user.uri))),En(e.body.friends)))),staleTime:6e5,gcTime:36e5,refetchInterval:864e5,refetchOnWindowFocus:!1,refetchOnMount:"always",refetchOnReconnect:!0});return(0,Sn.N)(wn.mc.OPERATION_COMPLETE,(async n=>{const r=n.data.uris;if(n.data.operation!==wn.JK.FOLLOW_USER){if(n.data.operation===wn.JK.UNFOLLOW_USER)for(const e of r)s(e),t.setQueryData(i,((t=[])=>Tn(e,t)))}else for(const n of r){const s=(await e.fetchFriendActivity([n]))[0];t.setQueryData(i,((e=[])=>Ln(s,e))),a(n)}})),r}const On=(0,n.lazy)((()=>Promise.all([i.e(4151),i.e(6548)]).then(i.bind(i,40889))));function _n(){const{data:e,error:t,isLoading:i}=Dn();return!(0,mt.n)()||i||t?null:(0,h.jsx)(On,{friends:e??[]})}var Un=i(80762),Bn=i(17186);const Fn="device-picker-section-heading",Mn="device-picker-troubleshooting-list",Hn="uqXaqvqZq1oSLhXLYRo9",Vn="YuPZ1nUe5BAH7HJworb6",qn="wWalUsrOkGgHa0u8o86Q",zn="yNttGX9uUxTih93MKEWB",Qn="kD25df_SN_uDB8lhZgQB",Gn="szp7gPJjKd4T69SzCEpF",Yn="E912cqRfb05FrRPFKDZ_",Kn="D7sZlTAybIM02cRvh4sV",Zn="xdAVCtEIoo_8z_Ubj7tU",Wn=({foundDevices:e})=>{const t=e?D.Ru.get("web-player.connect.device-picker.select-another-device"):D.Ru.get("web-player.connect.device-picker.no-devices-found");return(0,h.jsx)("span",{className:zn,id:Fn,"data-testid":Fn,children:(0,h.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",children:t})})};var Xn=i(55423),Jn=i(40638),$n=i(11277),ea=i(91825),ta=i(66686),ia=i(13377),na=i(43494),aa=i(38386),sa=i(44979),ra=i(57903),oa=i(2911),la=i(306),ca=i(99903),ua=i(1127),da=i(12433),pa=i(19412),ma=i(48431),ga=i(56825),va=i(25214);var xa=i(33058);const ha="mFr6W9mwg0p_c7eJlhc_",ya="lpPBKkIGJcyWu59iOpsS",ba=({deviceId:e,connectStateDeviceId:t,allowForgetDevice:i,incarnation:n})=>{const a=(0,ma.e)(),r=(0,va.N)(ga.r),o=(0,te.s)(),{spec:l}=(0,Pe.r)(la.d,{}),c=(0,xa.t)(l),u=l.forgetDeviceButtonFactory(),d=(0,xa.t)(u),p=l.deviceIncarnationContainerFactory(),m=(0,xa.t)(p),g=(0,s.NC)(pa.NPo);return i||n?(0,h.jsx)("span",{ref:c,className:ya,children:(0,h.jsxs)(ca.W,{children:[i&&(0,h.jsx)(da.D,{role:"menuitem",leadingIcon:(0,h.jsx)(oa.V,{size:"small"}),onClick:()=>{o.logInteraction(u.hitLogoutFromRemoteDevice({remoteDeviceId:t})),g?r.logout(e):a.logout(e)},elementRef:d,children:D.Ru.get("web-player.connect.context-menu.forget-device")}),n&&(0,h.jsxs)("div",{ref:m,children:[(0,h.jsx)(ua.y,{children:D.Ru.get("web-player.connect.context-menu.incarnation-title")}),n.available.map((i=>{const{icon:s,text:l}=(e=>{switch(e){case"connect":return{icon:(0,h.jsx)($n.E,{size:"small"}),text:D.Ru.get("web-player.connect.context-menu.incarnation-connect")};case"cast":return{icon:(0,h.jsx)(ra.m,{size:"small"}),text:D.Ru.get("web-player.connect.context-menu.incarnation-cast")};default:return{}}})(i);return(0,h.jsx)(da.D,{role:"menuitemradio",leadingIcon:s,onClick:()=>{let s;switch(i){case"cast":s=p.googleCastButtonFactory();break;case"connect":s=p.spotifyConnectButtonFactory()}n.preferred!==i?(s&&o.logInteraction(s.hitChangeRemoteDeviceIncarnation({remoteDeviceId:t})),g?r.setPreferredIncarnation(e,i):a.setPreferredIncarnation(e,i)):s&&o.logInteraction(s.hitNoAction())},"aria-checked":n.preferred===i,CheckedIcon:St.i,children:l},i)}))]})]})}):null};var fa=i(63112);const ja=({title:e,deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s,className:r,onHide:o,onShow:c,spec:u})=>{const[d,p]=(0,n.useState)(!1),m=u.contextMenuButtonFactory({identifier:i}),g=(0,te.s)(),v=(0,xa.t)(m);return(0,h.jsx)(sa.b,{renderInline:!0,menu:(0,h.jsx)(fa.r,{spec:m,children:(0,h.jsx)(ba,{deviceId:t,connectStateDeviceId:i,allowForgetDevice:a,incarnation:s})}),onShow:()=>{p(!0),c?.()},onHide:()=>{p(!1),o?.()},offset:[0,-8],children:(0,h.jsx)(aa.e,{ref:v,size:aa.M.xs,label:D.Ru.get("more.label.context",e),className:l()(ha,r),onClick:e=>{e.stopPropagation(),g.logInteraction(d?m.hitUiHide():m.hitUiReveal())}})})},Ca=(0,n.createContext)({rowWithMenuOpenIdentifier:null,setRowWithMenuOpenIdentifier:()=>{}}),wa=({children:e})=>{const[t,i]=(0,n.useState)(null);return(0,h.jsx)(Ca.Provider,{value:{rowWithMenuOpenIdentifier:t,setRowWithMenuOpenIdentifier:i},children:e})},Sa=e=>e instanceof Xn.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory||e instanceof Xn.B.ContainerViewEventFactory.DeviceListEventFactory.DisabledDeviceEventFactory||e instanceof Xn.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.RemoteDeviceEventFactory||e instanceof Xn.B.ContainerViewEventFactory.OffNetworkDeviceListEventFactory.DisabledDeviceEventFactory||e instanceof Xn.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory.RemoteDeviceEventFactory,Na=e=>e instanceof Xn.B.ContainerViewEventFactory.DeviceListEventFactory.RemoteDeviceEventFactory;var ka=i(45247),Ra=i(28261),Ia=i(72509),Ea=i(70865),La=i(76766),Ta=i(7917),Aa=i(27602);const Pa="AWblt0YATqa_XQaPUDMc",Da="sX7AwqoSzMeT9qhlEViU",Oa="jIlVu16bmijzUKG6u5VW",_a="ZkuPLR9bss2N7f7thixx",Ua="QSZFk1XCj76mVplNmiV1",Ba="O0wmxPM0kfA59paiHqR9",Fa=(0,n.forwardRef)((function({deviceId:e,connectStateDeviceId:t,Icon:i,TechIcon:a,title:r,subtitle:o,canLogout:c,isDisabled:u,incarnation:d,onClick:p,spec:m},g){const v=(0,j._Y)(),x=(0,P.wA)(),y=(0,te.s)(),b=(0,ka.HJ)(d),f=c||b,{rowWithMenuOpenIdentifier:C,setRowWithMenuOpenIdentifier:w}=(0,n.useContext)(Ca),S=(e=>{const t=(0,La.d)(),i=(0,hn.jE)(),n=(0,s.NC)(Aa.PE,{loadingValue:!1}),{data:a}=(0,on.I)({queryKey:["useResolveJamFromConnectDevice",e],queryFn:()=>t.getJoinTokenFromConnectDeviceId(e),enabled:n}),{data:r}=(0,on.I)({queryKey:["useResolveJamFromConnectDevice",a],queryFn:a?()=>t.getSessionInfo(a):Ia.hT,enabled:!!a});return(0,Ta.c)(Ea.P.SCAN_UPDATE,(()=>{i.invalidateQueries({queryKey:["useResolveJamFromConnectDevice",e]})})),r??null})(t),N=(0,xa.t)(Na(m)&&S?.joinSessionToken?m.inPersonListeningSessionFactory({identifier:S.sessionId??S.joinSessionToken}):void 0,!!S?.joinSessionToken),k=(0,Jn.YQ)((()=>{u||(S?.joinSessionToken?(Na(m)&&y.logInteraction(m.inPersonListeningSessionFactory({identifier:S.sessionId??S.joinSessionToken}).hitUiReveal()),x((0,ta.A9)(Ra.EL.JOIN_LISTENING_SESSION,S.joinSessionToken,void 0,t))):(p?.(),v(W.$S.PANEL_CLOSE_CLICK)))}),1e3,{leading:!0,trailing:!1}),R=(0,n.useCallback)((e=>{"Enter"===e.key&&k()}),[k]),I=(0,h.jsx)(ba,{deviceId:e,connectStateDeviceId:t,allowForgetDevice:c,incarnation:b?d:void 0}),E=S?.sessionMembers.find((e=>e.id===S.sessionOwnerId))?.displayName,L=E&&!S.isSessionOwner?(0,h.jsxs)("div",{className:Da,ref:N,children:[(0,h.jsx)($n.E,{semanticColor:"textBrightAccent",size:"small"}),(0,h.jsx)(ea.j,{semanticColor:"textBrightAccent",lineClamp:1,children:D.Ru.get("web-player.social-connect.broadcasting.bradcasting-device-subtitle",{host:E})})]}):(0,h.jsxs)("div",{className:Da,children:[a&&(0,h.jsx)(a,{className:Oa,semanticColor:"textSubdued","data-testid":"sub-icon",role:"presentation",size:"small"}),o&&(0,h.jsx)(ea.j,{semanticColor:"textSubdued",lineClamp:1,children:o})]});return(0,h.jsx)(ia.h,{menu:I,children:(0,h.jsx)(zi.c,{onKeyDown:R,onClick:k,className:l()(_a,{[Ba]:C===e}),children:(0,h.jsx)(V.v,{id:e,ref:g,"data-testid":"device-picker-row-sidepanel",media:(0,h.jsx)(i,{semanticColor:u?"textSubdued":"textBase","data-testid":"main-icon",role:"presentation"}),onClick:()=>{},onClickHint:D.Ru.get("web-player.connect.device-picker.connect-to-device"),title:(0,h.jsx)("span",{className:Pa,children:(0,h.jsx)(na.Zp,{label:r,renderInline:!0,children:(0,h.jsx)(we.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:u?"textSubdued":"textBase",dir:"auto",children:r})})}),subtitle:L,trailing:f&&Sa(m)&&(0,h.jsx)(ja,{title:r,deviceId:e,connectStateDeviceId:t,allowForgetDevice:c,incarnation:b?d:void 0,spec:m,className:l()(Ua),onShow:()=>{w(e)},onHide:()=>{w(null)}})})})})})),Ma=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,deviceModelName:s,isGroup:r,disabledReason:o,canLogout:l,spec:c})=>{const u=(0,ka.tf)(a,r),{helpText:d}=(0,ka.uY)(o,(0,ka.p2)(a,s)),p=c.disabledDeviceFactory({identifier:i,position:e,reason:o??"null"}),m=(0,xa.t)(p);return(0,h.jsx)(Fa,{deviceId:t,connectStateDeviceId:i,ref:m,isDisabled:!0,Icon:u,title:n,subtitle:d,canLogout:l,spec:p})};var Ha=i(77506),Va=i(64407);const qa=({isDisabled:e=!1,spec:t})=>{const i=(0,P.wA)(),n=t.containerViewFactory().deviceListFactory().castPlaceholderFactory(),a=(0,xa.t)(n),s=(0,ka.$A)(Va.bq.CAST_AUDIO,"disconnected"),r=(0,te.s)();return(0,h.jsx)(Fa,{deviceId:"cast-placeholder",connectStateDeviceId:"cast-placeholder",ref:a,Icon:s,title:D.Ru.get("web-player.connect.device-picker.google-cast-devices"),supportsHiFi:!1,onClick:()=>{r.logInteraction(n.hitUiReveal()),i((0,Ha.Ym)())},isDisabled:e,spec:n})};var za=i(7866);const Qa=({deviceId:e,connectStateDeviceId:t,deviceName:i,supportsHiFi:n,spec:a})=>{const r=(0,te.s)(),o=a.localDeviceFactory(),l=(0,ka.tf)(Va.bq.COMPUTER,!1),c=(0,ma.e)(),u=(0,za.D)(),d=(0,s.NC)(pa.p41);return(0,h.jsx)(Fa,{deviceId:e,connectStateDeviceId:t,Icon:l,title:i,supportsHiFi:n,onClick:()=>{const{interactionId:t,pageInstanceId:i}=r.logInteraction(o.hitPullPlaybackToLocalDevice());(d?u:c).transferPlayback(e,{interactionId:t,pageInstanceId:i})},spec:o})},Ga=()=>{const[e,t]=(0,ye.x)("connect-picker-recent-transfers",{});return{registerTransferAttempt:(0,n.useCallback)((i=>{t({...e,[i]:(new Date).getTime()})}),[e,t]),recentTransfersMap:e}},Ya=({position:e,deviceId:t,connectStateDeviceId:i,deviceName:n,deviceType:a,isGroup:r,supportsHiFi:o,canLogout:l,incarnation:c,spec:u})=>{const d=(0,te.s)(),p=u.remoteDeviceFactory({identifier:i,position:e}),m=(0,ka.tf)(a,r);let g,v;(0,ka.Mp)(a)&&(g=(0,ka.$A)(a,"disconnected"),v=D.Ru.get("web-player.connect.device-picker.google-cast"));const{registerTransferAttempt:x}=Ga(),y=(0,ma.e)(),b=(0,za.D)(),f=(0,s.NC)(pa.p41),j=(0,xa.t)(p);return(0,h.jsx)(Fa,{deviceId:t,connectStateDeviceId:i,ref:j,Icon:m,TechIcon:g,title:n,subtitle:v,supportsHiFi:o,canLogout:l,incarnation:c,onClick:()=>{const{interactionId:e,pageInstanceId:n}=d.logInteraction(p.hitConnectToRemoteDevice({remoteDeviceId:i}));(f?b:y).transferPlayback(t,{interactionId:e,pageInstanceId:n}),x(i)},spec:p})},Ka=()=>(0,gt.o)((e=>(e?.restrictions?.disallowTransferringPlaybackReasons?.length??0)>0));var Za=i(62895);const Wa=({devices:e,areWebPlayerCastDevicesAvailable:t=!1,networkHeadingID:i="",spec:n})=>{const a=(0,Za.Ek)(),s=Ka(),r=n.containerViewFactory().deviceListFactory(),o=(0,xa.t)(r),l=(e,t)=>{const i=a?D.Ru.get("web-player.connect.device-picker.this-computer"):D.Ru.get("web-player.connect.device-picker.this-web-browser");return e.isDisabled?(0,h.jsx)(Ma,{position:e.isLocal?0:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.isLocal?i:e.name,deviceType:e.isLocal?Va.bq.COMPUTER:e.type,deviceModelName:e.modelDisplayName,isGroup:e.isGroup,disabledReason:e.disabledReason,canLogout:!e.isLocalNetwork&&e.supportsLogout,spec:r},e.id):e.isLocal&&(e=>e instanceof Xn.B.ContainerViewEventFactory.DeviceListEventFactory||e instanceof Xn.B.ContainerViewEventFactory.OnNetworkDeviceListEventFactory)(r)?(0,h.jsx)(Qa,{deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:i,supportsHiFi:e.losslessSupport.fullySupported,spec:r},e.id):(0,h.jsx)(Ya,{position:t+1,deviceId:e.id,connectStateDeviceId:e.connectStateId,deviceName:e.name,deviceType:e.type,isGroup:e.isGroup,supportsHiFi:e.losslessSupport.fullySupported,canLogout:!e.isLocalNetwork&&e.supportsLogout,incarnation:e.incarnation,spec:r},e.id)};return(0,h.jsxs)(Vi.$,{circular:!1,ref:o,"aria-labelledby":`${Fn} ${i}`,"data-testid":`devices-list-${i}`,allowsMultipleInteractiveChildrenInItem:!0,children:[e.map(((e,t)=>l(e,t))),t&&(0,h.jsx)(qa,{isDisabled:s,spec:n})]})},Xa="local-network-heading",Ja="other-networks-heading",$a=({localNetworkDevices:e,otherNetworksDevices:t,spec:i})=>(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.E,{as:"h3",variant:"bodySmall",semanticColor:"textSubdued",className:Qn,id:Xa,children:e.length>0?D.Ru.get("web-player.connect.device-picker.on-this-network"):D.Ru.get("web-player.connect.device-picker.no-devices-local-network")}),e.length>0&&(0,h.jsx)(Wa,{devices:e,networkHeadingID:Xa,spec:i}),t.length>0&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.E,{as:"h3",variant:"bodySmall",semanticColor:"textSubdued",className:l()(Qn,Gn),id:Ja,children:D.Ru.get("web-player.connect.device-picker.on-other-networks")}),(0,h.jsx)(Wa,{devices:t,networkHeadingID:Ja,spec:i})]})]});var es=i(35916);const ts=({url:e,linkText:t,handleClick:i,elementRef:n})=>(0,h.jsx)("a",{className:l()(_a),href:e,target:"_blank",ref:n,onClick:i,children:(0,h.jsx)(V.v,{title:t,id:t,isRedundantOnClick:!0,onClick:()=>{},"data-testid":"list-row-external-link",trailing:(0,h.jsx)(es.H,{size:"small","data-testid":"icon-external-link",semanticColor:"textSubdued",role:"presentation",autoMirror:!0,"aria-hidden":"true"})})}),is=({spec:e})=>{const t=`https://www.spotify.com/connect${`?utm_campaign=connect&utm_medium=${(0,Za.Ek)()?"app":"web"}&utm_source=desktop`}`,i=e.containerViewFactory().externalConnectHubLinkFactory(),n=(0,xa.t)(i),a=(0,te.s)();return(0,h.jsx)(ts,{url:t,linkText:D.Ru.get("web-player.connect.device-picker.connect-hub-external-link"),elementRef:n,handleClick:()=>{a.logInteraction(i.hitNavigateToExternalUri({destination:t}))}})},ns="https://support.spotify.com/article/spotify-connect/",as=({spec:e})=>{const t=e.containerViewFactory().externalHelpLinkFactory(),i=(0,xa.t)(t),n=(0,te.s)();return(0,h.jsx)(ts,{url:ns,linkText:D.Ru.get("web-player.connect.device-picker.help-external-link"),elementRef:i,handleClick:()=>{n.logInteraction(t.hitNavigateToExternalUri({destination:ns}))}})};var ss=i(19927);const rs=[ss.h.en,ss.h.enGB],os=()=>{const e=D.Ru.getLocaleForTranslation();return rs.includes(e)};const ls=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=(0,Za.Ek)(),n=Ka(),a=os(),s=!i&&n?e.map((e=>({...e,isDisabled:!0}))):e,{recentTransfersMap:r}=Ga(),o=function(e,t){const i=[],n=e.find((e=>e.isLocal));n&&i.push(n);const a=e.filter((e=>!e.isLocal)),{usedDevices:s,unusedDevices:r}=function(e,t){const i=[],n=[];for(const a of e)t[a.connectStateId]?i.push({device:a,timestamp:t[a.connectStateId]}):n.push(a);return{usedDevices:i,unusedDevices:n}}(a,t);s.sort(((e,t)=>t.timestamp-e.timestamp));for(const e of s)i.push(e.device);const o=i.concat(function(e){return e.sort(((e,t)=>e.isLocal?-1:t.isLocal?1:e.name.toLowerCase().localeCompare(t.name.toLowerCase())))}(r));return o}(s,r),{spec:c}=(0,Pe.r)(Xn.p,{}),u=o.filter((e=>e.isLocalNetwork)),d=o.filter((e=>!e.isLocalNetwork));return(0,h.jsxs)("div",{className:l()(Hn,Vn),children:[(0,h.jsx)("div",{children:i&&d.length>0?(0,h.jsx)($a,{localNetworkDevices:u,otherNetworksDevices:d,spec:c}):(0,h.jsx)(Wa,{devices:o,areWebPlayerCastDevicesAvailable:t,spec:c})}),(0,h.jsxs)("div",{className:l()(Yn),children:[(0,h.jsx)(as,{spec:c}),a&&(0,h.jsx)(is,{spec:c})]})]})};var cs=i(22990),us=i(15098),ds=i(11482);const ps=(0,n.forwardRef)((function({Icon:e,title:t,subtitle:i},n){return(0,h.jsx)(zi.c,{className:_a,children:(0,h.jsx)(V.v,{id:t,ref:n,"data-testid":"device-picker-row-sidepanel",media:(0,h.jsx)(e,{semanticColor:"textSubdued"}),title:(0,h.jsx)("span",{className:Pa,children:(0,h.jsx)(na.Zp,{label:t,renderInline:!0,children:(0,h.jsx)(we.d,{"data-testid":"list-row-title",lineClamp:1,semanticColor:"textBase",dir:"auto",children:t})})}),subtitle:(0,h.jsx)("div",{className:Da,children:(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:i})})})})}));var ms=i(4201);const gs="Bjx5Gw7p3JoiF4qI6eMQ",vs=()=>{const{deviceFilterState:e,isMaybeHeadphoneDevice:t}=(0,J.j)(),i=(0,ne.j)(),n=(0,Ae.v)(),a=(0,fe.A)(),s=e.currentState.externalizationEnabled||e.currentState.specificEnabled,r=a===pe.Yn.LOSSLESS||a===pe.Yn.LOSSLESS_24;return(0,h.jsxs)("div",{className:gs,children:[n&&s&&t&&(0,h.jsx)(wi.C,{size:"small",semanticColor:"textBrightAccent"}),(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBrightAccent",children:i&&r&&"Lossless"})]})},xs="G1CP8Uu3Gf2cihYJI6Da",hs="nNGIZKkKfoCorRv2f452",ys="IoeexgnqTLHXvE5pct_0",bs="XFbGPr_IwzKGEhcDpxkS",fs="KYkSwfV1FCtD15TMChbH",js="v7CrgRsPeGhw_wa_21pQ",Cs="v_d7zRnXAkuJt1lE8tzS",ws=({onClick:e})=>{const{deviceName:t,formattedDeviceName:i}=M();return(0,h.jsx)("div",{className:Cs,children:(0,h.jsx)(na.Zp,{label:i??t,children:(0,h.jsx)(ea.j,{lineClamp:1,onClick:e,children:(0,h.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:i??t})})})})};var Ss=i(27303),Ns=i(27975);const ks=({size:e="medium",className:t})=>{const i=(0,hi.j)(),n=(0,Ns.k)(e);return(0,h.jsx)(h.Fragment,{children:i?(0,h.jsx)(Ss.A,{size:e,semanticColor:"textBrightAccent",className:t,"data-testid":"now-playing-active"}):(0,h.jsx)("img",{className:t,width:n,height:n,alt:"","aria-hidden":"true",src:(0,Si.b)("images/device-picker-equaliser-animation.webp"),"data-testid":"animated-now-playing"})})};var Rs=i(58704);const Is=({deviceType:e,isGroup:t,isLocalDevice:i,isPlaying:n})=>{const a=(0,Rs.g)();let s;if(n)s=(0,h.jsx)(ks,{});else{const n=(0,ka.tf)(e,t,i?a:null);s=(0,h.jsx)(n,{semanticColor:"textBrightAccent","data-testid":"device-icon",role:"presentation"})}return(0,h.jsxs)("div",{className:bs,children:[(0,h.jsx)("div",{className:fs,children:s}),(0,h.jsx)(we.d,{variant:"titleSmall",semanticColor:"textBase",lineClamp:1,children:D.Ru.get("web-player.connect.device-picker.current-device")})]})};var Es=i(87123),Ls=i(80488),Ts=i(28833);const As=()=>{const{currentDevice:e}=(0,Ls.l)(),{id:t,connectStateId:i,isLocalNetwork:n,supportsLogout:a}=e,s=(0,Ts.W)(),r=!n&&a,o=r,{spec:l}=(0,Pe.r)(Xn.p,{}),c=(0,Ae.v)(),u=(0,ne.j)(),{deviceName:d,formattedDeviceName:p}=M(),m=s?Es.g:qi.V;return(0,h.jsx)("div",{className:js,children:c||u?(0,h.jsx)(m,{"aria-label":p??d,size:"small",autoMirror:!1}):o&&(0,h.jsx)(ja,{title:p??d,deviceId:t,connectStateDeviceId:i,allowForgetDevice:r,spec:l.containerViewFactory().headerFactory().activeDeviceFactory()})})};var Ps=i(51169),Ds=i(98255),Os=i(72744),_s=i(72575);const Us="k5CAXCZwazRLdTWi5mpN",Bs="f2Wgf5OqTaBlTRRKZe9X",Fs=()=>{const{isHidden:e,toggleIsSwitchedOn:t,setToggleState:i}=(()=>{const e=(0,La.d)(),{enqueueSnackbar:t}=(0,Os.d)(),{spec:i,logger:a}=(0,Pe.r)(ms.g,{}),[s,r]=(0,n.useState)(_s.ez.BROADCAST_STATUS_UNKNOWN),o=s===_s.ez.BROADCAST_STATUS_UNKNOWN||s===_s.ez.BROADCAST_UNAVAILABLE,l=s===_s.ez.BROADCAST_ON;(0,Ta.c)(Ea.P.BROADCAST_STATUS_UPDATE,(({data:e})=>{r(e??_s.ez.BROADCAST_STATUS_UNKNOWN)}));const c=(0,n.useCallback)((t=>e.setBroadcastStatus(t?_s.ez.BROADCAST_ON:_s.ez.BROADCAST_OFF)),[e]),u=(0,Ds.n)({mutationFn:c,onMutate:async e=>{const t=s;return r(e?_s.ez.BROADCAST_ON:_s.ez.BROADCAST_OFF),{prevBroadcastingState:t,allowBroadcasting:e}},onError:(e,i,n)=>{r(n?.prevBroadcastingState??_s.ez.BROADCAST_STATUS_UNKNOWN),t(D.Ru.get("error.generic"))}});return{isHidden:o,toggleIsSwitchedOn:l,setToggleState:(0,n.useCallback)((e=>{const t=e?"device_discoverable_off":"device_discoverable_on",n=e?"device_discoverable_on":"device_discoverable_off";a.logInteraction(i.deviceDiscoverableToggleFactory().hitToggleState({stateBeforeToggle:t,stateAfterToggle:n})),u.mutate(e)}),[a,u,i])}})();return e?null:(0,h.jsxs)("div",{className:Us,children:[(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",as:"label",htmlFor:"jam.broadcasting",className:Bs,children:D.Ru.get("web-player.social-connect.broadcasting.toggle-label")}),(0,h.jsx)(Se.l,{id:"jam.broadcasting",value:t,onSelected:i,condensed:!0})]})};var Ms=i(83211),Hs=i(24897),Vs=i(29093),qs=i(21111),zs=i(4316);const Qs="device-picker-header",Gs=({isPlaying:e})=>{const{currentDevice:t}=(0,Ls.l)(),{id:i,connectStateId:a,type:r,isLocal:o,isLocalNetwork:c,isGroup:u,incarnation:d,supportsLogout:p}=t,m=(0,Ae.v)(),g=(0,ne.j)(),{togglePuffin:v}=(0,Ps.c)(),{currentSession:x}=(0,zs.D)(),y=(0,Vs.y)(),b=(0,s.NC)(Aa.PE),f=Boolean(x?.active),j=!f&&y,C=(0,ka.HJ)(d),w=!c&&p,S=w||C,{spec:N,logger:k}=(0,Pe.r)(ms.g,{}),{uri:R}=(0,qs.f)(),I=(0,n.useCallback)((()=>{k.logInteraction(N.createJamButtonFactory().hitUiNavigate({destination:R??""}))}),[k,N,R]),E=(0,h.jsx)(ba,{deviceId:i,connectStateDeviceId:a,allowForgetDevice:w,incarnation:C?d:void 0}),L=m||g,T=(0,h.jsx)(V.v,{className:l()(hs,{[ys]:L}),id:Qs,variant:"naked",title:(0,h.jsx)(Is,{deviceType:r,isGroup:u,isLocalDevice:o,isPlaying:e}),subtitle:(0,h.jsxs)("div",{className:Cs,children:[(0,h.jsx)(ws,{onClick:L?v:void 0}),L&&(0,h.jsx)(vs,{})]}),trailing:(0,h.jsx)(As,{}),"aria-labelledby":Qs,onClick:L?v:void 0,onClickHint:D.Ru.get("web-player.connect.device-picker.current-device"),body:y&&(0,h.jsxs)(h.Fragment,{children:[b&&(0,h.jsx)(Fs,{}),(0,h.jsx)("hr",{className:xs})]}),footer:(0,h.jsxs)(h.Fragment,{children:[j&&(0,h.jsx)(Hs.$,{onClick:I}),f&&b&&(0,h.jsx)(Ms.K,{})]})});return S?(0,h.jsx)(ia.h,{menu:E,children:T}):T},Ys=({isDesktop:e})=>{const t=os(),{spec:i}=(0,Pe.r)(Xn.p,{}),n=i.containerViewFactory().noDevicesViewFactory(),a=(0,xa.t)(n);return(0,h.jsxs)("div",{ref:a,className:l()(Kn,Vn,Hn),"data-testid":Mn,children:[(0,h.jsxs)("ul",{"aria-labelledby":`${Qs} ${Fn}`,className:Zn,children:[(0,h.jsx)(ps,{Icon:cs.T,title:D.Ru.get("web-player.connect.device-picker.check-wifi"),subtitle:D.Ru.get("web-player.connect.device-picker.check-wifi-subtitle")}),(0,h.jsx)(ps,{Icon:yt.g,title:D.Ru.get("web-player.connect.device-picker.play-from-another"),subtitle:D.Ru.get("web-player.connect.device-picker.play-from-another-subtitle")}),e?(0,h.jsx)(ps,{Icon:us.H,title:D.Ru.get("web-player.connect.device-picker.restart-speaker"),subtitle:D.Ru.get("web-player.connect.device-picker.restart-speaker-subtitle")}):(0,h.jsx)(ps,{Icon:ds.i,title:D.Ru.get("web-player.connect.device-picker.switch-to-app"),subtitle:D.Ru.get("web-player.connect.device-picker.switch-to-app-subtitle")})]}),(0,h.jsxs)("div",{"aria-describedby":Mn,children:[(0,h.jsx)(as,{spec:i}),t&&(0,h.jsx)(is,{spec:i})]})]})},Ks=({devices:e,areWebPlayerCastDevicesAvailable:t})=>{const i=Boolean(e.find((e=>!e.isLocal))),n=e.filter((e=>!e.isActive&&e.name.length>0)),a=i||t,s=(0,Za.Ek)();return(0,h.jsxs)("div",{className:l()(qn,Vn),children:[(0,h.jsx)(Wn,{foundDevices:a}),a?(0,h.jsx)(wa,{children:(0,h.jsx)(ls,{devices:n,areWebPlayerCastDevicesAvailable:t})}):(0,h.jsx)(Ys,{isDesktop:s})]})};var Zs=i(25112),Ws=i(41089),Xs=i(63912);const Js="hmVfxvHNFzG0vUNl80tU",$s=()=>{const[e,t]=(0,n.useState)(!0),{deviceFilterState:i,isMaybeHeadphoneDevice:a}=(0,J.j)(),s=i.isOnboarded,{incrementDismissCountForDevice:r,isDeviceDismissed:o}=(0,Xs.o)(),l=(0,n.useMemo)((()=>a&&!s&&!o),[o,a,s]),c=(0,j._Y)(),u=(0,n.useCallback)((()=>c(W.$S.PUFFIN_START_ACTIVATION)),[c]),d=(0,n.useCallback)((()=>{r(),t(!1)}),[r]);return l&&e?(0,h.jsx)(V.v,{id:"puffinDevicePickerUpsell",variant:"tinted",size:"lg",className:Js,title:D.Ru.get("web-player.puffin.get-started.title"),subtitle:D.Ru.get("web-player.puffin.get-started.subtitle"),paddingBlockStart:"16px",paddingBlockEnd:"16px",footer:(0,h.jsx)(se.n,{size:"small",onClick:u,children:D.Ru.get("web-player.puffin.upsell.enhance-headphones.confirm")}),trailing:(0,h.jsx)(re.H,{semanticColor:"textSubdued",iconOnly:Ws.M,size:"small",onClick:d,condensedAll:!0,"aria-label":D.Ru.get("close")})}):null};var er=i(77850),tr=i(44509),ir=i(67526);const nr="h0XG5HZ9x0lYV7JNwhoA",ar=()=>{const e=(0,ma.e)(),t=(0,tr.O)(),i=(0,Ae.v)(),a=(0,Zs.C)(),{devices:r}=(0,Ls.l)(),{isPlaying:o}=(0,ir.GK)(),[l]=(0,j.sV)(),c=(0,n.useRef)(a),u=(0,n.useRef)(l.context.devicePicker?.interactionId);c.current=a,u.current=l.context.devicePicker?.interactionId;const d=(0,P.d4)((e=>e.playback?.castState??window.cast?.framework.CastState.NO_DEVICES_AVAILABLE)),g=(0,er.Or)(d);(0,n.useEffect)((()=>()=>{c.current(u.current)}),[u]);const v=(0,s.NC)(pa.q5y);return(0,n.useEffect)((()=>{v?t.startActiveDiscovery():e.getCapabilities().supportsLocalDiscovery&&e.updateListOfDevices()}),[e,t,v]),(0,h.jsx)(Ue._,{label:D.Ru.get("playback-control.connect-picker"),focusTransferId:"DEVICE-PICKER",children:(0,h.jsxs)(Be.w,{className:nr,fixedHeader:(0,h.jsx)(p.a,{title:D.Ru.get("playback-control.connect-picker"),panel:m.Z.DevicePicker}),children:[(0,h.jsx)(Gs,{isPlaying:o}),i&&(0,h.jsx)($s,{}),(0,h.jsx)(Ks,{devices:r,areWebPlayerCastDevicesAvailable:g})]})})};var sr=i(3611),rr=i(2430),or=i(27644),lr=i(52795),cr=i(1044),ur=i(49740),dr=i(89538),pr=i(66216),mr=i(36682);const gr=()=>(0,h.jsx)(h.Fragment,{}),vr=()=>(0,h.jsx)(h.Fragment,{});var xr=i(37435),hr=i(25203),yr=i(97589);const br="Xh1TBgSrJAYVdjRM8zFV",fr="XtrKVBpPjO52Dsuh7Sl3",jr="Ebrqn7sM1CfWaEig2gQW",Cr="cA09n1bnWHC5ii99Gjpq",wr=()=>(0,h.jsx)("div",{className:(0,yr.Ju)("invertedDark",Cr),children:(0,h.jsx)(c.E,{variant:"bodySmall",children:D.Ru.get("web-player.now-playing-view.chapters.disclaimer")})});var Sr=i(8097),Nr=i(49502);const kr=({title:e,isActive:t,isPlaying:i,timestamp:a,onClick:s})=>{const r=(0,n.useCallback)((()=>{s(a)}),[s,a]);return(0,h.jsx)(V.v,{variant:"naked",id:e,hoverBackgroundColor:"backgroundTintedHighlight",activeBackgroundColor:"backgroundTintedBase",title:(0,h.jsxs)(c.E,{variant:"bodyMedium",semanticColor:t?"textBrightAccent":"textBase",className:"standalone-ellipsis-one-line",children:[i&&t&&(0,h.jsx)(Sr.J,{animated:t})," ",e]}),subtitle:(0,Nr.f)(a),onClick:r})};var Rr=i(1429),Ir=i(60001);function Er(e,t){if(!e)return null;const i=(0,Ir.s)(e);return null===i?null:t.findIndex((e=>(e.seekStart?.milliseconds??0)<=i&&(e.seekStop?.milliseconds??1/0)>=i))}var Lr=i(49097),Tr=i(86565),Ar=i(50684);const Pr=new Tr.l("queryNpvEpisodeChapters","query","367f0e93a0d219ae6f5874bcc460201db0a43467ae94f16298931a704ac62ea6",null),Dr=12e5,Or=6e5;var _r=i(48125),Ur=i(4490);var Br=i(21765),Fr=i(7038);const Mr=(0,n.memo)((({chapters:e,episodeUri:t,nextOffset:i,limit:a,isPlaying:s,isMLGeneratedChapters:r})=>{const o=(0,C.z)(),{logger:l,spec:c}=(0,Pe.r)(hr.U,{}),{chapters:u,fetchNextPage:d}=(({uri:e,startOffset:t=0,pageSize:i,autoFetchOnMount:a=!0})=>{const{request:s}=(0,n.useContext)(_r.j),{data:r,isLoading:o,error:l,fetchNextPage:c}=(0,Lr.q)({queryKey:["npv","episode-chapters",e,{startOffset:t,limit:i}],queryFn:({pageParam:t})=>(0,Ur.c)(s,Pr,function(e,t,i){return{offset:t,limit:i,uri:e}}(e,t,i)),staleTime:Or,gcTime:Dr,enabled:a,initialPageParam:t,getNextPageParam:e=>{if("Episode"!==e?.data?.episodeUnionV2.__typename)return;const t=e.data.episodeUnionV2.displaySegments;return t?.displaySegments.pagingInfo.nextOffset&&t.displaySegments.pagingInfo.nextOffset>0?t.displaySegments.pagingInfo.nextOffset:void 0}}),u=(0,n.useCallback)((async()=>{await c()}),[c]);return{chapters:(0,n.useMemo)((()=>r?.pages.flatMap((e=>"Episode"===e?.data?.episodeUnionV2.__typename&&e.data.episodeUnionV2.displaySegments?.displaySegments.items?e.data.episodeUnionV2.displaySegments.displaySegments.items:[]))??[]),[r?.pages]),error:l,loading:o,fetchNextPage:u}})({uri:t,pageSize:a??10,startOffset:i??e.length,autoFetchOnMount:!1}),p=(0,n.useMemo)((()=>(u.length>0?[...e,...u]:e).filter(Hr)),[e,u]),m=(e=>{const t=(0,C.z)(),[i,a]=(0,n.useState)((()=>Er(t.getState(),e)));return(0,Rr.$)((()=>{const n=Er(t.getState(),e);n!==i&&a(n)}),500),i})(p),g=(0,n.useCallback)((e=>{o.seekTo(e),l.logInteraction(c.chapterRowFactory().hitSeekToTime({msToSeekTo:e})),o.getState()?.isPaused&&(o.resume(),l.logInteraction(c.chapterRowFactory().hitResume({itemToBeResumed:t})))}),[t,l,o,c]);return p.length?(0,h.jsxs)(Br.w,{className:br,children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.now-playing-view.chapters")}),r&&(0,h.jsx)(wr,{}),(0,h.jsx)(Fr._,{onReachBottom:d,triggerOnInitialLoad:!1,className:fr,children:(0,h.jsx)(Vi.$,{"aria-label":D.Ru.get("web-player.now-playing-view.chapters"),className:jr,children:p.map(((e,t)=>{if(!e.title||"number"!=typeof e.seekStart?.milliseconds)return null;const i=t===m;return(0,h.jsx)(zi.c,{children:(0,h.jsx)(kr,{onClick:g,timestamp:e.seekStart.milliseconds,title:e.title,isActive:i,isPlaying:s})},e.seekStart.milliseconds)}))})})]}):null}));function Hr(e){return"TalkDisplaySegment"===e.__typename}const Vr=e=>"Episode"===e?.__typename,qr=e=>"__typename"in e&&"Podcast"===e.__typename,zr=e=>!!e&&"__typename"in e&&"Episode"===e.__typename;var Qr=i(42613),Gr=i(62092),Yr=i(48732),Kr=i(1978),Zr=i(58131),Wr=i(36711),Xr=i(42163),Jr=i(92057),$r=i(71502),eo=i(41861),to=i(2535),io=i(91616),no=i(24902),ao=i(30057);const so="YdLiRQVNwEQzUNR44QuY",ro="VVxt7MTKoKdOCVIWYfHn",oo="c21KEAgelRvfiGswmHy9",lo=({images:e,contentRating:t,contextTitle:i,contextUri:a,menu:s,position:r=0,title:o,type:l,uri:u,usePlayContextItem:d})=>{const p=(0,Kr.Zp)(),{draggable:m,onDragStart:g}=(0,Jr.P)(),v=(0,Cn.o_h)(u)?.toURLPath(!0),x=a&&(0,Cn.o_h)(a)?.toURLPath(!0),y=(0,xi.y)(),{badges:b}=(0,ao.b)({contentRating:t}),{isPlaying:f,togglePlay:j}=d({uri:u}),{spec:C,logger:w}=(0,Pe.r)(Wr.G,{data:{uri:u,position:r}}),S=(0,n.useCallback)((e=>{if(e.stopPropagation(),e.preventDefault(),v){const e=C.hitUiNavigate({destination:v});w.logInteraction(e),p(v)}}),[w,p,C,v]),N=(0,n.useCallback)((e=>{if(e.stopPropagation(),e.preventDefault(),v){const e=C.trackContainerFactory().trackInformationFactory().nameLinkFactory().hitUiNavigate({destination:v});w.logInteraction(e),p(v)}}),[w,p,C,v]),k=(0,n.useCallback)((e=>{if(e.stopPropagation(),e.preventDefault(),x){const e=C.trackContainerFactory().trackInformationFactory().contextLinkFactory({uri:a}).hitUiNavigate({destination:x});w.logInteraction(e),p(x)}}),[a,x,w,p,C]),R=(0,n.useCallback)((e=>{e.stopPropagation();const t=C.trackContainerFactory().coverArtFactory().hitPlay({itemToBePlayed:u});w.logInteraction(t),j()}),[w,C,j,u]),I=(0,n.useMemo)((()=>(0,h.jsx)(na.Zp,{label:o,children:(0,h.jsx)(we.d,{lineClamp:y===di.E.MEDIUM?1:2,children:v?(0,h.jsx)(Me.N,{to:v,onClick:N,children:o}):o})})),[y,N,o,v]),E=(0,n.useMemo)((()=>(0,h.jsxs)(ea.j,{lineClamp:1,children:[b.explicit&&(0,h.jsx)($r.U,{}),b.nineteen&&(0,h.jsx)(io.q,{}),l,x&&i&&(0,h.jsxs)(h.Fragment,{children:[" • ",(0,h.jsx)(na.Zp,{label:i,children:(0,h.jsx)(Me.N,{to:x,onClick:k,children:(0,h.jsx)(c.E,{semanticColor:"textSubdued",children:i})})})]})]})),[b.explicit,b.nineteen,i,x,k,l]);return(0,h.jsx)(ia.h,{menu:s,children:(0,h.jsx)(V.v,{activeBackgroundColor:"backgroundTintedPress",className:oo,draggable:m,hoverBackgroundColor:"backgroundTintedHighlight",id:u,layout:"regular",onClick:S,onDragStart:e=>{if(e.target!==e.currentTarget)return;g(e,{itemUris:[u],dragLabelText:`${o}${i?` • ${i}`:""}`,contextUri:a})},variant:"naked",title:I,subtitle:y===di.E.MEDIUM&&E,body:y!==di.E.MEDIUM&&E,paddingInlineStart:Zr.v4,paddingInlineEnd:Zr.v4,media:(0,h.jsxs)("div",{className:so,children:[(0,h.jsx)(Xr.x,{className:ro,isPlaying:f,isLocked:!1,onClick:R,playAriaLabel:D.Ru.get("tracklist.a11y.play",o,i)}),(0,h.jsx)(eo.b,{type:no.c.EPISODE,title:o,shape:eo.u.ROUNDED_CORNERS,size:to.Qe.SIZE_48,images:e})]})})})};var co=i(88417);const uo=({episode:e,position:t})=>{const i=e.podcastV2.data,n=qr(i)?i.uri:void 0,a=qr(i)?i.name:void 0,{usePlayContextItem:s}=(0,co.P)({uri:n??e.uri},{featureIdentifier:"episode_ai_dubbing"});return(0,h.jsx)(lo,{contentRating:e.contentRating?.label,contextTitle:a,contextUri:n,images:e.coverArt?.sources,menu:(0,h.jsx)(Yr.b,{uri:e.uri}),position:t,title:e.name,type:D.Ru.get("card.tag.episode"),uri:e.uri,usePlayContextItem:s},e.uri)},po=e=>(0,h.jsx)(c.E,{...e,as:"div",variant:"bodySmall"});var mo=i(38061);const go="KJEbbXyTy0gbIalPPwjP",vo=e=>(0,h.jsx)(mo.B,{className:go,...e}),xo="dmEFRgvLS6M2o8rmoX6v",ho=({description:e,episodes:t,title:i,...n})=>(0,h.jsxs)(Br.w,{...n,className:xo,children:[(0,h.jsx)(Br.X,{icon:(0,h.jsx)(Gr.H,{size:"small"}),tooltipLabel:i,children:i}),(0,h.jsx)(po,{children:e}),(0,h.jsx)(vo,{children:t.map(((e,t)=>(0,h.jsx)(uo,{episode:e,position:t},e.uri)))})]});var yo=i(43452);function bo({episode:e}){const t=(e=>e.aiDubbedEpisodes?.items?e.aiDubbedEpisodes.items.map((e=>e.data)).filter((t=>zr(t)&&t.uri!==e.uri)):[])(e),{spec:i}=(0,Pe.r)(Qr.y,{});if(t.length<=0)return null;const n=(0,D.wB)(t[0]?.language?.code),a=t.length>1&&D.Ru.get("web-player.now-playing-view.dubbed-episodes.title-multiple")||n&&D.Ru.get("web-player.now-playing-view.dubbed-episodes.title-single-with-language",{language:(0,yo.kX)(n)})||D.Ru.get("web-player.now-playing-view.dubbed-episodes.title-single"),s=t.length>1?D.Ru.get("web-player.now-playing-view.dubbed-episodes.description-multiple"):D.Ru.get("web-player.now-playing-view.dubbed-episodes.description-single");return(0,h.jsx)(fa.r,{spec:i.episodeListFactory(),children:(0,h.jsx)(ho,{description:s,episodes:t,title:a})})}var fo=i(28635);function jo({episode:e}){const t=(e=>Vr(e)&&e.originalEpisode&&zr(e.originalEpisode?.data)?e.originalEpisode.data:void 0)(e),{spec:i}=(0,Pe.r)(fo.I,{});if(!t)return null;const n=(0,D.wB)(t.language?.code),a=n?D.Ru.get("web-player.now-playing-view.original-episode.title-with-language",{language:(0,yo.kX)(n)}):D.Ru.get("web-player.now-playing-view.original-episode.title"),s=n?D.Ru.get("web-player.now-playing-view.original-episode.description-with-language",{language:(0,yo.kX)(n)}):D.Ru.get("web-player.now-playing-view.original-episode.description");return(0,h.jsx)(fa.r,{spec:i,children:(0,h.jsx)(ho,{description:s,episodes:[t],title:a})})}var Co=i(26928),wo=i(9885);const So="YC6K2bFUeJkdE4cCvbD3",No="vHQbygDcvOQ4Ls0W6vb1",ko="Ku9l84_lLCFE3crS1Y8B",Ro="TortsxZeDfI28luc5Dac",Io="XHpZHlxCiVHe8qTVVskT",Eo="lu9_R5Kw07YEWlq8eKs9",Lo="RypbYIkqqlUkhxg_RwYm",To=(0,n.memo)((function({transcriptSections:e,onTimeStampClick:t,episodeUri:i}){const{spec:n,logger:a}=(0,Pe.r)(Co.c,{data:{uri:i}}),{isPlaying:s}=(0,co.P)({uri:i},{featureIdentifier:"episode"}),r=n.timestampLinkFactory();return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:No,children:[(0,h.jsx)("div",{className:Ro,children:(0,h.jsx)(c.E,{as:"p",variant:"marginal",semanticColor:"textSubdued",children:D.Ru.get("web-player.episode.transcript.disclaimer")})}),e.map(((e,n)=>{const o=`transcript-section-${n}`;return(0,h.jsxs)("div",{className:ko,children:[(0,h.jsx)("button",{className:Io,onClick:()=>{t(e.startMs,o),a.logInteraction(s?r.hitSeekToTime({msToSeekTo:e.startMs}):r.hitPlay({itemToBePlayed:i}))},children:(0,h.jsx)(wo.k,{id:o,targetURI:(0,Cn.o_h)(i),fadeOut:!0,children:(0,h.jsx)(c.E,{variant:"marginalBold",semanticColor:"textSubdued",className:Eo,children:(0,Nr.f)(e.startMs)})})}),e.content.map(((e,t)=>(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textBase",className:Lo,dir:"auto",children:e},`transcript-text-${t}`)))]},o)}))]})})}));var Ao=i(1467);const Po=new Tr.l("queryNpvEpisode","query","dc8916afee630965eed229a8b43693de0adbacc1f606a47e110a6dda0274bf29",null),Do=new Tr.l("queryNpvEpisodeWithGatedEntityRelations","query","dc8916afee630965eed229a8b43693de0adbacc1f606a47e110a6dda0274bf29",null),Oo=new Tr.l("queryEpisodeShowAccessInfo","query","dc8916afee630965eed229a8b43693de0adbacc1f606a47e110a6dda0274bf29",null),_o=e=>"accessInfo"in e.podcastV2.data&&("Podcast"===e.podcastV2.data.__typename&&(!!e.podcastV2.data?.accessInfo&&e.podcastV2.data.accessInfo)),Uo="Ki3a1Wxv0XrjWwuoFy1w",Bo="Zk6EWCEL86hT3S6Xy6mA",Fo="cReiUDEvwfvjdiCCF8g9",Mo=({episode:e})=>{const t="gatedEntityRelations"in e?e.gatedEntityRelations.at(0)?.relatedEntityUri:null,i=Boolean(t)&&t!==e.uri,{data:n}=(a={uri:t??""},s={enabled:i},(0,Ar.I)(Oo,a,s));var a,s;const r=(e=>"Podcast"===e.podcastV2.data.__typename&&e.podcastV2.data)(e);let o=null;if(i&&"Episode"===n?.episodeUnionV2.__typename?o=_o(n.episodeUnionV2):i||(o=_o(e)),!t||!r||!o||o.isUserMemberOfAtLeastOneGroup||"UpsellAccessExplanation"!==o.accessExplanation?.__typename)return null;const l=o.accessExplanation;return(0,h.jsxs)(Br.w,{className:Uo,children:[(0,h.jsx)(ia.h,{menu:(0,h.jsx)(Ao.H,{uri:r.uri}),children:(0,h.jsx)(Me.N,{to:r.uri,children:(0,h.jsx)(eo.b,{type:no.c.SHOW,title:r.name,images:r.coverArt?.sources,size:to.Qe.SIZE_48})})}),(0,h.jsx)(c.E,{variant:"bodySmall",className:Bo,children:l.body}),(0,h.jsx)(re.H,{size:"small",className:Fo,condensed:!0,semanticColor:"textBrightAccent",iconTrailing:es.H,href:l.url?l.url:void 0,children:l.actionText})]})};var Ho=i(25206),Vo=i(68560),qo=i(46199),zo=i(45006),Qo=i(68200);var Go=i(89494),Yo=i(17488),Ko=i(53442);const Zo="_QEMUk5U16U3CQn0wvbD",Wo="mbkl2P60JUhDqc9qGvp9",Xo="Xh6dG3pzi2SS7v4cvZzG",Jo="sOdoW26RUwggLToa7xDt",$o="B_TcBcc1BM2yLgvXbh66",el="tRnhyUQiKOxA3z8mUD_U",tl="_shxqlkLuB52H1iCh_OQ",il="hAwePVlxumRNpdOSpwyV";const nl=n.forwardRef((function({className:e="",segment:t,onClickPlay:i,isPlaying:a},s){const{label:r,Icon:o}=(0,n.useMemo)((()=>function(e){if("TALK"===e.type)return{Icon:Ho.L,label:D.Ru.get("playlist.a11y.play",e.title)};const t=e.track.artists?.map((e=>e.name)).join(D.Ru.getSeparator())||"";return{Icon:Vo.v,label:D.Ru.get("tracklist.a11y.play",e.track.name,t)}}(t)),[t]),c=(0,n.useCallback)((()=>{i()}),[i]);return(0,h.jsxs)("div",{className:l()(tl,e),children:[a?(0,h.jsx)(Sr.J,{className:el,animated:!0}):(0,h.jsx)("span",{className:el,children:(0,h.jsx)(o,{iconSize:16,"aria-hidden":"true"})}),(0,h.jsx)(Xr.x,{className:$o,iconClassName:il,onClick:c,isPlaying:a,isLocked:!1,playAriaLabel:r,ref:s})]})})),al=({children:e,onTriggerPlay:t,episodeUri:i,index:n})=>{const{spec:a,logger:s}=(0,Pe.r)(qo.f,{}),r=(0,Go.W)(),o=(0,Jn.YQ)((()=>{r({intent:"play",type:"double-click"});const e=s.logInteraction(a.segmentItemFactory({uri:i,position:n||0}).doubleHitPlay({itemToBePlayed:i}));t(e)}),Ko.d,{leading:!0,trailing:!1});return(0,h.jsx)("div",{className:Jo,onDoubleClick:o,children:e})},sl=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,Pe.r)(qo.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Yo.L)({episodeUri:t,start:e.start,stop:e.stop}),c={uri:t},u=function(e){const t=[{url:e.track.album.image}];return{type:no.c.TRACK,uri:e.uri,uid:null,provider:null,images:t,name:e.track.name,mediaType:"audio",duration:{milliseconds:0},album:{type:no.c.ALBUM,uri:e.track.album.uri,name:e.track.album.name,images:t},artists:e.track.artists.map((e=>({type:no.c.ARTIST,name:e.name,uri:e.uri})))}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{l({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,l,d]);return(0,h.jsxs)(al,{onTriggerPlay:l,episodeUri:t,children:[(0,h.jsx)(nl,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{p()}}),(0,h.jsx)(Qo.d,{context:c,item:u,titleTypeVariant:"bodyMedium",subtitleTypeVariant:"bodySmall",onTitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).albumLinkFactory({uri:c.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{s.logInteraction(a.segmentItemFactory({uri:t,position:i||0}).artistLinkFactory({uri:e||"",position:0}).hitUiNavigate({destination:e||""}))}})]})},rl=({segment:e,episodeUri:t,index:i})=>{const{spec:a,logger:s}=(0,Pe.r)(qo.f,{}),{isActive:r,isPlaying:o,onClick:l}=(0,Yo.L)({episodeUri:t,start:e.start,stop:e.stop}),u=function(e){const t=[];return{type:no.c.UNKNOWN,uri:e.uri,uid:null,provider:null,images:t,name:e.title,mediaType:"audio",duration:{milliseconds:0},album:{type:no.c.ALBUM,uri:e.show.uri,name:e.show.name,images:t},artists:[]}}(e),d=a.segmentItemFactory({uri:t,position:i||0}).playbackButtonFactory(),p=(0,n.useCallback)((()=>{l({}),r&&o?s.logInteraction(d.hitPause({itemToBePaused:t})):r&&!o?s.logInteraction(d.hitResume({itemToBeResumed:t})):s.logInteraction(d.hitPlay({itemToBePlayed:t}))}),[t,r,o,s,l,d]);return(0,h.jsxs)(al,{onTriggerPlay:l,episodeUri:t,children:[(0,h.jsx)(nl,{segment:e,isActive:r,isPlaying:o,onClickPlay:()=>{p()}}),(0,h.jsx)(zo.r,{children:(0,h.jsx)(c.E,{variant:"bodyMedium",semanticColor:"textBase",children:u.name})},u.name)]})};var ol=i(70451);function ll(e){return!!(0,ol.o)().getCapabilities().isSupported&&function(e){const t=e.metadata?.["parent_episode.uri"];return!!t&&(0,Cn.gHQ)(t)}(e)}const cl=(0,sr.mc)((({item:e})=>{const t=e.metadata?.["parent_episode.uri"],i=function(e){const t=(0,ol.o)();return(0,n.useCallback)((async(i,n)=>{if(!e)return[];try{return await t.getSegments(e,i,n)}catch(e){return[]}}),[e,t])}(t),[a,s]=(0,n.useState)([]),r=(0,n.useRef)(!1),o=(0,n.useRef)(0),l=(0,n.useCallback)((()=>{const e=o.current;null!==e&&(r.current||(r.current=!0,i(e,10).then((e=>{s((t=>{const i=t.concat(e);return o.current=i.length+1,i})),r.current=!1}))))}),[i]);return(0,n.useEffect)((()=>{s([])}),[e.uri]),t?(0,h.jsxs)(Br.w,{className:Zo,children:[(0,h.jsx)(Br.X,{className:Wo,children:D.Ru.get("music_and_talk.in_this_episode")}),(0,h.jsx)("div",{className:Xo,children:(0,h.jsx)(Fr._,{onReachBottom:l,triggerOnInitialLoad:!0,children:a.map(((e,i)=>"MUSIC"===e.type?(0,h.jsx)(sl,{segment:e,episodeUri:t},`${e.uri}-${i}`):(0,h.jsx)(rl,{segment:e,episodeUri:t},`${e.uri}-${i}`)))})})]}):null}),{name:"NPVInThisEpisode"});var ul=i(20422),dl=i(14761),pl=i(57615);const ml=({children:e,...t})=>(0,h.jsx)(gl,{size:"small",...t,$_css:pl.ZSH,children:e});var gl=(0,dl.Ay)(se.n).withConfig({displayName:"ButtonSecondary___StyledEncoreButtonSecondary",componentId:"sc-13xoveo-0"})((e=>({borderColor:e.$_css})));function vl(e,t){return e.uid??`${e.uri}:${t}`}var xl=i(50507),hl=i(13563),yl=i(32350),bl=i(13202),fl=i(4723),jl=i(2995),Cl=i(55530);const wl="VXFYm2GnsH4zc3EPikNi",Sl="yvjS3DPkDIHgMUZxL972",Nl="Os6nTuXambdCB8H81QRT",kl="RDIVOZoeGMohQ8MeJjUH",Rl="Cj0QJuDauCo39643t0Q8",Il="evQ_5Znk6OXYHBzLCSoN",El="nCwi6jOC9FEKO5tKAQKW",Ll="DP0qcvnv6ToERKYhb9Xk",Tl="m1ZL7TCf7Ge2VxQjgGgv",Al="yIYdkVZJzDlj1lqOmV1M",Pl="kh6wYYPvgRPBhA2wj3AS",Dl="qp7Sys7hJSZHLzw4K_yF",Ol="fIabFr0bD1PUqwipmTjQ",_l=({title:e,type:t,images:i,onTogglePlay:n,isPlaying:a,ariaPauseLabel:s,ariaPlayLabel:r,isPlayable:o})=>{const c=(0,Qt._)(),u=t===no.c.ARTIST||t===no.c.USER?eo.u.CIRCLE:eo.u.ROUNDED_CORNERS;return(0,h.jsxs)("div",{className:Pl,children:[(0,h.jsx)(eo.b,{fadeIn:!0,images:c(i??[],48),shape:u,size:to.Qe.SIZE_48,iconSize:"medium",type:t,title:e,loadingMode:"eager"}),!o&&(0,h.jsx)("span",{className:l()(Dl,Rl),children:(0,h.jsx)(Cl.R,{onClick:n,version:Cl.H.transparent,isPlaying:a,ariaPauseLabel:s,ariaPlayLabel:r,condensedAll:!0})})]})},Ul=({title:e,isActive:t})=>(0,h.jsx)(na.Zp,{showDelay:na.uF,label:e,children:(0,h.jsx)(we.d,{lineClamp:1,semanticColor:t?"textBrightAccent":"textBase",dir:"auto",children:e})}),Bl=({menu:e,labelName:t})=>(0,h.jsx)(sa.b,{menu:e,children:(0,h.jsx)(aa.e,{className:Rl,label:D.Ru.get("more.label.context",t),size:"small"})});var Fl=i(57682),Ml=i(29760),Hl=i(74971);const Vl=({queuedBy:e})=>{if(!e)return null;const t=(0,Hl.g)(e.images,{desiredSize:24});return(0,h.jsx)(na.Zp,{label:D.Ru.get("queue.queued-by",e.name),children:(0,h.jsx)("div",{children:(0,h.jsx)(ia.h,{menu:(0,h.jsx)(Ml.B,{uri:e.uri}),children:(0,h.jsx)(Me.N,{to:e.uri,children:(0,h.jsx)(Fl.e,{images:t?[t]:[],userIconSize:"small",width:24,displayName:e.name,username:e.username,label:""})})})})})},ql=({queuedBy:e,menu:t,moreButtonLabelName:i})=>(0,h.jsxs)("div",{className:kl,children:[t&&i&&(0,h.jsx)(Bl,{menu:t,labelName:i}),(0,h.jsx)(Vl,{queuedBy:e})]});var zl=i(47755),Ql=i(3094);const Gl="spotify:app:queue";var Yl=i(25336);const Kl=()=>(0,h.jsx)("div",{className:wl}),Zl=({id:e,uid:t,uri:i,contextUri:a,index:s,dragLabel:r,type:o,title:c,subtitle:u,images:d,onDrop:p,allowedDropMimeTypes:m,menu:g,moreButtonLabelName:v,usePlayContextItem:x,section:y,queuedBy:b,ariaPauseLabel:f,ariaPlayLabel:j,onContextMenu:C,isPlayable:w,isAnyArtistBanned:S,handleArtistBanUndoClick:N,isNpv:k})=>{const{className:R,dropPosition:I,draggable:E,...L}=function({uid:e,uri:t,index:i,dragLabel:a,allowedMimeTypes:s=[],onDrop:r,sectionId:o}){const{draggable:l,onDragStart:c}=(0,Ql.R)({index:i,contextUri:Gl,sectionId:o,label:a??"",isEnabled:!!a}),u=(0,zl.A)({id:e??void 0,uri:t,allowedMimeTypesByDropPosition:{[yl.Nz.BEFORE]:s,[yl.Nz.AFTER]:s},onDrop:r});return(0,n.useMemo)((()=>({...u,draggable:l,onDragStart:c})),[l,u,c])}({uid:t,uri:i,index:s,dragLabel:r,onDrop:p,allowedMimeTypes:m,sectionId:y}),{isSelected:T}=(0,n.useContext)(fl.m),{onClick:A,onContextMenu:P,onKeyDown:D}=(0,bl.q)({index:s,contextUri:a,onContextMenu:C,canRemovePlaylistItems:!1,removePlaylistItems:void 0,isTreeGrid:!0}),O=(0,te.s)(),{spec:_}=(0,Pe.r)(xl.i,{data:{position:s,reason:"",uri:i}}),{isActive:U,isPlaying:B,togglePlay:F,triggerPlay:M}=x({uri:i,uid:t??void 0}),H=(0,n.useCallback)((()=>{const e=(0,Yl.$I)({spec:_.playbackButtonFactory(),logger:O,uri:i,isActive:U,isPlaying:B});F({loggingParams:e})}),[U,B,O,_,F,i]),q=(0,jl.W)(N),z=(0,n.useCallback)((()=>{if(S)return void q();const e=O.logInteraction(_.doubleHitPlay({itemToBePlayed:i}));M({loggingParams:e})}),[q,S,O,_,M,i]),Q=(0,n.useCallback)((e=>{if("Enter"===e.key&&e.target instanceof Element&&e.currentTarget.querySelector(':scope > [role="button"]')===e.target){const e=O.logInteraction(_.playbackButtonFactory().hitPlay({itemToBePlayed:i}));M({loggingParams:e})}D(e)}),[O,D,_,M,i]),G=(0,n.useCallback)((e=>{const t=e.currentTarget.querySelector('[role="button"]');t instanceof HTMLElement&&t.focus(),A(e)}),[A]),Y=(0,h.jsx)(_l,{type:o,onTogglePlay:H,isPlaying:B,title:c,images:d,ariaPauseLabel:f,ariaPlayLabel:j,isPlayable:w}),K=(0,h.jsx)(ql,{queuedBy:b,menu:g,moreButtonLabelName:v}),Z=T(s),W=Z&&T(s-1),X=Z&&T(s+1),J=(0,h.jsx)(V.v,{id:e,media:Y,title:(0,h.jsx)(Ul,{isActive:U,title:c}),subtitle:u,className:l()(Nl,R,{[Il]:W,[El]:X,[Tl]:k}),variant:T(s)?"tinted":void 0,hoverBackgroundColor:k?"backgroundTintedHighlight":"backgroundHighlight",trailing:K,onDoubleClick:z,hoverAnimationDuration:"0ms",padding:de.v4,onClick:()=>{},onContextMenu:P,"aria-disabled":w,tabIndex:0}),$=(0,h.jsx)(hl.W,{className:l()(R),draggable:E&&!!r,"aria-posinset":s,onKeyDown:Q,...L,onClick:G,children:J});return(0,h.jsxs)(h.Fragment,{children:[I===yl.Nz.BEFORE&&(0,h.jsx)(Kl,{}),$,I===yl.Nz.AFTER&&(0,h.jsx)(Kl,{})]})},Wl=e=>{const t=(0,h.jsx)(Zl,{...e});return e.menu?(0,h.jsx)(ia.h,{menu:e.menu,children:t}):t},Xl=({ad:e,index:t,...i})=>{const{uid:n,uri:a,type:s,title:r,advertiser:o,images:l}=e,c=vl(e,t),u=o??r??D.Ru.get("ad-formats.advertisement");return(0,h.jsx)(Wl,{uid:n,uri:a,id:c,index:t,type:s,title:u,images:l,subtitle:null,...i})},Jl=({type:e})=>{const t=function(e){switch(e){case no.c.TRACK:return D.Ru.get("web-player.queue-history.item-type.track");case no.c.EPISODE:return D.Ru.get("web-player.queue-history.item-type.episode");case no.c.CHAPTER:return D.Ru.get("web-player.queue-history.item-type.chapter");case no.c.AD:case no.c.UNKNOWN:return null;default:return(0,mn.k)(e),null}}(e);return t&&(0,h.jsx)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",children:t})};var $l=i(24006),ec=i(13117),tc=i(58778),ic=i(57782),nc=i(22727),ac=i(56106),sc=i(45080),rc=i(61804),oc=i(4114);const lc="iFEXaIHbvw1bGP0fFu9g",cc=({item:e,subtitle:t,tooltipText:i,showTypeLabel:a})=>{const s=(e=>{const t=(0,nc.T)(e.uri),i=(0,oc.v)(e)||(0,rc.p)(e)||(0,sc.d)(e),a=n.Children.toArray([(0,tc.N)(e)&&(0,h.jsx)($l.R,{title:D.Ru.get("web-player.smart-shuffle.icon-hover-label"),"aria-label":D.Ru.get("web-player.smart-shuffle.icon-hover-label"),semanticColor:"textBrightAccent",size:"small"}),t===ac.kw.YES&&(0,h.jsx)(ic._,{}),i&&e.isExplicit&&!e.is19PlusOnly&&(0,h.jsx)($r.U,{}),i&&e.is19PlusOnly&&(0,h.jsx)(io.q,{size:16}),(0,oc.v)(e)&&(e.hasAssociatedVideo||"video"===e.mediaType)&&(0,h.jsx)(ec.l,{})]);return a.length?(0,h.jsx)("span",{className:lc,children:a}):null})(e);return(0,h.jsx)(ea.j,{dir:"auto",children:(0,h.jsxs)(c.E,{semanticColor:"textSubdued",variant:"bodySmall",className:Ll,children:[s?(0,h.jsx)("span",{className:Ol,children:s}):null,(0,h.jsx)(na.Zp,{label:i,showDelay:na.uF,children:(0,h.jsxs)("span",{className:Al,children:[a&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Jl,{type:e.type})," •"," "]}),t]})})]})})};var uc=i(39900);function dc(e){let{uri:t}=(0,qs.f)();return e===uc.$.NextInQueue?t="spotify:app:queue:NextInQueue":e===uc.$.NextUp&&(t="spotify:app:queue:NextUp"),t??""}const pc=({episode:e,index:t,showTypeLabel:i,...n})=>{const{uid:a,uri:s,type:r,name:o,images:l,show:c}=e,u=vl(e,t),d=dc(n.section),p=(0,h.jsx)(Yr.b,{uri:s,uid:a??void 0,showUri:e.show.uri,contextUri:d,provider:e.provider}),m=(0,h.jsx)(cc,{item:e,tooltipText:c.name,showTypeLabel:i,subtitle:(0,h.jsx)(ia.h,{menu:(0,h.jsx)(Ao.H,{uri:c.uri}),children:(0,h.jsx)(Me.N,{to:c.uri,stopPropagation:!0,children:c.name})})});return(0,h.jsx)(Wl,{uid:a,uri:s,contextUri:d,id:u,index:t,type:r,title:o,subtitle:m,images:l,dragLabel:o,menu:p,moreButtonLabelName:o,ariaPauseLabel:D.Ru.get("tracklist.a11y.pause",o,c.name),ariaPlayLabel:D.Ru.get("tracklist.a11y.play",o,c.name),...n})};var mc=i(13728),gc=i(2677),vc=i(17221),xc=i(59975),hc=i(46832);const yc=({track:e,index:t,showTypeLabel:i,...a})=>{const{uid:s,uri:r,type:o,name:l,album:c}=e,u=vl(e,t),d=dc(a.section),{uri:p}=(0,qs.f)(),m=e.isLocal?(0,h.jsx)(gc.A,{uri:r,uid:s??void 0,contextUri:d}):(0,h.jsx)(vc.P,{uri:r,uid:s??void 0,albumUri:c.uri,artists:e.artists,contextUri:d,entityContextUri:p??void 0,isSmartRecommendation:(0,tc.N)(e),provider:e.provider}),g=e.artists.map((({name:e})=>e)).join(D.Ru.getSeparator()),v=e.artists?(0,h.jsx)(cc,{item:e,tooltipText:g,showTypeLabel:i,subtitle:(0,h.jsx)(h.Fragment,{children:e.artists.map(((e,t)=>(0,h.jsxs)(n.Fragment,{children:[t>0&&D.Ru.getSeparator(),(0,h.jsx)(ia.h,{menu:(0,h.jsx)(mc.t,{uri:e.uri}),children:(0,h.jsx)(Me.N,{to:e.uri,stopPropagation:!0,children:e.name})})]},t)))})}):null,{isPlayable:x,isAnyArtistBanned:y}=(0,hc.g)(r,{isPlayable:!0,isLocal:(0,Cn.PkR)(r),isOutOfMarket:!1,artistUris:e.artists.map((e=>e.uri))}),{unBanArtists:b}=(0,xc.M)(e.artists.map((e=>e.uri)));return(0,h.jsx)(Wl,{uid:s,uri:r,contextUri:d,id:u,index:t,type:o,title:l,images:c.images,dragLabel:l,menu:m,moreButtonLabelName:l,subtitle:v,ariaPauseLabel:D.Ru.get("tracklist.a11y.pause",l,g),ariaPlayLabel:D.Ru.get("tracklist.a11y.play",l,g),isPlayable:!x,isAnyArtistBanned:y,handleArtistBanUndoClick:b,...a})};var bc=i(28584),fc=i(754);const jc=(e,t)=>{const i=(0,co.P)({uri:e??""},{featureIdentifier:"queue"}),a=(0,n.useMemo)((()=>function(e,t){return i=>{const a=(0,C.z)(),s=t===uc.$.NowPlaying,{playbackStatus:r,isActive:o,isPlaying:l}=(0,ir.gC)((e=>s&&i.uri?(0,fc.Ok)(e,i.uri):bc.i.NOT_ACTIVE)),c=e(i),u=(0,n.useCallback)((e=>{const{uri:t,uid:n}=i;c.triggerPlay(e,t?async()=>a.skipToNext({uri:t,uid:n??null}):void 0)}),[c,a,i]),d=(0,n.useCallback)((e=>{c.togglePlay(e,(()=>{if(o)return l?a.pause():a.resume();const{uri:e,uid:t}=i;return a.skipToNext(e?{uri:e,uid:t??null}:void 0)}))}),[c,o,i,a,l]);return{playbackStatus:r,isActive:o,isPlaying:l,triggerPlay:u,togglePlay:d}}}(i.usePlayContextItem,t)),[i.usePlayContextItem,t]);return{...i,usePlayContextItem:a}};var Cc=i(32807),wc=i(65311),Sc=i(3340);const Nc="main-nowPlayingView-queue",kc="SQF5NXZsecXwP7qjjQ70",Rc="main-nowPlayingView-openQueue",Ic="/search",Ec="/queue",Lc=n.memo((({spec:e})=>{const t=(0,xa.t)(e);return(0,h.jsxs)(Br.w,{className:Nc,ref:t,children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.your-dj.npv.queue.title")}),(0,h.jsx)(c.E,{as:"div",semanticColor:"textSubdued",children:D.Ru.get("web-player.your-dj.npv.queue.description")})]})})),Tc=n.memo((({spec:e,logger:t})=>{const i=(0,xa.t)(e);return(0,h.jsxs)(Br.w,{className:Nc,ref:i,children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.now-playing-view.empty-queue")}),(0,h.jsx)(Me.N,{to:Ic,children:(0,h.jsx)(ml,{onClick:()=>{const i=e.searchButtonFactory().hitUiNavigate({destination:Ic});t.logInteraction(i)},children:D.Ru.get("web-player.now-playing-view.empty-queue-cta")})})]})})),Ac=(0,sr.mc)((({isContextAd:e})=>{const{nextUp:t,queued:i}=(0,Sc.w)(),a=(0,Kr.Zp)(),r=(0,j._Y)(),o=(0,s.NC)(pa.eWj),l=(0,mr.L)(),{spec:c,logger:u}=(0,Pe.r)(ul._,{}),d=i[0]||t[0],{usePlayContextItem:p}=jc(d?.uri||null,uc.$.NextUp),m=(0,xa.t)(c),g=(0,n.useCallback)((()=>{const e=c.openQueueButtonFactory().hitUiNavigate({destination:Ec});u.logInteraction(e),o?r(W.$S.QUEUE_BUTTON_CLICK):a(Ec)}),[a,r,o,c,u]);return l?.context?.uri&&(0,Cc.HS)(l.context)?(0,h.jsx)(Lc,{spec:c}):l&&d?(0,h.jsxs)(Br.w,{className:Nc,ref:m,children:[(0,h.jsx)(Br.X,{action:(0,h.jsx)(re.H,{size:"small",condensed:!0,onClick:g,className:Rc,semanticColor:"textSubdued",children:D.Ru.get("web-player.now-playing-view.open-queue")}),children:D.Ru.get("queue.next-in-queue")}),(0,h.jsxs)("ul",{className:kc,children:[d.type===no.c.TRACK&&(0,h.jsx)(yc,{track:d,index:0,usePlayContextItem:p,isNpv:!0}),d.type===no.c.EPISODE&&(0,h.jsx)(pc,{episode:d,index:0,usePlayContextItem:p,isNpv:!0}),e&&d.type===no.c.AD&&(0,h.jsx)(Xl,{ad:d,index:0,usePlayContextItem:p,isNpv:!0})]})]}):(0,h.jsx)(Tc,{spec:c,logger:u})}),{name:"NPVNextInQueue"}),Pc=e=>(0,wc.V)()?null:(0,h.jsx)(Ac,{...e});var Dc=i(10447),Oc=i(92295),_c=i(49066);const Uc="_mPIDSVjofNyCLhlaXuL",Bc="WbtcAaLN1SQCr16tuZXv",Fc="mqlmYaGITrdEQC40rEOI",Mc="KEb8GSQPHsSmLCes_O07",Hc="Lkuf447h9WU9AaYHTsu7",Vc="VU8VpmUxiLG5anxsH03k",qc="JO8KMTdQoJAPhSpBlaqE",zc="oKZq5I1c9_xWl3NWP1SU",Qc=(0,sr.mc)((({coverArt:e,description:t,name:i,publisher:a,uri:s})=>{const r=(0,xi.y)(),{draggable:o,onDragStart:u}=(0,Jr.P)({itemUris:[s],dragLabelText:i}),[d,p]=(0,_c.A)(s),m=!(0,mt.n)(),g=(0,Kr.Zp)(),{spec:v,logger:x,UBIFragment:y}=(0,Pe.r)(Dc.M,{}),b=(0,n.useRef)(null),f=(0,n.useCallback)((()=>{const e=v.artworkFactory().hitUiNavigate({destination:s});x.logInteraction(e)}),[x,v,s]),j=(0,n.useCallback)((()=>{const e=v.titleFactory().hitUiNavigate({destination:s});x.logInteraction(e)}),[x,v,s]),C=(0,n.useCallback)((()=>{const e=v.podcastDescriptionFactory().hitUiNavigate({destination:s});x.logInteraction(e),g((0,Cn.o_h)(s).toURLPath(!0))}),[x,g,v,s]),w=(0,n.useCallback)((()=>{const e=v.followButtonFactory().hitFollow({itemToBeFollowed:s}),t=v.followButtonFactory().hitUnfollow({itemToBeUnfollowed:s});x.logInteraction(d?t:e),p(!d)}),[d,x,p,v,s]);return(0,h.jsxs)(Br.w,{className:Uc,children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.now-playing-view.podcast-about.title")}),(0,h.jsx)("div",{children:(0,h.jsx)("button",{type:"button","data-testid":"description-button",className:Bc,onClick:C,children:(0,h.jsx)(c.E,{as:"div",ref:b,variant:"bodySmall",className:Fc,children:(0,h.jsx)(ze.N,{source:t})})})}),(0,h.jsxs)("div",{className:l()(Mc,{[Hc]:r!==di.E.MEDIUM}),children:[(0,h.jsx)(y,{spec:v,children:(0,h.jsx)(V.v,{contentAlign:!0,id:"aboutPodcastNPV",className:qc,media:(0,h.jsx)(ia.h,{menu:(0,h.jsx)(Ao.H,{uri:s}),children:(0,h.jsx)(Me.N,{draggable:o,onDragStart:u,to:s,onClick:f,children:(0,h.jsx)(eo.b,{className:zc,type:no.c.SHOW,title:i,images:e?.sources,size:to.Qe.SIZE_48})})}),title:(0,h.jsx)(we.d,{lineClamp:1,children:(0,h.jsx)(ia.h,{menu:(0,h.jsx)(Ao.H,{uri:s}),children:(0,h.jsx)(Me.N,{draggable:o,onDragStart:u,to:s,onClick:j,children:i})})}),subtitle:(0,h.jsx)(ea.j,{lineClamp:1,variant:"bodySmall",children:a})})}),(0,h.jsx)(Oc.W,{isFollowing:d,onClick:w,disabled:m,className:Vc})]})]})}),{name:"NPVPodcastAbout"});var Gc=i(48472);const Yc="f6_Fu_ei4TIJWR0wzvTk",Kc="TLmzadNIdvV8sYzTuXRg",Zc="MT9De6UrCVQ8Qo6o3ikA",Wc=n.memo((()=>(0,h.jsx)("div",{className:Yc,"aria-hidden":!0,children:(0,h.jsxs)("div",{className:Kc,children:[(0,h.jsx)(Gc.Y,{as:"div",variant:"bodyMediumBold",className:Zc,charCount:8,isLoading:!0}),[20,50,25].map(((e,t)=>(0,h.jsx)(Gc.Y,{as:"div",variant:"bodySmall",className:Zc,charCount:e,isLoading:!0},t)))]})})));var Xc=i(37769);const Jc="m3pzWNRu8xGY36YIaCY1",$c=(0,sr.mc)((({topics:e,logTopicNavigation:t})=>!e||e.length<1?null:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.now-playing-view.discover-more")}),(0,h.jsx)(Xc.N,{topics:e,onClick:t,className:Jc})]})),{name:"NPVTopicsListWrapper"});var eu=i(44484);const tu="wYBEXo9heVZe_zkteOJ6",iu="EjaYcQIBa_uJkc86qrpQ",nu="QER3MDmhErzCc5bKcklD",au="fAKKlaCbuHm_cDfnO3UW",su="AHOmz0JPJhoOloFpM8s2",ru="d8y50Fa8LDK2Fuc92EaA",ou="XBYrBviGypqaAfM1BWxM",lu="G4fVEUX2caQTFPB7mA89",cu="ATHbG3rw7VRat_Knu9EO",uu="LsAbtB5dQLMOgNkK6uNl",du="nng8b1skt_Yh69A8uReL",pu=e=>{switch(e){case di.E.SMALL:return"titleSmall";case di.E.LARGE:return"titleMedium";case di.E.XLARGE:return"titleLarge";default:return"titleSmall"}},mu=({readAlongSection:e,readAlongIndex:t,index:i,activeIndex:a,onActiveSectionChange:s,breakpoint:r})=>{const o=(0,n.useRef)(!0),u=(0,n.useRef)(null);return(0,n.useEffect)((()=>{i===a&&s?(o.current&&s({sectionRef:u}),o.current=!1):o.current=!0}),[a,i,s]),void 0===e.text?.sentence?.text?null:(0,h.jsx)("div",{ref:u,className:l()(au,{[su]:i<a},r?.toLowerCase()),children:(0,h.jsx)(c.E,{as:"p",className:iu,variant:r?pu(r):"titleSmall",children:t>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("span",{className:lu,children:e.text.sentence.text.substring(0,t)}),(0,h.jsx)("span",{children:e.text.sentence.text.substring(t)})]}):e.text.sentence.text})})};var gu=i(40564);const vu=(e,t)=>{let i=0;if(0===e.length)return 0;for(let n=0;n<e.length&&!(t<e[n].startMs);n++)i+=e[n].numChars;return i};var xu=i(96022);const hu=e=>{const t=["transcript",{uri:e}],{data:i,isLoading:n,isError:a}=(0,on.I)({queryKey:t,queryFn:async()=>{if(e&&(0,Cn.gHQ)(e))return(async e=>{const t=(0,Cn.o_h)(e).id,i=An.n.getInstance(),n=await i.build().withHost(xu.ao).withPath(`/episode/${encodeURIComponent(t)}`).withEndpointIdentifier("/episode/{episodeId}").withoutMarket().withoutGlobalHeaders().withQueryParameters({format:"json"}).send();if(200!==n.status)throw new Error("failed to get read-along transcript");return n.body})(e)},gcTime:18e5,staleTime:6e5});return{data:i,loading:n,error:a}};var yu=i(76597);const bu={[di.E.SMALL]:0,[di.E.LARGE]:792,[di.E.XLARGE]:1448},fu=({startMs:e,onTimestampClick:t})=>(0,h.jsx)("button",{className:ru,onClick:()=>{t(e)},children:(0,h.jsx)(c.E,{className:ou,variant:"bodyMedium",children:(0,Nr.f)(e)})}),ju=({hidden:e,onClick:t})=>(0,h.jsx)("div",{className:l()(cu,{[uu]:e}),children:(0,h.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:t,iconLeading:Ot.Q,"aria-label":D.Ru.get("web-player.read-along-transcript.sync.button"),children:D.Ru.get("web-player.read-along-transcript.sync.button")})}),Cu=({episodeURI:e,mode:t})=>{const{data:i,loading:a,error:s}=hu(e),{spec:r,logger:o}=(0,Pe.r)(eu.c,{data:{uri:e}}),c=i?.section??[],u=r.timestampLinkFactory(),[d,p]=(0,n.useState)(!0),[m,g]=(0,n.useState)(!1),v=(0,C.z)(),x=(0,gt.o)((e=>e?.isPaused??void 0)),y=(0,n.useRef)(null),b=(0,n.useRef)(!1),f=(0,n.useRef)(null),j=(0,n.useRef)(null),w=(0,n.useRef)(null);(0,yu.p)(w);const{breakpoint:S}=(0,pn.x)(bu,j),{highlightedSentenceIndex:N,shouldAnimateScroll:k,readAlongIndex:R}=((e,t)=>{const i=(0,n.useRef)(0),[a]=(0,gu.f)(100,(t=>t?.item?.uri===e));let s=t.findIndex((e=>e.text?.sentence?.text)),r=0;for(let e=0;e<t.length;e++){const i=t[e];if(a>=i.startMs&&(e===t.length-1||a<t[e+1].startMs)){s=e,i.text?.sentence&&(r=vu(i.text.sentence.highlight,a));break}}const o=Math.abs(i.current-(s??0))<=3;return i.current=s??0,{shouldAnimateScroll:o,highlightedSentenceIndex:s,readAlongIndex:r}})(e,c),I=(0,n.useCallback)((()=>{if(!j.current||!y.current)return;const e=y.current?.offsetTop-j.current?.offsetTop-24;void 0!==e&&(j.current?.scrollTo({top:e,behavior:k?"smooth":"auto"}),g(!1))}),[k]),E=(0,n.useCallback)((()=>{if(!j.current||!y.current)return;const e=y.current?.offsetTop-j.current?.offsetTop-24,t=y.current?.clientHeight;if(void 0===e)return;const i=e>=j.current.scrollTop&&e+t<=j.current.scrollTop+j.current.clientHeight;g(!i),p(i)}),[]),L=(0,n.useCallback)((t=>{v.seekTo(t).then((()=>setTimeout((()=>p(!0)),300))),x?(v.resume(),o.logInteraction(u.hitPlay({itemToBePlayed:e}))):o.logInteraction(u.hitSeekToTime({msToSeekTo:t}))}),[v,o,u,e,x]),T=(0,n.useCallback)((()=>{b.current=!0,f.current&&clearTimeout(f.current),f.current=setTimeout((()=>{b.current=!1}),500),E()}),[E]),A=(0,n.useCallback)((()=>{E(),b.current||d&&I()}),[d,E,I]);return a||s||0===c.length?null:(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(xi.o.Provider,{value:S,children:[(0,h.jsx)("div",{className:l()(tu,{[nu]:t===Ra.aY.npv}),ref:j,onWheel:T,children:(0,h.jsx)("div",{className:du,ref:w,children:(0,h.jsx)("div",{children:c.map(((e,t)=>e.title?(0,h.jsx)(fu,{onTimestampClick:L,startMs:e.startMs},t):(0,h.jsx)(mu,{index:t,activeIndex:N,readAlongSection:e,readAlongIndex:N===t?R:0,onActiveSectionChange:({sectionRef:e})=>{y.current=e.current,A()},breakpoint:S},t)))})})}),(0,h.jsx)(ju,{hidden:!!x||!m,onClick:()=>{o.logInteraction(r.syncButtonFactory().hitQuickScroll()),p(!0),I()}})]})})},wu=({mode:e})=>{const t=(0,gt.o)((e=>e?.item),((e,t)=>e?.uri===t?.uri));return t?.uri&&(0,Cn.gHQ)(t.uri)?(0,h.jsx)(Cu,{mode:e,episodeURI:t.uri}):null};var Su=i(50780);let Nu=function(e){return e.SET_TRANSCRIPT_UI_FLAG="SET_TRANSCRIPT_UI_FLAG",e}({});var ku=i(36758);const Ru=e=>e.ui?.transcript?.mode??Ra.aY.none,Iu=e=>e.ui?.transcript?.uiFlags??ku.aj;var Eu=i(8296),Lu=i(91470);const Tu="_nDkCIVgkWayq3tqiIuW",Au=({episode:e})=>{const{transcriptMode:t}=(()=>{const e=(0,P.wA)(),t=(0,P.d4)(Iu);return{transcriptMode:(0,P.d4)(Ru),setTranscriptUIFlag:(0,n.useCallback)(((t,i)=>{e({type:Nu.SET_TRANSCRIPT_UI_FLAG,key:t,value:i})}),[e]),transcriptUIFlags:t}})(),{data:i}=hu(e.uri),a=i?.colourData,s={"--transcript-color-background":a?Eu.Q.fromInt(a.background).toCSS(Lu.a.HEX):Su.PQ2,"--transcript-color-text":Eu.Q.fromInt(a?.text??0).toCSS(Lu.a.HEX),"--transcript-color-highlightText":Eu.Q.fromInt(a?.highlightText??-1).toCSS(Lu.a.HEX)},{spec:r}=(0,Pe.r)(eu.c,{data:{uri:e.uri}}),o=(0,xa.t)(r);return(0,h.jsxs)(Br.w,{className:Tu,style:s,ref:o,children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.read-along-transcript.now-playing-view.read-along")}),t===Ra.aY.npv&&(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(wu,{mode:Ra.aY.npv})})]})};var Pu=i(20618),Du=i(7927);var Ou=i(20731),_u=i(6328),Uu=i(94811);const Bu="jmVy04VnzhcDZbU5PDSR",Fu="Art4GUNuIb1DIs1FlRRq",Mu=({uri:e})=>{const{data:t}=(e=>{const t=(0,Du.n)(),{data:i,isLoading:n,isError:a}=(0,on.I)({queryKey:["useTopComments",e],queryFn:async()=>await t.getTopComments(e),gcTime:36e5,staleTime:3e4});return{data:i,isLoading:n,isError:a}})(e),i=(0,Kr.Zp)(),a=(0,n.useCallback)((t=>{const n=(0,Cn.o_h)(e)?.toURLPath(!0);n&&i({pathname:n,search:(0,Pu.PI)({id:t}).toString()})}),[i,e]);if(!t||0===t.totalCount)return null;const{isRestricted:s,isHidden:r}=(0,Uu.K)(t.eligibilityStatus);return r?null:(0,h.jsxs)(Br.w,{className:Bu,children:[(0,h.jsx)(Br.X,{action:(0,h.jsx)(re.H,{size:"small",condensed:!0,semanticColor:"textSubdued",onClick:()=>a("top"),children:(0,Ut.v)(`Show all (${t.totalCount})`)}),children:(0,Ut.v)("Comments")}),(0,h.jsxs)("div",{children:[(0,h.jsx)(Ou.K,{eligibility:t.eligibilityStatus}),t.comments.map(((e,t)=>(0,h.jsx)(_u.c,{comment:e,showSeparator:t>0,lineClamp:2,onClickNavigate:a},`${e.uri}-${t}`)))]}),!s&&(0,h.jsx)("div",{className:Fu,children:(0,h.jsx)(se.n,{size:"small",onClick:()=>a("new"),children:(0,Ut.v)("Leave a comment")})})]})};var Hu=i(1817),Vu=i(60163),qu=i(99010),zu=i(99916);const Qu=({item:e,spec:t})=>{const i=(0,n.useCallback)((()=>{}),[]),a=(0,gt.o)((e=>e?.isPaused??void 0)),r=(0,C.z)(),{isPlaying:o,isActive:l}=(0,ir.te)(e.uri),c=(0,s.NC)(pa.cgF),u=(0,s.NC)(pa.xEc),d=(0,s.NC)(pa.h0Y),p=(0,s.NC)(pa.MCN,{loadingValue:!1}),m=(0,s.NC)(pa.r1q),g=(0,s.NC)(pa.iGu,{loadingValue:!1}),v=(0,Go.W)(),x=(0,Hu.c)(),y=(0,Vu.d)(e.uri)?.episodeOrChapter,b=ll(e),f=(0,n.useCallback)(((t,i,n,s)=>{let c="play";!o||0!==t&&i||(c="pause"),v({intent:c,targetUri:e.uri,type:"click",itemIdSuffix:t>0?"podcast-description-timestamp":"button"}),y&&x?xr.h.set((()=>({triggerId:n||"activation-trigger-mme",triggerAction:null}))):l&&!i?a?(s?.("resume"),r.resume()):(s?.("pause"),r.pause()):r.seekTo(t)}),[o,v,e.uri,y,x,l,a,r]),j=(0,n.useCallback)(((e,t)=>{f(e,!0,t)}),[f]),w={uri:e.uri,includeChapters:d,includeAIDubbedEpisodes:m,numberOfChapters:10},{data:S,isLoading:N,error:k}=(({queryKey:e,staleTime:t,gcTime:i,withGatedEntityRelations:a,variables:s})=>{const{request:r}=(0,n.useContext)(_r.j);return(0,on.I)({queryKey:e,staleTime:t,gcTime:i,queryFn:()=>a?(0,Ur.c)(r,Do,s).then((e=>e?.data)):(0,Ur.c)(r,Po,s).then((e=>e?.data))})})({queryKey:["queryNpvEpisode",p,w],staleTime:Or,gcTime:Dr,withGatedEntityRelations:p,variables:w}),[R,I]=(0,n.useState)(null),E=(0,n.useCallback)((async e=>{const t=await(0,qu.Q)(e);I(t)}),[]);if((0,n.useEffect)((()=>{y&&!(0,zu.Gr)(y)&&y.transcript&&y.transcript.length>0&&E(y.transcript[0].cdnUrl)}),[E,y]),N&&e.uri&&!k)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Wc,{}),(0,h.jsx)(Wc,{})]});const L=(T=S?.episodeUnionV2,Vr(T)?T:void 0);var T;const A=(e=>{return Vr(e)&&(t=e.podcastV2.data,"Podcast"===t?.__typename)?e.podcastV2.data:void 0;var t})(S?.episodeUnionV2);if(!e.uri||!L||N||k)return null;const{chapters:P,nextOffset:O,limit:_}=function(e){if("DisplaySegments"===e.displaySegments?.__typename)return{chapters:e.displaySegments.displaySegments.items,nextOffset:e.displaySegments.displaySegments.pagingInfo.nextOffset,limit:e.displaySegments.displaySegments.pagingInfo.limit};return{chapters:[],nextOffset:0,limit:0}}(L),U=P.length>0,B=L.displaySegments?.chapterTags?.includes("automatically-generated")||!1;return(0,h.jsxs)(fa.r,{spec:t,children:[p&&(0,h.jsx)(Mo,{episode:L}),m&&!L.originalEpisode&&(0,h.jsx)(bo,{episode:L}),m&&(0,h.jsx)(jo,{episode:L}),U&&!b&&(0,h.jsx)(Mr,{chapters:P,episodeUri:e.uri,nextOffset:O,limit:_,isPlaying:o,isMLGeneratedChapters:B}),g&&(0,h.jsx)(Mu,{uri:L.uri}),u&&A&&(0,h.jsx)(Qc,{coverArt:A.coverArt||void 0,description:A.htmlDescription||"",name:A.name,publisher:A.publisher?.name,uri:A.uri}),y&&y.type===no.c.EPISODE&&y.transcript&&y.transcript.length>0&&(c?(0,h.jsx)(Au,{episode:e}):(0,h.jsxs)(Br.w,{className:So,children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.now-playing-view.transcript")}),R&&(0,h.jsx)(To,{transcriptSections:R||[],onTimeStampClick:j,episodeUri:e.uri})]})),b&&(0,h.jsx)(cl,{item:e}),(0,h.jsx)($c,{topics:A?.topics.items??[],logTopicNavigation:i}),(0,h.jsx)(Pc,{})]})},Gu=({item:e,spec:t})=>(0,mt.n)()?(0,h.jsx)(Qu,{item:e,spec:t}):(0,h.jsx)(h.Fragment,{});const Yu=()=>(0,h.jsx)(h.Fragment,{}),Ku=new Tr.l("queryNpvArtist","query","32f0d2428fef557a26a9ccf18fec418dcc2fd5de6b79c5fe33bf7f73539cc15d",null);var Zu=i(10796),Wu=i(40178),Xu=i(38759),Ju=i(39399),$u=i(84744),ed=i(4592);const td="main-nowPlayingView-aboutArtist",id="main-nowPlayingView-aboutArtistContent",nd="main-nowPlayingView-aboutArtistButton",ad="main-nowPlayingView-aboutArtistHasImage",sd="main-nowPlayingView-aboutArtistBio",rd="main-nowPlayingView-aboutArtistTextContent",od="main-nowPlayingView-aboutArtistPlaceholderWrapper",ld=new Set(["spotify:artist:5UUG83KSlqPhrBssrducWV"]),cd=(0,sr.mc)((({artistUri:e,artist:t,visuals:i,stats:a,externalLinks:r=[]})=>{const o=(0,P.wA)(),{gallery:u,avatarImage:d}=i,{monthlyListeners:p}=a,m=(0,Cn.o_h)(e).toURLPath(!0),g=(0,Ju.W)({uri:e,type:"locale"})?(0,ed.hF)(m):m,{spec:v,logger:x}=(0,Pe.r)(Wu.p,{}),y=(0,s.NC)(pa.lVm,{loadingValue:!1}),b=(0,xa.t)(v,y),f=(0,Kr.Zp)(),j=(0,n.useCallback)((()=>{if(t&&e){const n=v.hitUiReveal();x.logInteraction(n),o((0,ta.p5)({artistUri:e,artist:t,stats:a,visuals:i,externalLinks:r})),f(g)}}),[v,x,g,o,f,e,t,a,i,r]);if(ld.has(e)||!t.biography?.text)return null;const C=[];u.items.forEach((e=>{const t=e.sources.map($u.m),i=(0,Hl.g)(t,{desiredLabel:"large",desiredSize:600});i&&C.push(i)}));const w=C.find((e=>(e.width||0)>=(e.height||0))),S=[];d?.sources.forEach((e=>{const t=(0,$u.m)(e);t&&S.push(t)}));const N=w&&{backgroundImage:`linear-gradient(${pl.PUl} 0%, ${pl.MYb} 100%), url(${w.url})`},k=t.verified&&!w&&S.length>0||!t.verified&&!w;return(0,h.jsx)(Br.w,{className:td,ref:b,children:(0,h.jsx)("button",{type:"button","aria-label":t.name,className:l()(nd,{[ad]:!!N}),onClick:j,style:N,"data-testid":"npv-artist-bio-button",children:(0,h.jsxs)("div",{className:l()(id),children:[t.verified&&(0,h.jsx)(Xu.M,{text:D.Ru.get("artist.verified")}),k&&(0,h.jsx)(Fl.e,{images:S,label:t.name,width:80,userIconSize:"large",testID:"npv-artist-bio-avatar",customPlaceholder:(0,h.jsx)("div",{className:od,"data-testid":"npv-artist-bio-placeholder-wrapper",children:(0,h.jsx)(Zu.r,{size:"large"})})}),(0,h.jsxs)("div",{className:rd,children:[(0,h.jsx)(c.E,{as:"div",variant:"bodyMedium",children:!!p&&D.Ru.get("artist.monthly-listeners-count",p)}),(0,h.jsx)("div",{children:(0,h.jsx)(c.E,{as:"span",variant:"bodySmall",className:sd,children:(0,h.jsx)(ze.N,{source:t.biography.text})})})]})]})})})}),{name:"NPVArtistAbout"}),ud="main-nowPlayingView-aboutArtistV2",dd="main-nowPlayingView-aboutArtistV2Button",pd="main-nowPlayingView-aboutArtistV2Title",md="main-nowPlayingView-aboutArtistV2HasImage",gd="main-nowPlayingView-aboutArtistV2ImageContainer",vd="main-nowPlayingView-aboutArtistV2Image",xd="main-nowPlayingView-aboutArtistV2TextContent",hd="main-nowPlayingView-aboutArtistV2Name",yd="main-nowPlayingView-aboutArtistV2Listeners",bd="main-nowPlayingView-aboutArtistV2ListenersCount",fd="main-nowPlayingView-aboutArtistV2FollowButton",jd="main-nowPlayingView-aboutArtistV2Bio",Cd="main-nowPlayingView-aboutArtistV2PlaceholderWrapper",wd="main-nowPlayingView-aboutArtistV2Avatar",Sd=new Set(["spotify:artist:5UUG83KSlqPhrBssrducWV"]),Nd=(0,sr.mc)((({artistUri:e,artist:t,visuals:i,stats:a,externalLinks:r=[]})=>{const o=(0,P.wA)(),{gallery:u,avatarImage:d}=i,{monthlyListeners:p}=a,m=(0,Cn.o_h)(e).toURLPath(!0),g=(0,Ju.W)({uri:e,type:"locale"})?(0,ed.hF)(m):m,[v,x]=(0,_c.A)(e),{spec:y,logger:b}=(0,Pe.r)(Wu.p,{}),f=(0,s.NC)(pa.lVm,{loadingValue:!1}),j=(0,xa.t)(y,f),C=(0,n.useCallback)((()=>{if(t&&e){const n=y.hitUiReveal();b.logInteraction(n),o((0,ta.p5)({artistUri:e,artist:t,stats:a,visuals:i,externalLinks:r}))}}),[y,b,o,e,t,a,i,r]),w=(0,n.useCallback)((t=>{t.stopPropagation();const i=y.artistNameFactory().hitUiNavigate({destination:e});b.logInteraction(i)}),[y,e,b]),S=(0,n.useCallback)((async t=>{t.preventDefault(),t.stopPropagation();const i=y.followButtonFactory().hitFollow({itemToBeFollowed:e}),n=y.followButtonFactory().hitUnfollow({itemToBeUnfollowed:e});b.logInteraction(v?n:i);try{await x(!v)}catch{}}),[e,v,b,x,y]),N=(0,n.useCallback)((e=>{if("Enter"===e.key)return S(e)}),[S]);if(Sd.has(e)||!t.biography?.text)return null;const k=[];u.items.forEach((e=>{const t=e.sources.map($u.m),i=(0,Hl.g)(t,{desiredLabel:"large",desiredSize:600});i&&k.push(i)}));const R=k.find((e=>(e.width||0)>=(e.height||0))),I=[];d?.sources.forEach((e=>{const t=(0,$u.m)(e);t&&I.push(t)}));const E=R&&{backgroundImage:`linear-gradient(${pl.i_N} 0%, ${pl.Par} 50%), url(${R.url})`},L=!R&&I.length>0,T=!R&&0===I.length;return(0,h.jsx)(Br.w,{className:ud,ref:j,children:(0,h.jsxs)("button",{type:"button","aria-label":t.name,className:l()(dd),onClick:C,tabIndex:0,"data-testid":"npv-artist-bio-button",children:[(0,h.jsxs)("div",{className:l()(gd,{[vd]:R}),style:E,children:[(0,h.jsx)("div",{className:l()(pd,{[md]:R}),children:(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.now-playing-view.artist-about.title")})}),T&&(0,h.jsx)("div",{className:l()(Cd),"data-testid":"npv-artist-bio-placeholder-wrapper",children:(0,h.jsx)(Zu.r,{size:"xxlarge"})}),L&&(0,h.jsx)(Fl.e,{images:I,label:t.name,width:80,userIconSize:"large",testID:"npv-artist-bio-avatar",className:wd})]}),(0,h.jsxs)("div",{className:xd,children:[(0,h.jsx)("div",{className:hd,children:(0,h.jsx)(Pu.N_,{to:g,onClick:w,"data-testid":"npv-artist-link",children:(0,h.jsx)(c.E,{as:"span",variant:"bodyMediumBold",dir:"auto",children:t.name})})}),(0,h.jsxs)("div",{className:yd,children:[(0,h.jsx)(c.E,{as:"div",variant:"bodyMedium",className:bd,children:!!p&&D.Ru.get("artist.monthly-listeners-count",p)}),(0,h.jsx)(se.n,{as:"div",size:"small",className:fd,onClick:S,onKeyDown:N,tabIndex:0,children:v?D.Ru.get("unfollow"):D.Ru.get("follow")})]}),(0,h.jsx)(c.E,{as:"span",variant:"bodySmall",className:jd,children:(0,h.jsx)(ze.N,{LinkComponent:Pu.N_,source:t.biography.text,onLinkClick:e=>{e.stopPropagation()}})})]})]})})}),{name:"NPVArtistAboutV2"});var kd=i(99981);const Rd=({artistUri:e,spec:t,logger:i})=>{const[a,s]=(0,_c.A)(e),r=(0,n.useCallback)((async()=>{if(!t||!i)return;const n=t.hitFollow({itemToBeFollowed:e}),r=t.hitUnfollow({itemToBeUnfollowed:e});i.logInteraction(a?r:n);try{await s(!a)}catch{}}),[e,a,i,s,t]),o=a?D.Ru.get("unfollow"):D.Ru.get("follow");return(0,h.jsx)(Oc.W,{isFollowing:a,onClick:r,buttonText:o})},Id=({artistName:e,roles:t,spec:i,logger:a,linkable:s=!1})=>{const r=t[0].artistUri,o=t.map((e=>e.role)).join(D.Ru.getSeparator()),l=(0,Cn.o_h)(r).toURLPath(!0),u=(0,Ju.W)({uri:r,type:"locale"})?(0,ed.hF)(l):l,d=(0,n.useCallback)((e=>{if(e.stopPropagation(),!i||!a)return;const t=i.artistNameFactory().hitUiNavigate({destination:r});a.logInteraction(t)}),[i,r,a]);return(0,h.jsx)(V.v,{title:s?(0,h.jsx)(Me.N,{to:u,onClick:d,"data-testid":"artist-row-credits-link",children:(0,h.jsx)(c.E,{variant:"bodyMedium",children:e})}):(0,h.jsx)(c.E,{variant:"bodyMedium",children:e}),size:"sm",paddingInlineStart:"0",paddingInlineEnd:"0",subtitle:(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",style:{textTransform:"capitalize"},"data-testid":"artist-row-role",children:o}),"data-testid":"credits-artist-row",variant:"naked",id:r,trailing:s&&(0,h.jsx)(Rd,{artistUri:r,spec:i?.followToggleButtonFactory(),logger:a})},e)};let Ed=function(e){return e.MainArtist="main artist",e.FeaturedArtist="featured artist",e.Remixer="remixer",e.Actor="actor",e.Composer="composer",e.Orchestra="orchestra",e.Writer="writer",e.Producer="producer",e.Performer="performer",e.Lyricist="lyricist",e.Conductor="conductor",e.Author="author",e.Editor="editor",e.Arranger="arranger",e.EnsembleOrchestra="ensemble orchestra",e}({});const Ld=(0,n.memo)((({data:e,limit:t})=>{const{spec:i,logger:n}=(0,Pe.r)(kd.D,{}),a=e.reduce(((e,t)=>{const{artistName:i}=t,n=e.get(i)??[];return n.push(t),e.set(i,n),e}),new Map),s=Array.from(a,(([e,t],a)=>(0,h.jsx)(Id,{artistName:e,roles:t.sort(((e,t)=>e.role.toLowerCase()===Ed.MainArtist?-1:t.role.toLowerCase()===Ed.MainArtist?1:0)),spec:i.creditsRowFactory({position:a}),logger:n,linkable:t.filter((e=>e.isArtistUriLinkable)).length>0},e))).slice(0,t);return(0,h.jsx)(h.Fragment,{children:s})})),Td="main-nowPlayingView-credits",Ad="main-nowPlayingView-creditsShowAll",Pd=(0,sr.mc)((({data:e,trackUri:t})=>{const i=(0,P.wA)(),a=(0,s.NC)(pa.QIZ),{spec:r,logger:o}=(0,Pe.r)(kd.D,{}),l=(0,n.useCallback)((()=>{o.logInteraction(r.showAllButtonFactory().hitUiReveal()),i((0,ta.P0)(!0,t))}),[i,o,r,t]),c=(0,xa.t)(r,a);return 0===e.length?null:(0,h.jsxs)(Br.w,{className:Td,ref:c,children:[(0,h.jsx)(Br.X,{action:(0,h.jsx)(re.H,{size:"small",condensed:!0,onClick:l,className:Ad,semanticColor:"textSubdued",children:D.Ru.get("web-player.now-playing-view.show-all")}),children:D.Ru.get("web-player.now-playing-view.credits")}),(0,h.jsx)(Ld,{data:e,limit:3})]})}),{name:"NPVCredits"});var Dd=i(18946),Od=i(34605),_d=i(81178),Ud=i(69257),Bd=i(13556),Fd=i(41569),Md=i(78511);const Hd="main-nowPlayingView-sectionHeaderSpacing",Vd="main-nowPlayingView-lyricsTitle",qd="main-nowPlayingView-lyricsControls",zd="main-nowPlayingView-lyricsGradient",Qd="main-nowPlayingView-lyricsContent",Gd=()=>{const{spec:e,logger:t}=(0,Pe.r)(Dd.X,{}),{setMode:i}=(0,Bd.r)();return(0,h.jsxs)("div",{className:qd,children:[(0,h.jsx)(Md.D,{label:D.Ru.get("web-player.now-playing-view.lyrics.cinema-mode"),onClick:()=>{i(Ra.YU.cinema),t.logInteraction(e.cinemaModeButtonFactory().hitUiReveal()),t.logImpression(e.cinemaModeButtonFactory().impression())},children:(0,h.jsx)(Fd.C,{size:"small"})}),(0,h.jsx)(Md.D,{label:D.Ru.get("web-player.now-playing-view.close.lyrics"),onClick:()=>{i(Ra.YU.none),t.logInteraction(e.closeLyricsButtonFactory().hitUiHide())},children:(0,h.jsx)(Ws.M,{size:"small"})})]})};var Yd=i(18426);const Kd=(0,sr.mc)((({item:e})=>{const{spec:t,logger:i}=(0,Pe.r)(Dd.X,{}),a=(0,n.useRef)(null),{mode:s,setMode:r}=(0,Bd.r)(),o=(0,n.useRef)(null),u=(0,n.useRef)(0),{data:d}=(0,Ud.J)(),p=(0,gt.o)((e=>e?.nextItems?.[0]),((e,t)=>e?.uri===t?.uri));(0,_d.I)(p?.uri,p?.images);const m=(0,n.useCallback)((()=>{u.current=Date.now()}),[]),g=(0,n.useCallback)((({lineRef:e,isActiveLine:t,shouldAnimateScroll:i,activeLineIndex:n,isFirstLine:s})=>{if(!a.current||!o.current)return;let r;if(e.current&&t?r=e.current?.offsetTop-o.current?.offsetTop-16:s&&n<0&&(r=0),void 0===r)return;const l=o.current?.scrollTop,c=Math.abs(l-r),d=a.current.clientHeight,p=Date.now()-u.current<2e3,m=u.current>0&&c>1*d;if(p||m)return;u.current=0;const g="visible"===document.visibilityState&&i?"smooth":"auto";o.current?.scrollTo({top:r,behavior:g})}),[]);(0,n.useLayoutEffect)((()=>{u.current=0,o.current?.scrollTo({top:0,behavior:"auto"})}),[e.uri]);const v=(0,Yd.H)(),x=v?.higherContrast;if(!d?.hasLyrics)return null;if(s===Ra.YU.npv){const t=d?.hasLyrics&&!d.isTimeSynced,i={"--lyrics-color-active":x?.textBase.toCSS(Lu.a.RGBA)??(t?pl.ONy:d.colors.activeText),"--lyrics-color-inactive":x?.textSubdued.toCSS(Lu.a.RGBA)??d.colors.text,"--lyrics-color-passed":x?.textBase.toCSS(Lu.a.RGBA)??Eu.Q.fromCSS(d.colors.activeText,.7).toCSS(Lu.a.RGBA),"--lyrics-color-background":x?.backgroundBase.toCSS(Lu.a.RGBA)??d.colors.background};return(0,h.jsxs)(Br.w,{className:l()(Hd,zd),style:i,ref:a,children:[(0,h.jsx)(Br.X,{action:(0,h.jsx)(Gd,{}),className:Vd,children:D.Ru.get("web-player.lyrics.title")}),(0,h.jsxs)("div",{className:Qd,ref:o,onWheel:m,onScroll:m,children:[t&&(0,h.jsx)(c.E,{as:"p",variant:"bodySmall",dir:"auto",style:{color:d.colors.text},children:D.Ru.get("web-player.lyrics.unsynced")}),(0,h.jsx)(Od.x,{trackUri:e.uri,data:d,format:"card",onActiveLineChange:g})]})]})}return(0,h.jsx)(Br.w,{className:Hd,children:(0,h.jsx)(Br.X,{action:(0,h.jsx)(ml,{onClick:()=>{r(Ra.YU.npv),i.logInteraction(t.showLyricsButtonFactory().hitUiReveal()),i.logImpression(t.showLyricsButtonFactory().impression())},children:D.Ru.get("web-player.now-playing-view.show.lyrics")}),className:Vd,children:D.Ru.get("web-player.lyrics.title")})})}),{name:"NPVLyrics"});var Zd=i(12031);const Wd="main-nowPlayingView-merch",Xd=(0,sr.mc)((({artistId:e,merch:t})=>!t||t.length<1?null:(0,h.jsxs)(Br.w,{className:Wd,children:[(0,h.jsx)(Br.X,{children:D.Ru.get("web-player.now-playing-view.npv-merch")}),(0,h.jsx)(Zd.ArtistOffers,{items:t,artistId:e,merchVariant:Aa.Ol.VARIANTA,variant:"bodyMedium"})]})),{name:"NPVMerchOffers"});var Jd=i(80596),$d=i(20612),ep=i(16641);const tp="main-nowPlayingView-artistOnTour",ip="main-nowPlayingView-artistOnTourItem",np="main-nowPlayingView-artistOnTourShowAll",ap=(0,sr.mc)((({artistId:e,data:t,variant:i="bodyMedium"})=>{const n=(0,ep.Dh)(e),a=(0,Kr.Zp)(),{spec:s,logger:r}=(0,Pe.r)(Jd.N,{data:{identifier:e,uri:n,position:0,reason:"NPV - On Tour"}}),o=(0,xa.t)(s),l={items:t.items.map((e=>({...e,artists:{items:e.artistsV2.items.flatMap((e=>"Artist"===e.data.__typename?e.data:[]))}}))),totalCount:t.totalCount};return l.items.length?(0,h.jsxs)(Br.w,{className:tp,ref:o,children:[(0,h.jsx)(Br.X,{action:l.items.length!==l.totalCount&&(0,h.jsx)(re.H,{size:"small",condensed:!0,className:np,onClick:()=>{(()=>{const e=s.seeAllButtonFactory({uri:n}).hitUiNavigate({destination:`${n}:concerts`});r.logInteraction(e);const t=(0,Cn.o_h)(`${n}:concerts`).toURLPath(!0);a(t)})()},semanticColor:"textSubdued",children:D.Ru.get("web-player.now-playing-view.show-all")}),children:D.Ru.get("web-player.now-playing-view.on-tour")}),l.items.map(((e,t)=>(0,h.jsx)("div",{className:ip,children:(0,h.jsx)($d.I,{concert:e,index:t,spec:s,condensed:!0,elevatedDate:!0,titleVariant:i})},e.uri)))]}):null}),{name:"NPVOnTour"});var sp=i(75461),rp=i(99965),op=i(39039),lp=i(37300),cp=i(81961);const up="TIoJv8dV373UyvBWRDav",dp="xn9l3L0D_ZzL886N4J_5",pp="P8bNOGKtEtIZXnWEw61V",mp="PpQWFsG9yJRfPFiERSti",gp="chgeyo_c9jfrfuEJg5sk",vp="MLbUPrgOa58_qsGikfRG",xp="l7B1SCkbYm9oU2tO9mOW",hp="kT3XHoiG64bhNORLJv09",yp=16,bp=(0,sr.mc)((({relatedVideos:e,contextUri:t})=>{const i=D.Ru.get("npv.related-videos.title"),a=D.Ru.get("npv.related-videos.prev"),s=D.Ru.get("npv.related-videos.next"),{spec:r,logger:o}=(0,Pe.r)(rp.E,{data:{uri:t,identifier:lp.K.npv}}),c=(0,sp.f)({data:{identifier:"related-videos",position:0,uri:t},parentAbsoluteLocation:r.getAbsoluteLocation()}),u=(0,n.useRef)(null),[d,p]=(0,n.useState)(0),[m,g]=(0,n.useState)(0),[v,x]=(0,n.useState)("auto"),y=(0,xi.y)(),b=(0,Ts.W)();(0,n.useLayoutEffect)((()=>{const e=u.current;e&&g(e.clientWidth)}),[]),(0,cp.w)({onResize:e=>{g(e.width),y===di.E.MEDIUM&&p(0)},refOrElement:u});const f=y===di.E.MEDIUM?2:1,j=Math.ceil(e.length/f)-1,C=y===di.E.MEDIUM?(m-yp*f)/f:85*m/100,w=f*C+yp*f,S=(0,n.useCallback)((()=>{const t=d*w;return d===j&&t>0&&2===f?e.length%2==0?t+yp*f:t-C+yp:t}),[d,C,w,j,e.length,f]),N=(0,n.useMemo)((()=>{const t=2===e.length&&2===f?C+8:C,i=S();return{pointerEvents:v,"--video-flex-basis":`${t}px`,transform:`translateX(-${i}px)`}}),[e.length,f,C,S,v]);(0,n.useEffect)((()=>{const e=u?.current,t=()=>{x("auto")};return e?.addEventListener("transitionend",t),()=>{e?.removeEventListener("transitionend",t)}}),[]);const k=(0,n.useCallback)((e=>{x("none"),p(d+e),e>0&&b||e<0&&!b?o.logInteraction(c.shelfHeaderFactory().shelfCarouselControlsFactory().shelfCarouselControlsPreviousFactory().hitUiReveal()):(e<0&&b||e>0&&!b)&&o.logInteraction(c.shelfHeaderFactory().shelfCarouselControlsFactory().shelfCarouselControlsNextFactory().hitUiReveal())}),[d,b,o,c]),R=(0,xa.t)(c);return(0,h.jsx)(Br.w,{className:up,ref:R,children:(0,h.jsxs)(fa.r,{spec:r,children:[(0,h.jsx)(Br.X,{children:i}),(0,h.jsxs)("div",{className:dp,style:{"--container-gap":"16px"},children:[0!==d&&(0,h.jsx)("button",{type:"button","aria-label":a,onClick:()=>k(-1),className:l()(pp,mp),children:b?(0,h.jsx)(qi.V,{}):(0,h.jsx)(Es.g,{})}),d<j&&(0,h.jsx)("button",{type:"button","aria-label":s,onClick:()=>k(1),className:l()(pp,gp),children:b?(0,h.jsx)(Es.g,{}):(0,h.jsx)(qi.V,{})}),(0,h.jsx)("ul",{ref:u,className:vp,dir:"auto",style:N,children:e.map((({trackOfVideo:e},t,i)=>{if("Track"!==e.data.__typename)return null;const{uri:n,name:a,albumOfTrack:s,artists:r,contentRating:o}=e.data;return(0,h.jsx)("li",{className:1===i.length?hp:xp,children:(0,h.jsx)(fa.r,{spec:c,children:(0,h.jsx)(op.O,{title:a,trackUri:n,artists:r.items,album:s,contentRating:o,referrerIdentifier:"now_playing_panel",index:t,hoverBackgroundColor:"backgroundTintedHighlight",contentAlign:!0,size:"sm"})})},n)}))})]})]})})}),{name:"NPVRelatedTrackVideos"}),fp=({item:e,spec:t})=>{const i=(0,s.NC)(pa.LX5),n=(0,s.NC)(pa.IA_),{loading:a,error:r,data:o}=(l={artistUri:e.artists[0].uri,trackUri:e.uri,enableCredits:n,enableRelatedVideos:i},c={gcTime:Dr,staleTime:Or},(0,Ar.I)(Ku,l,c));var l,c;const u=(0,s.NC)(pa.yux),d=ll(e),p=(0,s.NC)(pa.Tzx)?Nd:cd;if(a&&e.uri&&!r)return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Wc,{}),(0,h.jsx)(Wc,{}),(0,h.jsx)(Wc,{})]});if(!e.uri||"Artist"!==o?.artistUnion.__typename||"Track"!==o?.trackUnion.__typename||a||r)return null;const{profile:m,stats:g,visuals:v,profile:{externalLinks:x}}=o.artistUnion,{credits:y}=o.trackUnion;return(0,h.jsxs)(h.Fragment,{children:[u&&(0,h.jsx)(Kd,{item:e}),(0,h.jsxs)(fa.r,{spec:t,children:[o.trackUnion.relatedVideos&&"RelatedVideoPage"===o.trackUnion.relatedVideos.__typename&&o.trackUnion.relatedVideos.items.length>0&&(0,h.jsx)(bp,{contextUri:e.uri,relatedVideos:o.trackUnion.relatedVideos.items}),(0,h.jsx)(p,{artistUri:o.artistUnion.uri,artist:m,stats:g,visuals:v,externalLinks:x.items}),n&&y&&(0,h.jsx)(Pd,{data:y,trackUri:e.uri}),(0,h.jsx)(ap,{artistId:o.artistUnion.id,data:o.artistUnion.goods.events.concerts}),(0,h.jsx)(Xd,{artistId:o.artistUnion.id,artistUri:o.artistUnion.uri,merch:o.trackUnion.merch.items}),d&&(0,h.jsx)(cl,{item:e})]})]})},jp=({item:e,spec:t})=>(0,mt.n)()&&e.artists[0].uri?(0,h.jsx)(fp,{item:e,spec:t}):(0,h.jsx)(h.Fragment,{});var Cp=i(45640);const wp=({item:e,spec:t})=>(0,oc.v)(e)&&!e.isLocal?(0,h.jsx)(jp,{item:e,spec:t}):(0,oc.v)(e)&&e.isLocal?(0,h.jsx)(Yu,{}):(0,rc.p)(e)?(0,h.jsx)(Gu,{item:e,spec:t}):(0,sc.d)(e)?(0,h.jsx)(vr,{}):(0,Cp.N)(e)?(0,h.jsx)(gr,{}):null;var Sp=i(87445),Np=i(42452),kp=i(1729),Rp=i(24648);const Ip=(0,sr.mc)((()=>{const e=(0,n.useContext)(Ue.s),t=(0,Sp.a)({tryAvoidGraphQLFetching:!1}),i=(0,s.NC)(pa.yJ8)===pa.NtL.CANVAS_PLAY_ON_HOVER;return t?.canvas&&e?(0,h.jsx)(Rp.Gg,{fileId:t.canvas.fileId,canvasUrl:t.canvas.url,canvasType:t.canvas.type,canvasUri:t.canvas.uri,playerContainerClass:"canvasVideoContainerNPV",playbackType:i?Rp.RT.LoopOnHover:Rp.RT.LoopOnPlayback,allowAspectRatioFix:!0,mouseHoverRef:e,useContainerMouseOverEvents:!1}):null}),{name:"NPVCanvas"});var Ep=i(37970),Lp=i(66810),Tp=i(9675),Ap=i(73145),Pp=i(8541),Dp=i(84889),Op=i(39235),_p=i(41436),Up=i(37375),Bp=i(17566);const Fp="main-nowPlayingView-nowPlayingWidget",Mp="T5_sYfKJ2efL3n3dFNuN",Hp="main-nowPlayingView-nowPlayingGrid",Vp="main-nowPlayingView-contextItemInfo",qp="hhFdIYRyHsqlCHy7T_8A",zp="O5NOY8Xw4NH0IhBZu8tm",Qp="DFvRASpHOFAoziM4w7En",Gp="main-nowPlayingView-coverArtContainer",Yp="hjyiWzPtKHn_5kCe9vyg",Kp="hCImOEZCJwYaSy2r1Xgx",Zp="ylBRlfNqGnzVa4kjUQGP",Wp="E08D6ucrHuPJYzzGO7HG",Xp="pUIBQ9cykHKYx2A2ZIPA",Jp="_q9LkNJJIpxoOkOFI2Nd",$p="S6W0kreMgaIXYWSEYHya",em="main-nowPlayingView-trackInfo",tm="eEiwEPDfVRD0HKjYM_dq",im=({item:e,spec:t})=>{const i=(0,te.s)(),a=(0,n.useCallback)((n=>{const a=n?t.heartButtonFactory().hitLike({itemToBeLiked:e.uri}):t.heartButtonFactory().hitRemoveLike({itemNoLongerLiked:e.uri});i.logInteraction(a)}),[e.uri,i,t]),s=(0,Op.v)(e),r=(0,xi.y)();return s?(0,h.jsx)(Dp.g,{uri:e.uri,size:r===di.E.MEDIUM?"medium":"small",className:qp}):(0,oc.v)(e)&&!e.isLocal?(0,h.jsx)(Ap.b,{uri:e.uri,size:r===di.E.MEDIUM?Lp.t.sm:Lp.t.xs,onClick:a,className:qp}):(0,rc.p)(e)?(0,h.jsx)(Tp.b,{uri:e.uri,size:r===di.E.MEDIUM?Lp.t.sm:Lp.t.xs,onClick:a,className:qp,condensed:!0}):null},nm=({context:e,item:t})=>{const{spec:i,logger:n}=(0,Pe.r)(lr.J,{}),{spec:a}=(0,Pe.r)(Ep.p6,{data:{identifier:Ep.gw.DESKTOP}}),r=(0,Bp.X)(),o=(0,s.NC)(pa.$PN),c=(0,xi.y)();return(0,h.jsxs)(h.Fragment,{children:[o===pa.X$5.NPV_ALWAYS_VISIBLE||o===pa.X$5.NPV_VISIBLE_ON_HOVER?(0,h.jsx)(Pp.w,{className:o===pa.X$5.NPV_VISIBLE_ON_HOVER?Qp:zp,uri:t.uri,sharingInfo:null,interactionData:{intent:"share",type:"click"},condensedAll:!0,onClick:()=>{n.logInteraction(i.shareButtonFactory({uri:t.uri}).hitCopyToClipboard())},ariaLabel:(0,Cn.gHQ)(t.uri)?D.Ru.get("context-menu.copy-episode-link"):D.Ru.get("context-menu.copy-track-link"),size:c===di.E.MEDIUM?"medium":"small"}):null,(0,h.jsx)(_p.a,{context:e,item:t,className:l()(zp,Mp),onClick:()=>{n.logInteraction(a.hideButtonFactory().hitRemoveRecommendation({recommendedItemUri:t.uri,contextUri:e.uri}))}}),r&&(0,tc.N)(t)?(0,h.jsx)(fa.r,{spec:i,children:(0,h.jsx)("div",{className:zp,children:(0,h.jsx)(Up.o,{contextUri:t.metadata?.context_uri??e.uri,id:t.uid??void 0,uri:t.uri,isActive:!0})})}):(0,h.jsx)("div",{className:zp,children:(0,h.jsx)(im,{item:t,spec:i})})]})};var am=i(2732),sm=i(29507),rm=i(60472),om=i(64474);const lm="Z_lhw3kk_krs5GqxYAPn",cm=()=>{const{setVideoPlayerUIFlag:e}=(0,rm.d)(),{close:t}=(0,om.H)(),i=(0,n.useCallback)((()=>{e(lp.n.documentPip,!1),t()}),[t,e]);return(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:lm,children:[(0,h.jsx)(c.E,{variant:"bodySmall",children:D.Ru.get("web-player.now-playing-view.video.playing-in-pip")}),(0,h.jsx)(se.n,{onClick:i,size:"small",children:D.Ru.get("web-player.now-playing-view.video.return-playback")})]})})},um=()=>{const e=(0,Ae.v)(),{panelSend:t}=(0,j.AI)(m.Z.DevicePicker,m.Z.DevicePickerOverlay),i=(0,n.useCallback)((()=>{t(W.$S.DEVICE_PICKER_BUTTON_CLICK),(0,K.I)("DEVICE-PICKER"),e&&(t(W.$S.PUFFIN_BUTTON_CLICK),(0,K.I)("PUFFIN"))}),[e,t]);return(0,h.jsx)(se.n,{size:"small",onClick:i,children:D.Ru.get("web-player.connect.device-picker.select-another-device")})},dm=()=>{const{remoteDeviceName:e,connectionStatus:t}=(0,B.v)((e=>{const t=(0,U.V)(e);return{remoteDeviceName:t.remoteDevice?.name,connectionStatus:t.connectionStatus}}),F.a);let i="";return e&&t===Va.zP.CONNECTING?i=D.Ru.get("web-player.connect.bar.connecting-state",{device_name:e}):e&&t===Va.zP.CONNECTED&&(i=D.Ru.get("web-player.connect.bar.connected-state",{device_name:e})),(0,h.jsx)("div",{children:(0,h.jsxs)("div",{className:lm,children:[(0,h.jsx)(c.E,{variant:"bodySmall",children:i}),(0,h.jsx)(um,{})]})})};var pm=i(28889),mm=i(20372);const gm=(0,n.lazy)((()=>i.e(3562).then(i.bind(i,83562)))),vm=(0,n.lazy)((()=>i.e(9820).then(i.bind(i,9820))));let xm=function(e){return e[e.NONE=0]="NONE",e[e.COVER_ART=1]="COVER_ART",e[e.VIDEO_OVER_PIP_PLACEHOLDER=2]="VIDEO_OVER_PIP_PLACEHOLDER",e[e.VIDEO_OVER_CONNECT_PLACEHOLDER=3]="VIDEO_OVER_CONNECT_PLACEHOLDER",e[e.CANVAS=4]="CANVAS",e}({});const hm=()=>{const e=(0,mr.L)(),t=(0,U.l)(),{videoPlayerMode:i}=(0,rm.d)(),{isSongVideo:n,isSongVideoPlayingVideo:a}=(0,mm.k)(),s=(0,P.d4)((e=>e.ads?.vto)),{showCanvasInNPV:r}=(0,Sp.a)({tryAvoidGraphQLFetching:!0});if(!e)return xm.NONE;const{item:o}=e;return i===lp.K.documentPip||i===lp.K.pip?xm.VIDEO_OVER_PIP_PLACEHOLDER:o?.type===no.c.AD&&s?.isMinimized&&"audio"!==o?.mediaType?xm.NONE:o?.type!==no.c.EPISODE||"video"!==o?.mediaType&&"mixed"!==o?.mediaType?n&&a?t?xm.VIDEO_OVER_CONNECT_PLACEHOLDER:xm.NONE:r?xm.CANVAS:xm.COVER_ART:t?xm.VIDEO_OVER_CONNECT_PLACEHOLDER:xm.NONE},ym=(0,sr.mc)((({hideContextItemInfo:e=!1})=>{const t=(0,mr.L)(),i=hm(),{draggable:a,onDragStart:s}=(0,Jr.P)(),[r,o]=(0,n.useState)(!0),{spec:c,logger:u}=(0,Pe.r)(lr.J,{}),{isSongVideo:d}=(0,mm.k)(),p=i===xm.CANVAS,m=i===xm.COVER_ART,g=(0,n.useRef)(null),v=(0,n.useRef)(null),x=(0,n.useRef)(null),y=!(0,hi.j)(),[b,f]=(0,n.useState)(null);if(y&&p&&g.current&&x.current&&(f(x.current),setTimeout((()=>{f(null)}),600)),g.current=m,v.current=p,x.current=t,null===t)return null;const{context:j,item:C,index:w}=t,S="isPodcastAd"in C&&C.isPodcastAd&&C.metadata?.["podcast_ads.buttonMessage"]&&C.metadata?.["podcast_ads.tagline"];return(0,h.jsxs)("div",{className:l()(Fp),children:[(0,h.jsxs)("div",{className:Hp,children:[(0,h.jsxs)("div",{onClick:()=>p&&o(!r),className:l()(Gp,{[Yp]:p,[Kp]:m,[Xp]:r}),children:[(0,h.jsx)("div",{className:l()(Zp,{[Jp]:p}),"aria-hidden":p,children:(0,h.jsx)(am.h,{context:b?.context||j,item:b?.item||C,index:w,canSwitchVisuals:!0})}),i===xm.VIDEO_OVER_PIP_PLACEHOLDER&&(0,h.jsx)(cm,{}),i===xm.VIDEO_OVER_CONNECT_PLACEHOLDER&&(0,h.jsx)(dm,{}),(0,h.jsx)("div",{className:l()(Wp,{[$p]:!p}),"aria-hidden":"true",children:(0,h.jsx)(ia.h,{menu:(0,h.jsx)(pr.W,{context:j,item:C,canSwitchVisuals:!0}),children:(0,h.jsx)("div",{draggable:a,onDragStart:e=>{s(e,{itemUris:[C.uri],dragLabelText:(0,Np.r)(C)})},children:p&&(0,h.jsx)(Ip,{uri:C.uri})})})}),(0,h.jsx)(sm.F,{})]}),d&&(0,h.jsx)(pm.L,{className:p?tm:""}),e?null:(0,h.jsxs)("div",{className:Vp,children:[(0,h.jsx)(Qo.d,{className:l()(em),context:j,item:C,titleTypeVariant:"titleSmall",subtitleTypeVariant:"bodyMedium",onTitleClick:e=>{u.logInteraction(c.titleFactory({uri:C.uri}).hitUiNavigate({destination:e||""}))},onSubtitleClick:e=>{u.logInteraction(c.artistFactory({uri:C.uri}).hitUiNavigate({destination:e||""}))},referrer:kp.G.NPV}),(0,Cp.N)(C)?S?null:(0,h.jsx)(n.Suspense,{fallback:!0,children:(0,h.jsx)(gm,{item:C,onCtaClick:e=>{u.logInteraction(c.titleFactory({uri:C.uri}).hitUiNavigate({destination:e||""}))}})}):(0,h.jsx)(nm,{context:j,item:C})]})]}),S&&(0,h.jsx)(n.Suspense,{fallback:!0,children:(0,h.jsx)(vm,{item:C,onCtaClick:e=>{u.logInteraction(c.titleFactory({uri:C.uri}).hitUiNavigate({destination:e||""}))}})})]})}),{name:"NPVHeader"});var bm=i(57279),fm=i(42101),jm=i(65819);const Cm={context:null,item:null};var wm=i(3217),Sm=i(20969),Nm=i(65234),km=i(66641),Rm=i(97020),Im=i(91950);const Em="yvZooOj0rpfRS__cAUCo",Lm="k_ndsg7yz9ZAgEmei1n3",Tm="vDev2BqBHloweL24GNHK",Am="IkRGajTjItEFQkRMeH6v",Pm="f2UE9n5nZcbgZrGYTU3r",Dm="nw2W4ZMdICuBo08Tzxg9",Om="UAg2mNxhAm_jv0zFjG8z",_m="VjVlpyxDo941sgO2Vc8g",Um=(0,n.lazy)((()=>Promise.all([i.e(4151),i.e(7811)]).then(i.bind(i,17811))));function Bm(e){return(0,oc.v)(e)||(0,Im.v)(e)||(0,rc.p)(e)||(0,sc.d)(e)?e.name:(0,Cp.N)(e)?"":(0,mn.d)(e)}const Fm=n.memo((({item:e,spec:t})=>{const{ref:i,breakpoint:n}=(0,pn.x)({[di.E.XSMALL]:0,[di.E.SMALL]:280,[di.E.MEDIUM]:320});return(0,h.jsx)("div",{className:Dm,"data-testid":"NPV_Panel_OpenDiv",ref:i,children:e&&(0,h.jsxs)(xi.o.Provider,{value:n,children:[(0,h.jsx)(ym,{}),(0,h.jsx)(wp,{item:e,spec:t}),!(0,rc.p)(e)&&(0,h.jsx)(Pc,{})]})})})),Mm=({context:e,item:t,spec:i,currentPanel:a})=>{const s=(0,Nm.v7)();(0,n.useEffect)((()=>{s.current&&(s.current.scrollTop=0)}),[t?.uri,s]);return a===m.Z.NowPlayingView?(0,Cc.bJ)(e,t)?(0,h.jsx)(wm.IT,{spec:i}):(0,h.jsx)(Fm,{currentPanel:a,context:e,item:t,spec:i}):(0,h.jsx)("div",{"data-testid":"NPV_Panel_ClosedDiv"})},Hm=({context:e,item:t,spec:i,currentPanel:n})=>(0,Bn.S)()===Un.z.NOW_PLAYING_VIEW?null:(0,h.jsx)(Mm,{currentPanel:n,context:e,item:t,spec:i}),Vm=()=>hm()===xm.CANVAS,qm=({item:e})=>{const t=(0,n.useRef)(null),i=(0,mr.L)(),{title:a,link:r}=(0,Sm.g)(),o=Vm(),c=(0,dr.l)(),u=(0,s.NC)(pa.mzn),{spec:d,logger:g}=(0,Pe.r)(lr.J,{}),v=(0,n.useCallback)((()=>{const e=d.closeButtonFactory().hitUiHide();g.logInteraction(e)}),[d,g]);return(0,n.useEffect)((()=>{null!==t.current&&t.current.focus()}),[]),(0,h.jsx)(p.a,{title:a,titleSlot:(0,h.jsx)(p.k,{title:a,panelLinkRef:t,item:e,link:r,variant:"bodyMediumBold",semanticColor:"textBase",className:Lm}),link:r,actions:i&&i.context&&(0,h.jsxs)("div",{className:u?Om:_m,children:[(0,h.jsx)(sa.b,{menu:(0,h.jsx)(pr.W,{context:i.context,item:e,canSwitchVisuals:!0}),children:(0,h.jsx)(ur.e,{size:"small",condensed:!1,label:D.Ru.get("more.label.context",e?Bm(e):""),onClick:()=>{g.logInteraction(d.contextMenuButtonFactory().hitUiReveal())}})}),u&&(0,h.jsx)(re.H,{iconOnly:rr.L,size:"small",onClick:()=>{c(Un.z.NOW_PLAYING_VIEW)},"aria-label":"Expand"})]}),panelLinkRef:t,panel:m.Z.NowPlayingView,onClose:v,item:e,className:l()({[Em]:o})})},zm=({item:e})=>{const t=(0,cr.w)(e);return(0,n.useMemo)((()=>t?null:(0,h.jsx)(qm,{item:e})),[e,t])},Qm=(0,sr.mc)((({nodeRef:e,currentPanel:t})=>{const{context:i,item:n,index:a}=(0,mr.L)()||{context:null,item:null,index:null},{spec:r,UBIFragment:o}=(0,Pe.r)(or.t,{data:{uri:n?n.uri:""}}),c=Vm(),u=(0,cr.w)(n),d=(0,xa.t)(r),p=(()=>{const{item:e}=(0,mr.L)()||Cm,{isYourDJNarrator:t}=(0,fm.CV)(),i=(0,s.NC)(pa.yon),n=(0,jm.z)(e?.images?.[0]?.url,Su.l0o,"colorDark");return t?bm.Ym:i?n:void 0})(),m={"--background-base":p,"--section-background-base":p?"var(--background-tinted-base)":"var(--background-elevated-base)"};return(0,h.jsx)(Rm.P,{surface:km.u.NOW_PLAYING,children:(0,h.jsx)(Nm.ql.Provider,{value:"now_playing_panel",children:(0,h.jsx)(Ue._,{nodeRef:e,label:D.Ru.get("web-player.now-playing-view.label"),style:m,itemUri:n?.uri?n.uri:"","data-testid":"now-playing-view-container",className:"NowPlayingView",children:(0,h.jsx)(o,{spec:r,children:(0,h.jsx)(Be.w,{className:l()(Am,{[Pm]:void 0!==p}),fixedHeader:(0,h.jsx)(zm,{item:n}),scrolledClassName:c?Tm:void 0,ref:d,children:u?(0,h.jsx)(Um,{item:n,context:i,index:a,currentPanel:t}):(0,h.jsx)(Hm,{spec:r,currentPanel:t,context:i,item:n})})})})})})}),{name:"NPV"}),Gm="vzeIlCPBQJUaqdMZHqHE",Ym="iZgGvu9g2gDlQ1ofJ7rH",Km="FSZKuoSTDgGwCPXO_qel",Zm="cPpNQwPTiEn9Zegl5Dwz",Wm="p2Yw6bT_O5PW8yGv1R0X",Xm="pK7G3_mtRcuFjbhJzm1s",Jm="gVJxtuXo8lHAw8XLKHfQ",$m="BR3H6wavkReGa2xeSeaV",eg="vXYSi4u1nPutJ_ZkC6mq",tg=e=>{const t=(0,n.useRef)(null);return(0,h.jsx)(a.A,{in:e.isActive,nodeRef:t,timeout:{enter:e.shouldPlayAnimation?200:0,exit:e.shouldPlayAnimation?300:0},classNames:{enter:e.shouldPlayAnimation?Ym:Xm,enterActive:e.shouldPlayAnimation?Km:Jm,exit:e.shouldPlayAnimation?Zm:$m,exitActive:e.shouldPlayAnimation?Wm:Jm},unmountOnExit:!0,mountOnEnter:!0,children:(0,h.jsx)("div",{className:Gm,children:(0,h.jsx)("div",{className:eg,ref:t,children:e.children})})})};var ig=i(55365),ng=i(29262),ag=i(3645),sg=i(51161),rg=i(16052),og=i(96144),lg=i(3813),cg=i(34002),ug=i(78582),dg=i(34622);const pg="PddBvUOS0_6f9B21fVGF",mg=({ariaLabel:e,onRemoveItems:t,nrItems:i,columnCount:a,children:s})=>{const r=(0,n.useRef)(null);(0,ug.g)(r);const o=(0,dg.d)(t);return(0,h.jsx)(cg.R,{firstInteractiveIsWrapper:!0,"aria-label":e,"aria-rowcount":i,"aria-colcount":a,className:pg,ref:r,onKeyDown:o,children:s})},gg=({items:e,renderRow:t,...i})=>{const a=(0,n.useCallback)(((t,i)=>e.slice(t,i+1)),[e]);return(0,h.jsx)(fl.k,{resolveItem:vg,getItems:a,nrTracks:e.length,children:(0,h.jsx)(mg,{nrItems:e.length,...i,children:e.map(t)})})};function vg(e){return{uri:e.uri,uid:e.uid??void 0,type:e.type}}var xg=i(93336),hg=i(74101);const yg=({chapter:e,index:t,showTypeLabel:i,...n})=>{const{uid:a,uri:s,type:r,name:o,images:l,book:c}=e,u=vl(e,t),d=dc(n.section),p=(0,h.jsx)(hg.r,{uri:s,removeFromQueueData:{uid:a??void 0,contextUri:d}}),m=(0,h.jsx)(cc,{item:e,tooltipText:c.name,showTypeLabel:i,subtitle:(0,h.jsx)(ia.h,{menu:(0,h.jsx)(xg.p,{uri:c.uri}),children:(0,h.jsx)(Me.N,{to:c.uri,stopPropagation:!0,children:c.name})})});return(0,h.jsx)(Wl,{uid:a,uri:s,contextUri:d,id:u,index:t,type:r,title:o,subtitle:m,images:l,dragLabel:o,menu:p,moreButtonLabelName:o,ariaPauseLabel:D.Ru.get("playlist.a11y.pause",o),ariaPlayLabel:D.Ru.get("playlist.a11y.play",o),...n})};var bg=i(67674),fg=i(56373),jg=i(54628),Cg=i(84882);const wg=(0,n.createContext)(null),Sg=({children:e})=>{const{uri:t}=(0,Cg.H)(),{spec:i,UBIFragment:a}=(0,Pe.r)(fg.i,{data:{identifier:jg.$h.NOWPLAYING_QUEUE,uri:t??""}}),s=(0,n.useMemo)((()=>i.nowPlayingSectionFactory()),[i]),r=(0,n.useMemo)((()=>i.nextInQueueSectionFactory()),[i]),o=(0,n.useMemo)((()=>i.nextFromSectionFactory()),[i]),l=(0,n.useMemo)((()=>({queueSpec:i,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o})),[i,s,r,o]);return(0,h.jsx)(wg.Provider,{value:l,children:(0,h.jsx)(a,{spec:i,children:e})})};var Ng=i(104);const kg=()=>{const e=(0,n.useContext)(wg);if(!e)throw Error("useQueueUBI must be used within a QueuePanelUBIProvider!");const{queued:t}=(0,Cg.H)(),i=(0,te.s)(),{queueSpec:a,nowPlayingSectionSpec:s,nextInQueueSectionSpec:r,nextFromSectionSpec:o}=e;return{logClearQueue:(0,n.useCallback)((()=>{const e=r.clearQueueButtonFactory().hitRemoveItemsFromQueue({numberOfItemsToRemoveFromQueue:t.length});return i.logInteraction(e)}),[i,r,t.length]),logAddToQueue:(0,n.useCallback)(((e,t)=>{let n;switch(e){case uc.$.NowPlaying:n=s;break;case uc.$.NextInQueue:n=r;break;case uc.$.NextUp:n=o;break;default:return}const a=1===t.length?n.dragAddItemToQueue({itemToAddToQueue:t[0]}):n.dragAddItemsToQueue({numberOfItemsToAddToQueue:t.length});return i.logInteraction(a)}),[i,o,r,s]),logSort:(0,n.useCallback)((e=>{let t;switch(e){case uc.$.NextInQueue:t=r;break;case uc.$.NextUp:t=o;break;case uc.$.NowPlaying:default:return}const n=t.dragSort();return i.logInteraction(n)}),[i,o,r]),logQueuePanelTabChange:(0,n.useCallback)((e=>{if(e!==Ng.p.PARTICIPANT_LIST){const t=a.queueHistoryTabFactory({identifier:e===Ng.p.QUEUE?"queue":"recently_played"}).hitUiReveal();return i.logInteraction(t)}}),[i,a]),logQueueContextLinkNavigate:(0,n.useCallback)((e=>{const t=o.queueContextLinkFactory().hitUiNavigate({destination:e??""});return i.logInteraction(t)}),[i,o])}};var Rg=i(95129);const Ig=(0,n.memo)((function({item:e,...t}){const i=function(e,t){const i=(0,C.z)(),{request:a}=(0,n.useContext)(_r.j),{logAddToQueue:s,logSort:r}=kg();return(0,n.useCallback)((async(n,o,l)=>{const{contextUri:c,sectionId:u,itemIds:d}=l??{},p=t===uc.$.NowPlaying,m=Gl===c&&!p,g=n[bg.fl.ALBUMS]?.at(0),v=Object.values(n).flat();let x=[];if(g){const{trackUris:e}=await(0,Rg.s)(g,0,a);x=e.map((e=>({uri:e,uid:null})))}else x=m&&d?.length?d.map((e=>({uri:"",uid:e}))):Object.values(n).flat().map((e=>({uri:e,uid:null})))??[];const h=m&&u===uc.$.NowPlaying;let y;if(y=o===yl.Nz.BEFORE?{before:{uri:e.uri,uid:e.uid??null}}:{after:{uri:e.uri,uid:e.uid??null}},m&&!h)t&&r(t),i.reorderQueue(x,y);else{let e;t&&(e=s(t,v)),p?i.addToQueue(x,{interactionId:e?.interactionId}):i.insertIntoQueue(x,y,{interactionId:e?.interactionId})}}),[e.uid,e.uri,s,r,i,a,t])}(e,t.section);switch(e.type){case no.c.TRACK:return(0,h.jsx)(yc,{track:e,onDrop:i,...t});case no.c.EPISODE:return(0,h.jsx)(pc,{episode:e,onDrop:i,...t});case no.c.CHAPTER:return(0,h.jsx)(yg,{chapter:e,onDrop:i,...t});case no.c.AD:return(0,h.jsx)(Xl,{ad:e,onDrop:i,...t});case no.c.UNKNOWN:return null;default:return(0,mn.k)(e),null}})),Eg=(0,n.memo)((function({item:e,...t}){const{usePlayContextItem:i}=(0,co.P)({uri:e.uri,pages:[{items:[e]}]},{featureIdentifier:"history"});return(0,h.jsx)(Ig,{item:e,...t,usePlayContextItem:i})})),Lg=({items:e})=>{const t=(0,n.useCallback)(((e,t)=>(0,h.jsx)(Eg,{item:e,index:t},vl(e,t))),[]);return(0,h.jsx)(gg,{items:e,ariaLabel:D.Ru.get("view.recently-played"),renderRow:t,columnCount:3})};var Tg=i(21070),Ag=i(24541);const Pg=()=>{const{isLoading:e,data:t}=(0,Ag.a)();return e?null:t?.items.length?(0,h.jsx)(Lg,{items:t.items}):(0,h.jsx)(Tg.H,{})};var Dg=i(68832);const Og=(e,t)=>!t?.didQueueChangeSignificantly,_g=(e,t,i)=>{Og(0,i?.current)?(0,Dg.oz)({onUpdate:t=>{e.style.opacity=t.toString()}}):e.style.opacity="1"},Ug=(e,t,i,n)=>{Og(0,n?.current)?(0,Dg.oz)({onUpdate:t=>{e.style.opacity=(1-Number(t)).toString()},onComplete:i}):i()},Bg=({hideEnteringElements:e,animateEnteringElements:t,animateExitingElements:i,animateFlippedElements:n})=>{e(),i(),n(),t()};var Fg=i(8741);function Mg(e){const t=(0,n.useRef)(e);return(0,n.useMemo)((()=>{const i=new Map,n=Vg(t.current,i),a=Vg(e,i),s=(0,Fg.I)(n,a),r=s>16||s>=Math.max(Hg(e),Hg(t.current));return t.current=e,r}),[e])}function Hg(e){return Number(!!e?.current)+(e?.queued.length??0)+(e?.nextUp.length??0)}function Vg({current:e,nextUp:t=[],queued:i=[]},n){let a="";return[[e],t,i].forEach((e=>{e.forEach((e=>{e?.uid&&(n.has(e.uid)||n.set(e.uid,String.fromCharCode(65+n.size)),a+=n.get(e.uid))})),e.length&&(a+=" ")})),a}function qg(){const e=(0,hi.j)(),t=(0,s.NC)(pa.J9c);return!e&&t}var zg=i(10058);const Qg=({current:e,queued:t,nextUp:i,children:a})=>{const s=(0,n.useMemo)((()=>[e,...t,...i].filter(zg.P).map(vl).join("")),[e,i,t]),r={didQueueChangeSignificantly:Mg({current:e,nextUp:i,queued:t})};return(0,h.jsx)(Dg.ZI,{flipKey:s,handleEnterUpdateDelete:Bg,decisionData:r,children:a})},Gg=({children:e,...t})=>qg()?(0,h.jsx)(Qg,{...t,children:e}):(0,h.jsx)("div",{children:e}),Yg=({children:e,...t})=>qg()?(0,h.jsx)(Dg.lf,{shouldFlip:Og,...t,children:e}):(0,h.jsx)(h.Fragment,{children:e}),Kg=[bg.fl.TRACKS,bg.fl.LOCAL_TRACKS,bg.fl.EPISODES,bg.fl.CHAPTERS,bg.fl.ALBUMS],Zg=({uri:e,items:t,ariaLabel:i,section:a,showTypeLabel:s,decoratedQueuedByUsersByUsername:r})=>{const o=(0,C.z)(),l=(0,n.useCallback)((e=>{o.removeFromQueue(e)}),[o]),{usePlayContextItem:c}=jc(e,a),u=(0,n.useCallback)(((e,t)=>{const i=vl(e,t);return(0,h.jsx)(Yg,{flipId:e.metadata?.original_uid??i,onAppear:_g,onExit:Ug,translate:!0,children:(0,h.jsx)("div",{className:Sl,children:(0,h.jsx)(Ig,{item:e,index:t,usePlayContextItem:c,section:a,allowedDropMimeTypes:Kg,showTypeLabel:s,queuedBy:r?.[e.metadata?.queued_by??""]})})},i)}),[r,a,s,c]);return(0,h.jsx)(gg,{items:t,renderRow:u,columnCount:3,ariaLabel:i,onRemoveItems:l})};var Wg=i(15405);const Xg="u842BXnznGeq38O3DUTQ",Jg="NWVZ_rxlezZ8xTHlMg4Y",$g="Oae51evvT5DrqTupCiZ2",ev="LFdMliaHVgrpBcqNKHU3",tv="IeeqYq0Ozrndd6STmrRk",iv="NljerwmGshDHsI7rIvWl",nv=({nrQueuedItems:e})=>{const t=(0,C.z)(),{logClearQueue:i}=kg(),[a,s]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>{s(!1)}),[]),o=(0,n.useCallback)((()=>{i(),t.clearQueue(),s(!1)}),[i,t]),l=(0,n.useCallback)((()=>{s(!0)}),[]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(re.H,{size:"small",onClick:l,className:tv,condensed:!0,children:D.Ru.get("queue.clear-queue")}),(0,h.jsx)(Wg.p,{itemCount:e,isOpen:a,onClose:r,onConfirm:o})]})};var av=i(10871);const sv=({queueSection:e,title:t,trailingButton:i})=>{const a=(0,n.useRef)(null),s=(0,av.K)({ref:a});return(0,h.jsx)(Yg,{flipId:`section-header-${e}`,onAppear:_g,onExit:Ug,translate:!0,children:(0,h.jsxs)("div",{className:ev,children:[(0,h.jsx)(na.Zp,{label:t,disabled:!s,children:(0,h.jsx)(c.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textBase",className:iv,ref:a,children:t})}),i]})})};var rv=i(64542);const ov=new Tr.l("decorateQueuedByUsers","query","1b71b9895bad207fdac0df7ebad17c790260519f853a069ee05f20e51c08636e",null);function lv(e){const{currentSession:t}=(0,zs.D)(),i=Array.from(new Set(e.map((e=>e?.metadata?.queued_by||null)).filter(zg.P))).sort().map((e=>(0,Cn.Qjr)(e).toURI())),{data:a}=(s={userUris:i},r={gcTime:36e5,staleTime:18e5,enabled:!!i.length,placeholderData:Ia.rX},(0,Ar.I)(ov,s,r));var s,r;const o=(0,n.useMemo)((()=>Object.fromEntries(a?.users?.map((e=>{return"User"===e.__typename?[e.username,(t=e,{type:no.c.USER,...t,images:t.avatar?.sources??[]})]:null;var t})).filter(zg.P)??[])),[a]);return t?.active?o:{}}var cv=i(33240),uv=i(65260);const dv=()=>{const e=(0,Cg.H)(),{uri:t,description:i,current:a,nextUp:s,queued:r,isEmpty:o,hasQueuedTracks:l,hasNextTracks:c}=e,{logQueueContextLinkNavigate:u}=kg(),d=lv([a,...s,...r]),p=(0,n.useMemo)((()=>new Set([a,...r,...s].filter(zg.P).map((({type:e})=>e))).size>1),[a,s,r]),{currentSession:m}=(0,zs.D)(),g=(0,Vs.y)();return o?(0,h.jsx)(rv.K,{}):(0,h.jsxs)(Gg,{...e,children:[(0,h.jsx)(cv.Z,{className:$g}),(0,h.jsxs)("div",{className:Xg,children:[a&&(0,h.jsxs)("div",{className:Jg,children:[(0,h.jsx)(sv,{queueSection:uc.$.NowPlaying,title:D.Ru.get("queue.now-playing")}),(0,h.jsx)(Zg,{ariaLabel:D.Ru.get("queue.now-playing"),uri:t,items:a?[a]:[],section:uc.$.NowPlaying,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),!m?.active&&g&&(0,h.jsx)(uv.p,{localStorageKey:"dismissStartJamButtonFromQueue"}),l&&(0,h.jsxs)("div",{className:Jg,children:[(0,h.jsx)(sv,{queueSection:uc.$.NextInQueue,title:D.Ru.get("queue.next-in-queue"),trailingButton:(0,h.jsx)(nv,{nrQueuedItems:r.length})}),(0,h.jsx)(Zg,{ariaLabel:D.Ru.get("queue.next-in-queue"),uri:t,items:r,section:uc.$.NextInQueue,showTypeLabel:p,decoratedQueuedByUsersByUsername:d})]}),c&&(0,h.jsxs)("div",{className:Jg,children:[(0,h.jsx)(sv,{queueSection:uc.$.NextUp,title:i&&!(0,Cg.K)(a)&&t?(0,h.jsxs)(h.Fragment,{children:[D.Ru.get("queue.next-from")," ",(0,h.jsx)(Me.N,{to:t,onClick:()=>{u(t)},children:i})]}):D.Ru.get("queue.next-up")},i),(0,h.jsx)(Zg,{ariaLabel:D.Ru.get("queue.next-up"),uri:t,items:s,section:uc.$.NextUp,showTypeLabel:p})]})]})]})};var pv=i(55795),mv=i(12344);const gv="AjjTyUrCO3pZ365KtTXW",vv="pGtUoenc5OobLi8CscJ6",xv="cArVcLcQ85q_9QSLGYGX",hv="lDtXv1VCrs0PHHSuH5uO",yv="ukjUoaLSzKyRcwoOQw9V",bv="yQwBNeetmAr0a0OTR8t3",fv="fzB4RXxTp0rlpNQlSuu9",jv=({sessionMember:e,showRemoveButton:t,onClickMember:i,onClickRemove:n,index:a})=>{const{currentSession:s}=(0,zs.D)(),{displayName:r,images:o,username:l,uri:c}=(0,mv.c)(e);return(0,h.jsx)(ia.h,{menu:(0,h.jsx)(Ml.B,{uri:c}),children:(0,h.jsx)(V.v,{id:`${a}`,variant:"naked",className:yv,title:(0,h.jsx)(we.d,{lineClamp:1,children:r}),media:(0,h.jsx)("div",{role:"button",onClick:i,onKeyDown:i,tabIndex:-1,children:(0,h.jsx)(Fl.e,{images:o,userIconSize:"medium",width:48,displayName:r,username:l,label:r})}),subtitle:s?.sessionOwnerId===e.id?D.Ru.get("web-player.social-connect.participant-list.host"):D.Ru.get("web-player.social-connect.participant-list.guest"),onClick:i,trailing:t&&(0,h.jsx)(se.n,{size:"small",className:bv,onClick:n,"aria-label":D.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:D.Ru.get("web-player.social-connect.participant-list.remove-guest")})})})};var Cv=i(11330),wv=i(14998),Sv=i(15477);const Nv=()=>{const e=(0,La.d)(),t=(0,P.wA)(),i=(0,Kr.Zp)(),a=(0,Cv.Z)(),{currentSession:s,kickAllParticipants:r}=(0,zs.D)(),{setQueueView:o}=(0,pv.m)(),{logUserClick:l,logRemoveClick:u}=(0,wv.T)(),p=(0,n.useCallback)((()=>{s?.joinSessionShortLink&&a(s?.joinSessionShortLink)}),[a,s?.joinSessionShortLink]),m=(0,n.useCallback)(((e,i)=>{u(e),t((0,ta.A9)(Ra.EL.REMOVE_PARTICIPANT,void 0,i))}),[t,u]),g=(0,n.useCallback)(((e,t)=>{const n=(0,Cn.Qjr)(t.username);l(e,n.toURI()),i(n.toURLPath(!0))}),[l,i]),v=(0,n.useCallback)((()=>{r(s?.sessionId)}),[s?.sessionId,r]),x=(0,Sv.T4)(e);return s&&x?(0,h.jsxs)("div",{className:gv,children:[(0,h.jsx)(c.E,{variant:"titleSmall",semanticColor:"textBase",children:D.Ru.get("web-player.social-connect.participant-list.title")}),(0,h.jsxs)("div",{className:vv,children:[(0,h.jsx)(c.E,{variant:"bodySmall",semanticColor:"textSubdued",children:D.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,h.jsx)(se.n,{size:"small",onClick:p,className:xv,children:D.Ru.get("web-player.social-connect.invite-button")})]}),(0,h.jsx)("div",{className:hv,children:s.sessionMembers.map(((t,i)=>(0,h.jsx)(jv,{index:i,sessionMember:t,showRemoveButton:(0,Sv.kt)(e,(0,Cn.Qjr)(t.username).toURI()),onClickRemove:()=>m(i,t),onClickMember:()=>g(i,t)},i)))}),s.isSessionOwner&&s.sessionMembers.length>1&&(0,h.jsx)(d.$,{colorSet:"invertedLight",size:"small",onClick:v,children:D.Ru.get("web-player.social-connect.participant-list.remove-all-guests")}),(0,h.jsx)(c.E,{variant:"marginal",semanticColor:"textSubdued",className:fv,children:D.Ru.get("web-player.social-connect.participant-list.visibility-info")})]}):(o(pv.p.QUEUE),null)};var kv=i(18390);const Rv="BZj_r1yzmmragvivUCrw",Iv="hpzTKCoO0rllEslIOMPo",Ev="TeBVsFnI9PMHYL9ynJx9",Lv="ZDR7q1cqU2yaYjemuy9Z",Tv="OLB2ghxc09Kz8k_93eIu",Av=()=>{const{currentQueueView:e,setQueueView:t}=(0,Ng.m)(),i=(0,kv.y)(),{logQueuePanelTabChange:a}=kg(),s=(0,n.useMemo)((()=>i?{titleSlot:e!==Ng.p.PARTICIPANT_LIST?(0,h.jsx)(sg.t,{currentTab:e,onTabChange:e=>{e===(0,og.c)(Ng.p.HISTORY)?(a(Ng.p.HISTORY),t(Ng.p.HISTORY)):(a(Ng.p.QUEUE),t(Ng.p.QUEUE))},className:Ev,children:(0,h.jsxs)(rg.w,{"aria-label":"",className:Lv,children:[(0,h.jsx)(og.V,{"aria-selected":e===Ng.p.QUEUE,label:D.Ru.get("playback-control.queue"),value:Ng.p.QUEUE}),(0,h.jsx)(og.V,{"aria-selected":e===Ng.p.HISTORY,label:D.Ru.get("view.recently-played"),value:Ng.p.HISTORY})]})}):(0,h.jsx)(re.H,{iconLeading:Es.g,onClick:()=>t(Ng.p.QUEUE),size:"small",condensed:!0,className:Tv,children:D.Ru.get("web-player.social-connect.participant-list.back-to-queue")})}:{title:D.Ru.get("playback-control.queue")}),[i,a,t,e]);return(0,h.jsx)(Ue._,{label:D.Ru.get("playback-control.queue"),focusTransferId:"QUEUE-HISTORY-PANEL",children:(0,h.jsx)(Be.w,{fixedHeader:(0,h.jsx)(p.a,{className:Rv,panel:m.Z.Queue,...s}),children:(0,h.jsx)("div",{className:Iv,children:e!==Ng.p.PARTICIPANT_LIST?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(lg.K,{value:"queue",children:e===Ng.p.QUEUE&&(0,h.jsx)(dv,{})}),(0,h.jsx)(lg.K,{value:"history",children:e===Ng.p.HISTORY&&(0,h.jsx)(Pg,{})})]}):(0,h.jsx)(Nv,{})})})})},Pv=(0,n.memo)((function(){return(0,h.jsx)(Sg,{children:(0,h.jsx)(Av,{})})}));var Dv=i(17702);const Ov=(0,n.memo)((()=>{const e=(0,ng.X)(),t=(0,ig._)(),i=function(){const e=(0,n.useRef)(m.Z.NowPlayingView),t=(0,j.XB)();return(0,n.useEffect)((()=>{e.current=t}),[t]),(0,n.useCallback)((i=>{const n=e.current===m.Z.NowPlayingView,a=t===m.Z.NowPlayingView;return i.some((i=>n&&t===i||a&&e.current===i))}),[t])}(),o=(0,Bn.S)()===Un.z.NOW_PLAYING_VIEW,l=(0,n.useRef)(null),c=(0,s.NC)(pa.t84)?Rn:_n;return(0,h.jsxs)(r.s,{onError:e=>{(0,Dv.Jy)(e,"PanelSection"),t((0,ag.MQ)(m.Z.Disabled))},children:[(0,h.jsx)(a.A,{nodeRef:l,in:e===m.Z.NowPlayingView,timeout:{enter:0,exit:e===m.Z.Disabled?0:300},unmountOnExit:!0,mountOnEnter:!0,children:(0,h.jsx)(Qm,{nodeRef:l,currentPanel:m.Z.NowPlayingView})}),e===m.Z.BuddyFeed?(0,h.jsx)(c,{}):null,(0,h.jsx)(tg,{isActive:e===m.Z.BuddyFeedOverlay,shouldPlayAnimation:!o&&i([m.Z.BuddyFeedOverlay]),children:(0,h.jsx)(c,{})}),e===m.Z.Queue?(0,h.jsx)(Pv,{}):null,(0,h.jsx)(tg,{isActive:e===m.Z.QueueOverlay,shouldPlayAnimation:!o&&i([m.Z.QueueOverlay]),children:(0,h.jsx)(Pv,{})}),e===m.Z.Puffin||e===m.Z.PuffinActivation?(0,h.jsx)(xn,{}):null,(0,h.jsx)(tg,{isActive:e===m.Z.PuffinActivationOverlay||e===m.Z.PuffinOverlay,shouldPlayAnimation:!o&&i([m.Z.PuffinActivationOverlay,m.Z.PuffinOverlay]),children:(0,h.jsx)(xn,{})}),e===m.Z.DevicePicker?(0,h.jsx)(ar,{}):null,(0,h.jsx)(tg,{isActive:e===m.Z.DevicePickerOverlay,shouldPlayAnimation:!o&&i([m.Z.DevicePickerOverlay]),children:(0,h.jsx)(ar,{})})]})}))},68376:(e,t,i)=>{i.d(t,{_:()=>m,s:()=>p});var n=i(30758),a=i(97500),s=i.n(a),r=i(23369),o=i(80762),l=i(17186);const c="ffFwfKcPDbmAPLXzxzKq",u="nZaXB942idDuiFv4bKNk";var d=i(86070);const p=(0,n.createContext)(null),m=({label:e,style:t,focusTransferId:i,children:a,className:m,nodeRef:g})=>{const v=(0,n.useRef)(null),x=g??v,h=(0,l.S)();return(0,r.X)(i??null,x),(0,d.jsx)(p.Provider,{value:x,children:(0,d.jsx)("aside",{"aria-label":e,className:s()(c,m,{[u]:h===o.z.NOW_PLAYING_VIEW}),style:t,id:"Desktop_PanelContainer_Id",ref:x,tabIndex:-1,children:a})})}},73857:(e,t,i)=>{i.d(t,{w:()=>x});var n=i(30758),a=i(97500),s=i.n(a),r=i(93153),o=i(17329),l=i(65234);const c="AAdBM1nhG73supMfnYX7",u="W3E0IT3_STcazjTeyOJa",d="mdMUqcSHFw1lZIcYEblu",p="cZCuJDjrGA2QMXja_Sua",m="zduvaX0Ioxqd5ypeWoAf";var g=i(86070);const v=({fixedHeader:e,scrollNodeRef:t,children:i,scrolledClassName:n})=>{const a=(0,o.y)(t);return(0,g.jsxs)("div",{className:s()(c),children:[(0,g.jsx)("div",{className:s()(u,{[n??d]:a}),children:e}),i]})},x=n.forwardRef((({children:e,className:t,fixedHeader:i,scrolledClassName:a},o)=>{const u=(0,n.useRef)(null),d=(0,g.jsx)(l.bi.Provider,{value:{scrollNodeRef:u},children:(0,g.jsx)(r.a,{className:p,onInstanceCreated:e=>{u.current=e.elements().viewport},children:(0,g.jsx)("div",{ref:o,className:s()(c,m,t),children:e})})});return i?(0,g.jsx)(v,{fixedHeader:i,scrollNodeRef:u,scrolledClassName:a,children:d}):d}))},78550:(e,t,i)=>{i.d(t,{a:()=>Q,k:()=>q});var n=i(30758),a=i(97500),s=i.n(a),r=i(6128),o=i(87123),l=i(77940),c=i(41089),u=i(63166),d=i(52795),p=i(75627),m=i(64721),g=i(53998),v=i(13377),x=i(58681),h=i(13728),y=i(48732),b=i(3602),f=i(17221),j=i(43494),C=i(55285),w=i(45006),S=i(86502),N=i(13979),k=i(2799),R=i(92057),I=i(19412),E=i(45640),L=i(1620);const T="eTT681T6oUKXsIMiP8pT",A="gwmgu53xszgwAXxqLT0h",P="fNXmHtlrj4UVWmhQrJ_5",D="XOSSUjLDKk9RRmiX_UWa",O="KILnOHUdx4pspVEoJ7kq",_="XNFZdOLgMlx491fEWdYJ",U="icNf66tgG3uxDMbCCIaN",B="rkIl3GXeAGoK2gIX2zuj",F="j9Ey7DzF10wbxpBIVtcb";var M=i(86070);const H={[p.NQG.PLAYLIST]:b.W,[p.NQG.PLAYLIST_V2]:b.W,[p.NQG.ALBUM]:x.h,[p.NQG.TRACK]:f.P,[p.NQG.ARTIST]:h.t,[p.NQG.EPISODE]:y.b},V=({title:e,variant:t,semanticColor:i})=>(0,M.jsx)(w.r,{children:(0,M.jsx)(r.E,{as:"h1",variant:t,semanticColor:i,children:e||""})},e||""),q=({link:e,title:t,item:i,panelLinkRef:n,variant:a,semanticColor:r,className:o})=>{const{spec:l,logger:c}=(0,L.r)(d.J,{}),m=(0,p.o_h)(e);let g,x=!1,h=[];const y=m&&H[m.type];if(y){const e=m.toURI();g=(0,M.jsx)(y,{uri:e}),x=!(!e||!t),h=x?[e]:[]}const b=(0,S.XB)().split("_").join(" "),{draggable:f,onDragStart:j}=(0,R.P)({itemUris:h,dragLabelText:t??""}),w=(0,u.NC)(I.mzn);return(0,M.jsx)(v.h,{menu:g,children:(0,M.jsx)("div",{className:s()(T,o,{[F]:w}),children:e&&t?(0,M.jsx)(C.N,{ref:n,"aria-label":`${b} link`,draggable:f&&x,onDragStart:x?j:void 0,to:e,search:i?`?uid=${i.uid}&uri=${i.uri}`:void 0,className:A,onClick:()=>{c.logInteraction(l.contextLinkFactory().hitUiNavigate({destination:e||""}))},children:(0,M.jsx)(V,{title:t,variant:a,semanticColor:r})}):(0,M.jsx)(V,{title:t,variant:a,semanticColor:r})})})},z=N.$S.PANEL_CLOSE_CLICK,Q=({link:e,title:t,titleSlot:i,actions:a,onClose:r,className:d,panelLinkRef:p,preventDefaultClose:v=!1,onBack:x,item:h,titleVariant:y="bodyMediumBold",titleSemanticColor:b="textBase"})=>{const f=(0,S._Y)(),C=(0,S.Ev)(z),w=(0,u.NC)(I.mzn),N=(0,S.XB)()===k.Z.NowPlayingView&&w,R=(0,n.useCallback)((()=>{r?.(),v||f(z)}),[r,v,f]),L=null!==h&&(0,E.N)(h);return(0,M.jsx)(n.Suspense,{fallback:null,children:(0,M.jsxs)("div",{className:s()(P,d,{[O]:w}),children:[x&&(0,M.jsx)("span",{className:U,children:(0,M.jsx)(j.Zp,{label:m.Ru.get("desktop.login.Back"),children:(0,M.jsx)(g.a,{ariaLabel:m.Ru.get("desktop.login.Back"),size:"sm",onClick:x,icon:o.g})})}),w&&(0,M.jsx)(g.a,{icon:l.t,size:"sm",onClick:R,ariaLabel:m.Ru.get("close"),className:B}),i||(0,M.jsx)(q,{title:t,panelLinkRef:p,item:h,link:e,variant:y,semanticColor:b}),(0,M.jsxs)("span",{className:s()(U,D),children:[a,!L&&!N&&(0,M.jsx)("div",{"data-testid":"PanelHeader_CloseButton",children:(0,M.jsx)(j.Zp,{label:m.Ru.get("close"),children:(0,M.jsx)(g.a,{ariaLabel:m.Ru.get("close"),className:_,size:"sm",onClick:R,icon:c.M,disabled:!C})})})]})]})})}},21070:(e,t,i)=>{i.d(t,{H:()=>l});var n=i(48228),a=i(6128),s=i(64721),r=i(29360),o=i(86070);const l=()=>(0,o.jsxs)("div",{className:r.A.emptyContainer,children:[(0,o.jsx)(n.q,{size:"xxlarge","aria-hidden":"true"}),(0,o.jsxs)("div",{className:r.A.titleContainer,children:[(0,o.jsx)(a.E,{as:"h1",variant:"titleMedium",semanticColor:"textBase",children:s.Ru.get("history.empty-title")}),(0,o.jsx)("p",{children:s.Ru.get("history.empty-description")})]})]})},24897:(e,t,i)=>{i.d(t,{$:()=>p});var n=i(30758),a=i(95440),s=i(61214),r=i(13398),o=i(64721),l=i(66686),c=i(17896),u=i(28261),d=i(86070);const p=({onClick:e})=>{const t=(0,a.wA)(),i=(0,c.Y)(),p=(0,n.useCallback)((async()=>{try{e(),await i()}catch(e){t((0,l.A9)(u.EL.ERROR))}}),[i,t,e]);return(0,d.jsx)(s.$,{iconLeading:r.V,size:"small",onClick:p,children:o.Ru.get("web-player.social-connect.menu-action.title")})}},14998:(e,t,i)=>{i.d(t,{T:()=>o});var n=i(30758),a=i(66056),s=i(1620),r=i(86070);const o=()=>{const{spec:e,logger:t,UBIFragment:i}=(0,s.r)(a.I,{});return{logUserClick:(0,n.useCallback)(((i,n)=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).userLinkFactory().hitUiNavigate({destination:n}))}),[t,e]),logRemoveClick:(0,n.useCallback)((i=>{t.logInteraction(e.participantListFactory().participantListRowFactory({position:i}).removeButtonFactory().hitUiReveal())}),[t,e]),UBIFragmentWithSpec:(0,n.useCallback)((t=>(0,r.jsx)(i,{spec:e,...t})),[i,e])}}},80762:(e,t,i)=>{i.d(t,{z:()=>n.z});var n=i(43520)},17186:(e,t,i)=>{i.d(t,{S:()=>n.S});var n=i(40271)},69257:(e,t,i)=>{i.d(t,{J:()=>n.J});var n=i(29754)},41436:(e,t,i)=>{i.d(t,{a:()=>n.a});var n=i(64842)},42452:(e,t,i)=>{i.d(t,{r:()=>n.r});var n=i(96802)},76528:(e,t,i)=>{i.d(t,{x:()=>s});var n=i(15758),a=i(6334);function s(){const e=(0,a.t)();return(0,n.I)({queryKey:["settings-formats"],queryFn:()=>e.quality.getFormats(),gcTime:36e5,staleTime:6e5}).data}},65260:(e,t,i)=>{i.d(t,{p:()=>h});var n=i(30758),a=i(6128),s=i(40748),r=i(41089),o=i(64721),l=i(72744),c=i(24897),u=i(66550),d=i(76698);const p="pIxPdfuNasUDLbEDmuK_",m="T5TwrUTf23N311rgrEAc",g="BTwQUS5iBiiOBgdda2Zi",v="lu2OTpzgQ6hv6AYWXMNQ";var x=i(86070);const h=({localStorageKey:e,onDismiss:t})=>{const[i,h]=(0,d.x)(e,!1),{logStartJam:y}=(0,u.O)(),{enqueueSnackbar:b}=(0,l.d)(),f=(0,n.useCallback)((()=>{h(!0),t&&t(),b(o.Ru.get("web-player.social-connect.promotion.how-to-start-a-jam-reminder"),{autoHideDuration:5e3})}),[b,t,h]);return i?(0,x.jsx)(x.Fragment,{}):(0,x.jsxs)("div",{className:p,children:[(0,x.jsxs)("div",{className:m,children:[(0,x.jsx)(a.E,{as:"p",variant:"bodySmall",semanticColor:"textSubdued",children:o.Ru.get("web-player.social-connect.invitation-modal.subtitle")}),(0,x.jsx)(s.H,{iconOnly:r.M,className:g,"aria-label":o.Ru.get("close"),onClick:f,size:"small"})]}),(0,x.jsx)("div",{className:v,children:(0,x.jsx)(c.$,{onClick:y})})]})}},29093:(e,t,i)=>{i.d(t,{y:()=>n.y});var n=i(16518)},24541:(e,t,i)=>{i.d(t,{a:()=>c});var n=i(34889),a=i(15758),s=i(6218),r=i(40268),o=i(30758);const l=["play-history-contents"];function c(){const e=(0,r.q)(),t=(0,n.jE)();return function(e,t){const i=(0,r.q)();(0,o.useEffect)((()=>i.getEvents().addListener(e,t)),[e,t,i])}(s.X.UPDATE,(e=>t.setQueryData(l,e.data))),(0,a.I)({queryKey:l,queryFn:()=>e.getContents(),gcTime:3e5,staleTime:0})}},76597:(e,t,i)=>{i.d(t,{p:()=>a});var n=i(30758);const a=e=>{const[t,i]=(0,n.useState)(0);function a(n){const a=e.current?.querySelectorAll('button:not([disabled]), [href], input, select, textarea, a,[tabindex]:not([tabindex="-1"])');if(!a)return;a.forEach((e=>{e.setAttribute("tabindex","-1")})),a&&a[0].setAttribute("tabindex","0");let s=t;if(a&&a.length>0)switch(n.key){case"Tab":document.activeElement&&i(0);break;case"ArrowUp":0===s?(n.preventDefault(),s=a.length-1):s-=1,a[s].focus(),i(s);break;case"ArrowDown":n.preventDefault(),s===a.length-1?s=0:s+=1,a[s].focus(),i(s)}}n.useEffect((()=>{const t=e.current;return t?.addEventListener("keydown",a),()=>{t?.removeEventListener("keydown",a)}}))}},7866:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(89227),a=i(25214);function s(){return(0,a.N)(n.x)}}}]);
//# sourceMappingURL=dwp-panel-section.js.map